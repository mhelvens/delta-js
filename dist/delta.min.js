(function e(t,r){if(typeof exports==="object"&&typeof module==="object")module.exports=r();else if(typeof define==="function"&&define.amd)define(r);else if(typeof exports==="object")exports["DeltaJs"]=r();else t["DeltaJs"]=r()})(this,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={exports:{},id:n,loaded:false};e[n].call(a.exports,a,a.exports,r);a.loaded=true;return a.exports}r.m=e;r.c=t;r.p="";return r(0)}([function(e,t,r){e.exports=r(2)},,function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e["default"]:e};var a=r(4).extend;var i=n(r(5));var o=r(6);var u=o.ReadableTarget;var s=o.WritableTarget;a(i,{ReadableTarget:u,WritableTarget:s});var l=n(r(7));a(i,{Path:l});var f=r(8);var c=f.ApplicationError;var v=f.PreconditionFailure;var p=f.MultipleOverloadsApplicationError;var d=f.NoOverloadsApplicationError;var h=f.CompositionError;var y=f.MultipleOverloadsCompositionError;var g=f.ConstraintFailure;var m=f.ApplicationOrderCycle;var w=f.UnresolvedDeltaConflict;var b=f.MultipleActiveProxiesError;a(i,{ApplicationError:c,PreconditionFailure:v,MultipleOverloadsApplicationError:p,NoOverloadsApplicationError:d,CompositionError:h,MultipleOverloadsCompositionError:y,ConstraintFailure:g,ApplicationOrderCycle:m,UnresolvedDeltaConflict:w,MultipleActiveProxiesError:b});e.exports=i},,function(e,t,r){"use strict";var n=function(e,t){if(Array.isArray(e)){return e}else if(Symbol.iterator in Object(e)){var r=[];for(var n=e[Symbol.iterator](),a;!(a=n.next()).done;){r.push(a.value);if(t&&r.length===t)break}return r}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}};var a=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}else{return Array.from(e)}};var i=function(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})};t.extend=o;t.o=s;t.a=l;t.assert=f;t.isUndefined=c;t.isDefined=v;t.repeat=p;t.indent=d;t.oncePer=h;t.mapEqual=m;t.customIndexOf=w;t.arraysEqual=b;t.arraysHaveSameElements=x;t.objectsEqual=_;t.graphDescendants=O;Object.defineProperty(t,"__esModule",{value:true});function o(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++){r[n-1]=arguments[n]}var a=true;var i=false;var o=undefined;try{for(var u=r[Symbol.iterator](),s;!(a=(s=u.next()).done);a=true){var l=s.value;var f=true;var c=false;var v=undefined;try{for(var p=Object.keys(l)[Symbol.iterator](),d;!(f=(d=p.next()).done);f=true){var h=d.value;Object.defineProperty(e,h,Object.getOwnPropertyDescriptor(l,h))}}catch(y){c=true;v=y}finally{try{if(!f&&p["return"]){p["return"]()}}finally{if(c){throw v}}}}}catch(y){i=true;o=y}finally{try{if(!a&&u["return"]){u["return"]()}}finally{if(i){throw o}}}return e}function u(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++){r[n-1]=arguments[n]}var i=r.slice(0,-1);var o=r[r.length-1];if(i.length===0){return e}var u=s.apply(undefined,[e].concat(a(i.slice(0,-1))));if(u instanceof Map){if(c(u.get(i[i.length-1]))){u.set(i[i.length-1],o)}return u.get(i[i.length-1])}else{if(c(u[i[i.length-1]])){u[i[i.length-1]]=o}return u[i[i.length-1]]}}function s(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++){r[n-1]=arguments[n]}return u.apply(undefined,[e].concat(r,[{}]))}function l(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++){r[n-1]=arguments[n]}return u.apply(undefined,[e].concat(r,[[]]))}function f(e,t){if(!e){throw new Error(t||"Assertion failed")}}function c(e){return typeof e==="undefined"}function v(e){return typeof e!=="undefined"}function p(e,t){return new Array(e+1).join(t)}function d(e,t){var r=arguments[2]===undefined?" ":arguments[2];return e.replace(/^(?!\s*$)/gm,p(t,r))}function h(e,t,r){var a=function(e){var n="_once per: "+t;if(e[n]){return}e[n]=true;return r.call(e,e)};if(typeof e==="string"){var i=[e,t];var o=n(i,2);t=o[0];r=o[1];return a}else{return a(e)}}var y=function(e,t){return function(r,n){return r.type===e&&n.type===t}};t.t=y;var g=function(e){return function(t,r){if(typeof r==="string"){r=function(e){return function(t){return t[e]}}(r)}return function(n,a){return new e.Delta[t](r&&r({d1:n,d2:a,p1:n.arg,p2:a.arg}))}}};t.define_d=g;function m(e,t){var r=arguments[2]===undefined?function(e,t){return e===t}:arguments[2];if(e.size!==t.size){return false}var n=[].concat(a(e.keys())).sort();var i=[].concat(a(t.keys())).sort();for(var o=0;o<n.length;++o){if(n[o]!==i[o]){return false}if(!r(e.get(n[o]),t.get(i[o]))){return false}}return true}function w(e,t){var r=arguments[2]===undefined?function(e,t){return e===t}:arguments[2];for(var n=0;n<e.length;++n){if(r(e[n],t)){return n}}return-1}function b(e,t){var r=arguments[2]===undefined?function(e,t){return e===t}:arguments[2];if(e.length!==t.length){return false}for(var n=0;n<e.length;++n){if(!r(e[n],t[n])){return false}}return true}function x(e,t){var r=arguments[2]===undefined?function(e,t){return e===t}:arguments[2];if(e.length!==t.length){return false}var n=[].concat(a(t));for(var i=0;i<e.length;++i){var o=false;for(var u=0;u<n.length;++u){if(r(e[i],n[u])){n.splice(u,1);o=true;break}}if(!o){return false}}return true}function _(e,t){var r=arguments[2]===undefined?function(e,t){return e===t}:arguments[2];var n=Object.keys(e);var a=Object.keys(t);if(n.length!==a.length){return false}n.sort();a.sort();for(var i=0;i<n.length;++i){if(n[i]!==a[i]){return false}if(!r(e[n[i]],t[a[i]])){return false}}return true}function O(e,t){return Object.keys(function r(t){return o.apply(undefined,[i({},t,true)].concat(a([].concat(a(e.verticesFrom(t))).map(function(e){var t=n(e,1);var a=t[0];return r(a)}))))}(t))}},function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e["default"]:e};var a=function(e,t){var r=Object.create(e.prototype);var n=e.apply(r,t);return n!=null&&(typeof n=="object"||typeof n=="function")?n:r};var i=function(){function e(e,t){for(var r in t){var n=t[r];n.configurable=true;if(n.value)n.writable=true}Object.defineProperties(e,t)}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var u=n(r(22));var s=r(4);var l=s.extend;var f=s.assert;var c=s.isUndefined;var v=s.isDefined;var p=s.arraysEqual;var d=n(r(7));var h=r(6);var y=h.ReadableTarget;var g=h.WritableTarget;var m=h.rt;var w=h.wt;var b=n(r(9));var x=n(r(10));var _=n(r(11));var O=n(r(12));var E=n(r(13));var P=n(r(14));var C=n(r(15));var A=n(r(16));var k=n(r(17));var j=n(r(18));var D=n(r(19));var T=function(){function e(){o(this,e);D(this);b(this);x(this);_(this);O(this);E(this);P(this);C(this);A(this);k(this);j(this)}i(e,{newOperationType:{value:function t(r,n,i){f(r[0]===r[0].toUpperCase(),"Delta operation classes must have a name starting with a capital letter - '"+r+"' does not.");f(c(this.Delta[r]),"The '"+r+"' operation type already exists.");this.Delta[r]=n;n.Proxy=i;var o=n.prototype.applyTo||function(){};var u=n.prototype.refines;var s=n.prototype.equals;var d=n.prototype.commutesWith;var h=n.prototype.resolves;l(n.prototype,{applyTo:function E(t){var r=arguments[1]===undefined?{}:arguments[1];if(!this.selected){return}if(!(t instanceof e.ReadableTarget)){t=new e.ReadableTarget(t)}var n=this.evaluatePrecondition(t);if(n!==true){throw n}o.call(this,t,r)},refines:function P(e){if(this.type!==e.type){return false}if(v(u)){return u.call(this,e)}else{return this.equals(e)}},equals:function C(e){if(this.type!==e.type){return false}if(v(s)){return s.call(this,e)}else if(v(u)){return this.refines(e)&&e.refines(this)}else{return p(this.args,e.args)}},commutesWith:function A(e){if(v(d)){return d.call(this,e)}else{return this.composedWith(e).equals(e.composedWith(this))}},resolves:function k(e,t){if(v(h)){return h.call(this,e,t)}else{return e.composedWith(t).composedWith(this).equals(t.composedWith(e).composedWith(this))}},type:r});var y=r[0].toLowerCase()+r.slice(1);var g=true;var m=false;var w=undefined;try{for(var b=(n.prototype.methods||[y])[Symbol.iterator](),x;!(g=(x=b.next()).done);g=true){var _=x.value;this.ContainerProxy.newProxyMethod(_,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++){t[r]=arguments[r]}return a(n,t)})}}catch(O){m=true;w=O}finally{try{if(!g&&b["return"]){b["return"]()}}finally{if(m){throw w}}}return n}},newProxyMethod:{value:function r(e,t){this.ContainerProxy.newProxyMethod(e,t)}}});return e}();e.exports=T},function(e,t,r){"use strict";var n=function c(e,t,r){var n=Object.getOwnPropertyDescriptor(e,t);if(n===undefined){var a=Object.getPrototypeOf(e);if(a===null){return undefined}else{return c(a,t,r)}}else if("value"in n&&n.writable){return n.value}else{var i=n.get;if(i===undefined){return undefined}return i.call(r)}};var a=function(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)e.__proto__=t};var i=function(){function e(e,t){for(var r in t){var n=t[r];n.configurable=true;if(n.value)n.writable=true}Object.defineProperties(e,t)}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};t.wt=l;t.rt=f;Object.defineProperty(t,"__esModule",{value:true});var u=t.ReadableTarget=function(){function e(t){o(this,e);this._val=t}i(e,{getValue:{value:function t(){return this._val}},value:{get:function(){return this.getValue()},set:function(e){this.setValue(e)}}});return e}();var s=t.WritableTarget=function(e){function t(e,r){o(this,t);n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this);this._obj=e;this._prop=r}a(t,e);i(t,{getValue:{value:function r(){return this._obj[this._prop]}},setValue:{value:function u(e){this._obj[this._prop]=e}},"delete":{value:function s(){delete this._obj[this._prop]}}});return t}(u);function l(e,t){return new s(e,t)}function f(e,t){return new u(e,t)}},function(e,t,r){"use strict";var n=function(e,t){if(Array.isArray(e)){return e}else if(Symbol.iterator in Object(e)){var r=[];for(var n=e[Symbol.iterator](),a;!(a=n.next()).done;){r.push(a.value);if(t&&r.length===t)break}return r}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}};var a=function(){function e(e,t){for(var r in t){var n=t[r];n.configurable=true;if(n.value)n.writable=true}Object.defineProperties(e,t)}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var o=r(4);var u=o.assert;var s=o.isDefined;var l=function(){function e(){var t=arguments[0]===undefined?"":arguments[0];i(this,e);var r=t.match(/^([.#]?)(\w*|\(\w+\))(.*)$/);u(r,"The path string '"+t+"' is not well formed.");var a=n(r,4);var o=a[1];var s=a[2];var l=a[3];if(o==="#"){this.set(new e(".(instance)."+s+""+l))}else if(s!==""){this._prop=s;if(l!==""){this._rest=new e(l)}}}a(e,{set:{value:function t(e){this._prop=e._prop;this._rest=e._rest}},prop:{get:function(){return this._prop}},rest:{get:function(){return this._rest}},toString:{value:function r(){var e="";if(s(this.prop)){e+=this.prop;if(s(this.rest)){e+="."+this.rest.toString()}}return e}}});return e}();e.exports=l},function(e,t,r){"use strict";var n=function y(e,t,r){var n=Object.getOwnPropertyDescriptor(e,t);if(n===undefined){var a=Object.getPrototypeOf(e);if(a===null){return undefined}else{return y(a,t,r)}}else if("value"in n&&n.writable){return n.value}else{var i=n.get;if(i===undefined){return undefined}return i.call(r)}};var a=function(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)e.__proto__=t};var i=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};Object.defineProperty(t,"__esModule",{value:true});var o=t.ApplicationError=function(e){function t(){i(this,t);if(e!=null){e.apply(this,arguments)}}a(t,e);return t}(Error);var u=t.PreconditionFailure=function(e){function t(e,r){i(this,t);n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this);this.name="PreconditionFailure";this.message="This delta of type '"+e.type+"' cannot apply to this value of type '"+typeof r+"'.";this.delta=e;this.value=r}a(t,e);return t}(o);var s=t.MultipleOverloadsApplicationError=function(e){function t(e,r){var a=arguments[2]===undefined?[]:arguments[2];i(this,t);n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r);this.name="MultipleOverloadsApplicationError";this.message="None of the delta-types "+e.overloads.map(function(e){return"'"+e.type+"'"}).join(",")+" can apply to this value of type '"+typeof r+"'."+a.map(function(e){return"\n-- "+e.message}).join("");this.errors=a}a(t,e);return t}(u);var l=t.NoOverloadsApplicationError=function(e){function t(e,r){i(this,t);n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r);this.name="NoOverloadsApplicationError";this.message="This delta of type '"+e.type+"' has no specific deltas assigned to it, so it cannot apply to this value of type '"+typeof r+"."}a(t,e);return t}(u);var f=t.CompositionError=function(e){function t(e,r){i(this,t);n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this);this.name="CompositionError";this.message="This delta of type '"+e.type+"' cannot be composed with this other delta of type '"+r.type+"'.";this.delta1=e;this.delta2=r}a(t,e);return t}(Error);var c=t.MultipleOverloadsCompositionError=function(e){function t(e,r){var a=arguments[2]===undefined?[]:arguments[2];i(this,t);n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r);this.name="MultipleOverloadsCompositionError";this.message="There are no overloads to compose this delta of type '"+e.type+"' with this other delta of type '"+r.type+"'."+a.map(function(e){return"\n-- "+e.message}).join("");this.errors=a}a(t,e);return t}(f);var v=t.ConstraintFailure=function(e){function t(e){i(this,t);n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this);this.name="ConstraintFailure";this.message="The feature '"+e.name+"' is both selected and excluded by its constraints.";this.feature=e}a(t,e);return t}(Error);var p=t.ApplicationOrderCycle=function(e){function t(e,r){i(this,t);n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this);this.name="ApplicationOrderCycle";this.message="The new application order between "+e+" and "+r+" created a cycle.";this.from=e;this.to=r}a(t,e);return t}(Error);var d=t.UnresolvedDeltaConflict=function(e){function t(e){i(this,t);n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this);this.name="UnresolvedDeltaConflict";var r=e.slice(0,-1).map(function(e){return"'"+e+"'"}).join(",");this.message="There is an unresolved conflict between deltas "+r+" and '"+e[e.length-1]+"'.";this.deltaNames=e}a(t,e);return t}(o);var h=t.MultipleActiveProxiesError=function(e){function t(){i(this,t);n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this);this.name="MultipleActiveProxiesError";this.message="Only one Proxy per path can be active at any given time."}a(t,e);return t}(Error)},function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e["default"]:e};var a=function(){function e(e,t){for(var r in t){var n=t[r];n.configurable=true;if(n.value)n.writable=true}Object.defineProperties(e,t)}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var o=r(4);var u=o.extend;var s=o.oncePer;var l=r(6);var f=l.ReadableTarget;var c=l.wt;var v=r(8);var p=v.PreconditionFailure;var d=v.CompositionError;var h=n(r(23));e.exports=s("Delta",function(e){s(e.constructor,"Delta",function(){u(e.constructor.prototype,{newComposition:function t(e,r){this.Delta.newComposition(e,r)}})});e.Delta=function(){function t(){for(var r=arguments.length,n=Array(r),a=0;a<r;a++){n[a]=arguments[a]}i(this,t);this.id=++e.Delta._nextID;this.args=n}a(t,{arg:{get:function(){return this.args[0]},set:function(e){this.args[0]=e}},clone:{value:function r(){return new this.constructor(this.arg)}},evaluatePrecondition:{value:function n(e){if(this.precondition){var t=this.precondition(e);if(t instanceof p){return t}else if(!t){return new p(this,e.value)}}return true}},appliedTo:{value:function o(e){var t=arguments[1]===undefined?{}:arguments[1];if(e instanceof f){e=e.value}if(typeof e.clone==="function"){e=e.clone()}var r={value:e};this.applyTo(c(r,"value"),t);return r.value}},composedWith:{value:function u(t){return e.Delta.composed(this,t)}},toString:{value:function s(){var e=arguments[0]===undefined?{}:arguments[0];var t=this.type;if(e.targetProp){t+=" ‹"+e.targetProp+"›"}if(this.args.length>0){t+=": "+this.args.map(function(e){return JSON.stringify(e)}).join(",")}if(e.debug){t+=" ("+this.id+")"}return t}}},{newComposition:{value:function l(t,r){e.Delta._compositions.push({precondition:t,compose:r})}},composed:{value:function v(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++){r[n]=arguments[n]}var a=new e.Delta.NoOp;var i=true;var o=false;var u=undefined;try{for(var s=r[Symbol.iterator](),l;!(i=(l=s.next()).done);i=true){var f;var c;var v;var p,h;var y;(function(){var t=l.value;var r=a,n=t||new e.Delta.NoOp;var i=function(){};var o=false;f=true;c=false;v=undefined;try{for(p=e.Delta._compositions[Symbol.iterator]();!(f=(h=p.next()).done);f=true){y=h.value;var u=y.precondition;var s=y.compose;if(u(r,n)){i=s;o=true;break}}}catch(g){c=true;v=g}finally{try{if(!f&&p["return"]){p["return"]()}}finally{if(c){throw v}}}if(i===false||!o){throw new d(r,n)}if(i===true){i=function(t,r){return new e.Delta.Composed([t,r])}}a=i(r,n)})()}}catch(g){o=true;u=g}finally{try{if(!i&&s["return"]){s["return"]()}}finally{if(o){throw u}}}return a}}});return t}();e.Delta._nextID=0;e.Delta._compositions=[];h(e)})},function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e["default"]:e};var a=function(){function e(e,t){for(var r in t){var n=t[r];n.configurable=true;if(n.value)n.writable=true}Object.defineProperties(e,t)}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function g(e,t,r){var n=Object.getOwnPropertyDescriptor(e,t);if(n===undefined){var a=Object.getPrototypeOf(e);if(a===null){return undefined}else{return g(a,t,r)}}else if("value"in n&&n.writable){return n.value}else{var i=n.get;if(i===undefined){return undefined}return i.call(r)}};var o=function(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)e.__proto__=t};var u=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var s=n(r(9));var l=r(4);var f=l.indent;var c=l.oncePer;var v=l.arraysEqual;var p=r(8);var d=p.MultipleOverloadsApplicationError;var h=p.NoOverloadsApplicationError;var y=p.MultipleOverloadsCompositionError;e.exports=c("Overloaded",function(e){s(e);e.newOperationType("Overloaded",function(e){function t(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++){r[n]=arguments[n]}u(this,t);i(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,r);this.overloads=this.arg||[]}o(t,e);a(t,{clone:{value:function r(){var e=i(Object.getPrototypeOf(t.prototype),"clone",this).call(this);e.overloads=this.overloads.map(function(e){return e.clone()});return e}},equals:{value:function n(e){return v(this.overloads,e.overloads,function(e,t){return e.equals(t)})}},applyTo:{value:function s(e){var t=arguments[1]===undefined?{}:arguments[1];var r=[];var n=this.overloads.some(function(n){var a=n.evaluatePrecondition(e);if(a!==true){r.push(a);return false}n.applyTo(e,t);return true});if(!n){if(r.length===0){throw new h(this,e.value)}else if(r.length===1){throw r[0]}else{throw new d(this,e.value,r)}}}},toString:{value:function l(){var e=arguments[0]===undefined?{}:arguments[0];var r=i(Object.getPrototypeOf(t.prototype),"toString",this).call(this,e);var n=this.overloads.map(function(t){return t.toString(e)}).join("\n");r+="\n"+f(n,4);return r}}});return t}(e.Delta));e.newComposition(function(t,r){return t instanceof e.Delta.Overloaded||r instanceof e.Delta.Overloaded},function(t,r){var n=t instanceof e.Delta.Overloaded?t.overloads:[t];var a=r instanceof e.Delta.Overloaded?r.overloads:[r];var i=new e.Delta.Overloaded;var o=[];var u=true;var s=false;var l=undefined;try{for(var f=n[Symbol.iterator](),c;!(u=(c=f.next()).done);u=true){var v=c.value;var p=true;var d=false;var h=undefined;try{for(var g=a[Symbol.iterator](),m;!(p=(m=g.next()).done);p=true){var w=m.value;try{i.overloads.push(v.composedWith(w))}catch(b){o.push(b)}}}catch(x){d=true;h=x}finally{try{if(!p&&g["return"]){g["return"]()}}finally{if(d){throw h}}}}}catch(x){s=true;l=x}finally{try{if(!u&&f["return"]){f["return"]()}}finally{if(s){throw l}}}if(i.overloads.length===0){throw new y(t,r,o)}return i})})},function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e["default"]:e};var a=function(e,t){if(Array.isArray(e)){return e}else if(Symbol.iterator in Object(e)){var r=[];for(var n=e[Symbol.iterator](),a;!(a=n.next()).done;){r.push(a.value);if(t&&r.length===t)break}return r}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}};var i=function(){function e(e,t){for(var r in t){var n=t[r];n.configurable=true;if(n.value)n.writable=true}Object.defineProperties(e,t)}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o=function m(e,t,r){var n=Object.getOwnPropertyDescriptor(e,t);if(n===undefined){var a=Object.getPrototypeOf(e);if(a===null){return undefined}else{return m(a,t,r)}}else if("value"in n&&n.writable){return n.value}else{var i=n.get;if(i===undefined){return undefined}return i.call(r)}};var u=function(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)e.__proto__=t};var s=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var l=r(4);var f=l.extend;var c=l.indent;var v=l.t;var p=l.oncePer;var d=l.mapEqual;var h=n(r(7));var y=r(6).wt;var g=n(r(19));e.exports=p("Modify",function(e){g(e);e.newOperationType("Modify",function(e){function t(){var e=this;for(var r=arguments.length,n=Array(r),a=0;a<r;a++){n[a]=arguments[a]}s(this,t);o(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,n);this.subDeltas=new Map(this.arg&&Object.keys(this.arg).map(function(t){return[t,e.arg[t]]}))}u(t,e);i(t,{clone:{value:function r(){var e=o(Object.getPrototypeOf(t.prototype),"clone",this).call(this);var r=true;var n=false;var i=undefined;try{for(var u=this.subDeltas[Symbol.iterator](),s;!(r=(s=u.next()).done);r=true){var l=a(s.value,2);var f=l[0];var c=l[1];e.subDeltas.set(f,c.clone())}}catch(v){n=true;i=v}finally{try{if(!r&&u["return"]){u["return"]()}}finally{if(n){throw i}}}return e}},equals:{value:function n(e){return d(this.subDeltas,e.subDeltas,function(e,t){return e.equals(t)})}},precondition:{value:function l(e){return e.value instanceof Object}},applyTo:{value:function v(e){var t=arguments[1]===undefined?{}:arguments[1];var r=true;var n=false;var i=undefined;try{for(var o=this.subDeltas[Symbol.iterator](),u;!(r=(u=o.next()).done);r=true){var s=a(u.value,2);var l=s[0];var c=s[1];if(!t.restrictToProperty||t.restrictToProperty===l){c.applyTo(y(e.value,l),f({},t,{restrictToProperty:null}))}}}catch(v){n=true;i=v}finally{try{if(!r&&o["return"]){o["return"]()}}finally{if(n){throw i}}}}},toString:{value:function p(){var e=arguments[0]===undefined?{}:arguments[0];var r=o(Object.getPrototypeOf(t.prototype),"toString",this).call(this,e);if(this.subDeltas.size>0){var n=this.subDeltas.entries().map(function(t){var r=a(t,2);var n=r[0];var i=r[1];return i.toString(f({},e,{targetProp:n}))}).join("\n");r+="\n"+c(n,4)}return r}}});return t}(e.Delta),function(t){function r(){s(this,r);if(t!=null){t.apply(this,arguments)}}u(r,t);i(r,{processProxyArguments:{value:function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++){t[r]=arguments[r]}var n={};do{if(t.length===0){throw new Error("The argument list for this Modify.Proxy method is insufficient.")}var a=t.shift();if(typeof a==="string"){n.path=a}else{f(n,a)}}while(!n.path);return{options:n,args:t}}},addOperation:{value:function a(t,r){var n=r.path;if(!n.prop){throw new Error("Operations on a Modify.Proxy need to have a non-empty path.")}var a;if(n.rest){var i=f({},r,{path:n.rest});var o=this.addChildProxy(n.prop,new e.Delta.Modify);a=o.addOperation(t,i)}else{a=this.addChildProxy(n.prop,t)}return a}},delta:{value:function l(){var e=o(Object.getPrototypeOf(r.prototype),"delta",this).call(this);var t=true;var n=false;var a=undefined;try{for(var i=this.childKeys()[Symbol.iterator](),u;!(t=(u=i.next()).done);t=true){var s=u.value;e.subDeltas.set(s,this.childDelta(s))}}catch(l){n=true;a=l}finally{try{if(!t&&i["return"]){i["return"]()}}finally{if(n){throw a}}}return e}}});return r}(e.ContainerProxy));e.newComposition(v("Modify","Modify"),function(t,r){var n=t.clone();var a=true;var i=false;var o=undefined;try{for(var u=r.subDeltas.keys()[Symbol.iterator](),s;!(a=(s=u.next()).done);a=true){var l=s.value;n.subDeltas.set(l,e.Delta.composed(n.subDeltas.get(l),r.subDeltas.get(l)))}}catch(f){i=true;o=f}finally{try{if(!a&&u["return"]){u["return"]()}}finally{if(i){throw o}}}return n})})},function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e["default"]:e};var a=function(){function e(e,t){for(var r in t){var n=t[r];n.configurable=true;if(n.value)n.writable=true}Object.defineProperties(e,t)}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)e.__proto__=t};var o=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var u=r(4);var s=u.isUndefined;var l=u.isDefined;var f=u.t;var c=u.define_d;var v=u.oncePer;var p=r(6);var d=p.WritableTarget;var h=p.ReadableTarget;var y=p.rt;var g=p.wt;var m=n(r(9));var w=n(r(11));e.exports=v("basic operations",function(e){m(e);w(e);e.newOperationType("NoOp",function(e){function t(){o(this,t);if(e!=null){e.apply(this,arguments)}}i(t,e);return t}(e.Delta));e.newOperationType("Add",function(e){function t(){o(this,t);if(e!=null){e.apply(this,arguments)}}i(t,e);a(t,{precondition:{value:function r(e){return e instanceof d&&s(e.value)}},applyTo:{value:function n(e){e.value=this.arg}}});return t}(e.Delta));e.newOperationType("Remove",function(e){function t(){o(this,t);if(e!=null){e.apply(this,arguments)}}i(t,e);a(t,{precondition:{value:function r(e){return e instanceof d&&l(e.value)}},applyTo:{value:function n(e){e["delete"]()}}});return t}(e.Delta));e.newOperationType("Forbid",function(e){function t(){o(this,t);if(e!=null){e.apply(this,arguments)}}i(t,e);a(t,{precondition:{value:function r(e){return s(e.value)}}});return t}(e.Delta));e.newOperationType("Replace",function(e){function t(){o(this,t);if(e!=null){e.apply(this,arguments)}}i(t,e);a(t,{precondition:{value:function r(e){return e instanceof d&&l(e.value)}},applyTo:{value:function n(e){e.value=this.arg}}});return t}(e.Delta));e.newOperationType("Update",function(e){function t(){o(this,t);if(e!=null){e.apply(this,arguments)}}i(t,e);a(t,{precondition:{value:function r(e){return e instanceof d&&l(e.value)}},applyTo:{value:function n(e){e.value=this.arg(e.value)}}});return t}(e.Delta));e.newComposition(function(t,r){return t instanceof e.Delta.NoOp},function(e,t){return t.clone()});e.newComposition(function(t,r){return r instanceof e.Delta.NoOp},function(e,t){return e.clone()});var t=c(e);e.newComposition(f("Add","Modify"),t("Add",function(e){var t=e.d2;var r=e.p1;return t.appliedTo(r)}));e.newComposition(f("Modify","Add"),false);e.newComposition(f("Add","Add"),false);e.newComposition(f("Modify","Remove"),t("Remove"));e.newComposition(f("Add","Remove"),t("Forbid"));e.newComposition(f("Remove","Modify"),false);e.newComposition(f("Remove","Add"),t("Replace",function(e){var t=e.p2;return t}));e.newComposition(f("Remove","Remove"),false);e.newComposition(f("Modify","Forbid"),false);e.newComposition(f("Add","Forbid"),false);e.newComposition(f("Remove","Forbid"),t("Remove"));e.newComposition(f("Forbid","Modify"),false);e.newComposition(f("Forbid","Add"),t("Add",function(e){var t=e.p2;return t}));e.newComposition(f("Forbid","Remove"),false);e.newComposition(f("Forbid","Forbid"),t("Forbid"));e.newComposition(f("Modify","Replace"),t("Replace",function(e){var t=e.p2;return t}));e.newComposition(f("Add","Replace"),t("Add",function(e){var t=e.p2;return t}));e.newComposition(f("Remove","Replace"),false);e.newComposition(f("Forbid","Replace"),false);e.newComposition(f("Replace","Modify"),t("Replace",function(e){var t=e.d2;var r=e.p1;return t.appliedTo(r)}));e.newComposition(f("Replace","Add"),false);e.newComposition(f("Replace","Remove"),t("Remove"));e.newComposition(f("Replace","Forbid"),false);e.newComposition(f("Replace","Replace"),t("Replace",function(e){var t=e.p2;return t}));e.newComposition(f("Modify","Update"),true);e.newComposition(f("Add","Update"),t("Add",function(e){var t=e.d2;var r=e.p1;return t.appliedTo(r)}));e.newComposition(f("Remove","Update"),true);e.newComposition(f("Forbid","Update"),true);e.newComposition(f("Replace","Update"),t("Replace",function(e){var t=e.d2;var r=e.p1;return t.appliedTo(r)}));e.newComposition(f("Update","Modify"),true);e.newComposition(f("Update","Add"),true);e.newComposition(f("Update","Remove"),t("Remove"));e.newComposition(f("Update","Forbid"),true);e.newComposition(f("Update","Replace"),t("Replace",function(e){var t=e.p2;return t}));e.newComposition(f("Update","Update"),t("Update",function(e){var t=e.p1;var r=e.p2;return function(e){return r(t(e))}}))})},function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e["default"]:e};var a=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}else{return Array.from(e)}};var i=function(){function e(e,t){for(var r in t){var n=t[r];n.configurable=true;if(n.value)n.writable=true}Object.defineProperties(e,t)}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o=function b(e,t,r){var n=Object.getOwnPropertyDescriptor(e,t);if(n===undefined){var a=Object.getPrototypeOf(e);if(a===null){return undefined}else{return b(a,t,r)}}else if("value"in n&&n.writable){return n.value}else{var i=n.get;if(i===undefined){return undefined}return i.call(r)}};var u=function(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)e.__proto__=t};var s=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var l=r(4);var f=l.isDefined;var c=l.t;var v=l.define_d;var p=l.oncePer;var d=l.arraysEqual;var h=l.arraysHaveSameElements;var y=l.customIndexOf;var g=n(r(11));var m=n(r(12));var w=n(r(24));e.exports=p("PutIntoArray",function(e){g(e);m(e);w(e);e.newOperationType("PutIntoArray",function(e){function t(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++){r[n]=arguments[n]}s(this,t);o(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,r);this.values=this.arg?Array.isArray(this.arg)?this.arg:[this.arg]:[];

}u(t,e);i(t,{clone:{value:function r(){var e=o(Object.getPrototypeOf(t.prototype),"clone",this).call(this);e.values=[].concat(a(this.values));return e}},refines:{value:function n(e){var t=function(e,t){return e.method===t.method&&e.value===t.value};if(!h(this.values,e.values,t)){return false}if(!d(this.values.filter(function(e){return e.method==="append"}),e.values.filter(function(e){return e.method==="append"}),t)){return false}if(!d(this.values.filter(function(e){return e.method==="prepend"}),e.values.filter(function(e){return e.method==="prepend"}),t)){return false}var r=[];for(var n=0;n<this.values.length;++n){if(this.values[n].method==="insert"){var a=y(e.values,this.values[n],t);var i=[].concat(r);for(var o=0;o<=a;++o){var u=y(i,e.values[o],t);if(u>-1){i.splice(u,1)}}if(i.length>0){return false}}else{r.push(this.values[n])}}return true}},precondition:{value:function l(e){return f(e.value)&&Array.isArray(e.value)}},applyTo:{value:function c(e){var t=e.value;var r=true;var n=false;var a=undefined;try{for(var i=this.values[Symbol.iterator](),o;!(r=(o=i.next()).done);r=true){var u=o.value;var s=u.method;var l=u.value;switch(s){case"prepend":{t.unshift(l)}break;case"insert":{var f=Math.floor(Math.random()*(t.length+1));t.splice(f,0,l)}break;case"append":{t.push(l)}break}}}catch(c){n=true;a=c}finally{try{if(!r&&i["return"]){i["return"]()}}finally{if(n){throw a}}}}},methods:{get:function(){return[]}}});return t}(e.Delta));e.newProxyMethod("prepend",function(t){return new e.Delta.PutIntoArray({method:"prepend",value:t})});e.newProxyMethod("insert",function(t){return new e.Delta.PutIntoArray({method:"insert",value:t})});e.newProxyMethod("append",function(t){return new e.Delta.PutIntoArray({method:"append",value:t})});var t=v(e);e.newComposition(c("Modify","PutIntoArray"),false);e.newComposition(c("Add","PutIntoArray"),t("Add",function(e){var t=e.d2;var r=e.p1;return t.appliedTo(r)}));e.newComposition(c("Remove","PutIntoArray"),false);e.newComposition(c("Forbid","PutIntoArray"),false);e.newComposition(c("Replace","PutIntoArray"),t("Replace",function(e){var t=e.d2;var r=e.p1;return t.appliedTo(r)}));e.newComposition(c("Update","PutIntoArray"),true);e.newComposition(c("PutIntoArray","Modify"),false);e.newComposition(c("PutIntoArray","Add"),false);e.newComposition(c("PutIntoArray","Remove"),t("Remove"));e.newComposition(c("PutIntoArray","Forbid"),false);e.newComposition(c("PutIntoArray","Replace"),t("Replace",function(e){var t=e.p2;return t}));e.newComposition(c("PutIntoArray","Update"),true);e.newComposition(c("PutIntoArray","PutIntoArray"),function(t,r){return new e.Delta.PutIntoArray([].concat(a(t.values),a(r.values)))})})},function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e["default"]:e};var a=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}else{return Array.from(e)}};var i=function(){function e(e,t){for(var r in t){var n=t[r];n.configurable=true;if(n.value)n.writable=true}Object.defineProperties(e,t)}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o=function b(e,t,r){var n=Object.getOwnPropertyDescriptor(e,t);if(n===undefined){var a=Object.getPrototypeOf(e);if(a===null){return undefined}else{return b(a,t,r)}}else if("value"in n&&n.writable){return n.value}else{var i=n.get;if(i===undefined){return undefined}return i.call(r)}};var u=function(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)e.__proto__=t};var s=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var l=r(4);var f=l.isUndefined;var c=l.isDefined;var v=l.t;var p=l.define_d;var d=l.oncePer;var h=l.arraysEqual;var y=r(6).WritableTarget;var g=n(r(11));var m=n(r(12));var w=n(r(24));e.exports=d("PutIntoFunction",function(e){g(e);m(e);w(e);e.newOperationType("PutIntoFunction",function(e){function t(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++){r[n]=arguments[n]}s(this,t);o(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,r);this.values=this.arg?Array.isArray(this.arg)?this.arg:[this.arg]:[]}u(t,e);i(t,{clone:{value:function r(){var e=o(Object.getPrototypeOf(t.prototype),"clone",this).call(this);e.values=[].concat(a(this.values));return e}},equals:{value:function n(e){return h(this.values,e.values,function(e,t){return e.method===t.method&&e.value&&t.value})}},precondition:{value:function l(e){return c(e.value)&&typeof e.value==="function"&&(c(e.value._DeltaJs_functions)||e instanceof y)}},applyTo:{value:function v(e){if(f(e.value._DeltaJs_functions)){var t=e.value;var r=function(e){var t=function r(t){return e.apply(this,arguments)};t.toString=function(){return e.toString()};return t}(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++){t[n]=arguments[n]}var a=undefined;var i=true;var o=false;var u=undefined;try{for(var s=r._DeltaJs_functions[Symbol.iterator](),l;!(i=(l=s.next()).done);i=true){var f=l.value;a=f.apply(this,t)}}catch(c){o=true;u=c}finally{try{if(!i&&s["return"]){s["return"]()}}finally{if(o){throw u}}}return a});r._DeltaJs_functions=[function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++){r[n]=arguments[n]}t.apply(this,r)}];e.value=r}var n=e.value._DeltaJs_functions;var a=true;var i=false;var o=undefined;try{for(var u=this.values[Symbol.iterator](),s;!(a=(s=u.next()).done);a=true){var l=s.value;var c=l.method;var v=l.value;switch(c){case"prepend":{n.unshift(v)}break;case"insert":{var p=Math.floor(Math.random()*(n.length+1));n.splice(p,0,v)}break;case"append":{n.push(v)}break}}}catch(d){i=true;o=d}finally{try{if(!a&&u["return"]){u["return"]()}}finally{if(i){throw o}}}}},methods:{get:function(){return[]}}});return t}(e.Delta));e.newProxyMethod("prepend",function(t){return new e.Delta.PutIntoFunction({method:"prepend",value:t})});e.newProxyMethod("insert",function(t){return new e.Delta.PutIntoFunction({method:"insert",value:t})});e.newProxyMethod("append",function(t){return new e.Delta.PutIntoFunction({method:"append",value:t})});var t=p(e);e.newComposition(v("Modify","PutIntoFunction"),false);e.newComposition(v("Add","PutIntoFunction"),t("Add",function(e){var t=e.d2;var r=e.p1;return t.appliedTo(r)}));e.newComposition(v("Remove","PutIntoFunction"),false);e.newComposition(v("Forbid","PutIntoFunction"),false);e.newComposition(v("Replace","PutIntoFunction"),t("Replace",function(e){var t=e.d2;var r=e.p1;return t.appliedTo(r)}));e.newComposition(v("Update","PutIntoFunction"),true);e.newComposition(v("PutIntoFunction","Modify"),false);e.newComposition(v("PutIntoFunction","Add"),false);e.newComposition(v("PutIntoFunction","Remove"),t("Remove"));e.newComposition(v("PutIntoFunction","Forbid"),false);e.newComposition(v("PutIntoFunction","Replace"),t("Replace",function(e){var t=e.p2;return t}));e.newComposition(v("PutIntoFunction","Update"),true);e.newComposition(v("PutIntoFunction","PutIntoFunction"),function(t,r){return new e.Delta.PutIntoFunction([].concat(a(t.values),a(r.values)))})})},function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e["default"]:e};var a=function(e,t){if(Array.isArray(e)){return e}else if(Symbol.iterator in Object(e)){var r=[];for(var n=e[Symbol.iterator](),a;!(a=n.next()).done;){r.push(a.value);if(t&&r.length===t)break}return r}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}};var i=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}else{return Array.from(e)}};var o=function(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})};var u=function(){function e(e,t){for(var r in t){var n=t[r];n.configurable=true;if(n.value)n.writable=true}Object.defineProperties(e,t)}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var s=function P(e,t,r){var n=Object.getOwnPropertyDescriptor(e,t);if(n===undefined){var a=Object.getPrototypeOf(e);if(a===null){return undefined}else{return P(a,t,r)}}else if("value"in n&&n.writable){return n.value}else{var i=n.get;if(i===undefined){return undefined}return i.call(r)}};var l=function(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)e.__proto__=t};var f=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var c=n(r(22));var v=r(4);var p=v.extend;var d=v.isDefined;var h=v.indent;var y=v.oncePer;var g=v.o;var m=v.graphDescendants;var w=n(r(7));var b=n(r(11));var x=n(r(19));var _=r(8);var O=_.ApplicationOrderCycle;var E=_.UnresolvedDeltaConflict;e.exports=y("DeltaModel",function(e){x(e);e.newOperationType("DeltaModel",function(e){function t(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++){r[n]=arguments[n]}f(this,t);s(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,r);this.graph=new c}l(t,e);u(t,{clone:{value:function r(){var e=s(Object.getPrototypeOf(t.prototype),"clone",this).call(this);e.graph=this.graph.clone(function(e){return e.clone()});return e}},equals:{value:function n(e){var t=this.graph.transitiveReduction();var r=e.graph.transitiveReduction();return t.equals(r,function(e,t){return e.equals(t)})}},_assertNoUnresolvedConflicts:{value:function v(){var e=true;var t=false;var r=undefined;try{for(var n=this.conflicts()[Symbol.iterator](),a;!(e=(a=n.next()).done);e=true){var i=a.value;if(i.conflictResolvingDeltas.length===0){throw new E(i.conflictingDeltas)}}}catch(o){t=true;r=o}finally{try{if(!e&&n["return"]){n["return"]()}}finally{if(t){throw r}}}}},applyTo:{value:function d(e){var t=arguments[1]===undefined?{}:arguments[1];this._assertNoUnresolvedConflicts();var r=true;var n=false;var i=undefined;try{for(var o=this.graph.vertices_topologically()[Symbol.iterator](),u;!(r=(u=o.next()).done);r=true){var s=a(u.value,2);var l=s[1];l.applyTo(e,t)}}catch(f){n=true;i=f}finally{try{if(!r&&o["return"]){o["return"]()}}finally{if(n){throw i}}}}},toString:{value:function y(){var e=arguments[0]===undefined?{}:arguments[0];var r=s(Object.getPrototypeOf(t.prototype),"toString",this).call(this,e);if(this.graph.vertexCount()>0){var n="";var i=true;var o=false;var u=undefined;try{for(var l=this.graph.vertices_topologically()[Symbol.iterator](),f;!(i=(f=l.next()).done);i=true){var c=a(f.value,2);var v=c[0];var p=c[1];n+="["+v+"] "+p.toString(e)+"\n"}}catch(d){o=true;u=d}finally{try{if(!i&&l["return"]){l["return"]()}}finally{if(o){throw u}}}r+="\n"+h(n,4)}return r}},conflicts:{value:function w(){var e=this.graph.clone();var t="(sink)";while(e.hasVertex(t)){t=""+t+"'"}e.addNewVertex(t,null);var r=true;var n=false;var u=undefined;try{for(var s=e.vertices()[Symbol.iterator](),l;!(r=(l=s.next()).done);r=true){var f=a(l.value,1);var c=f[0];e.setVertex(c,null);if(c!==t){e.ensureEdge(c,t)}}}catch(v){n=true;u=v}finally{try{if(!r&&s["return"]){s["return"]()}}finally{if(n){throw u}}}e=e.transitiveReduction();var d={};var h=function(t){if(e.vertexValue(t)){return}var r={};var n=true;var u=false;var s=undefined;try{for(var l=e.verticesTo(t)[Symbol.iterator](),f;!(n=(f=l.next()).done);n=true){var c;(function(){c=a(f.value,1);var t=c[0];h(t);r[t]=o({},t,true);var n=e.vertexValue(t);p.apply(undefined,[r[t]].concat(i(Object.keys(n).map(function(e){return n[e]}))))})()}}catch(v){u=true;s=v}finally{try{if(!n&&l["return"]){l["return"]()}}finally{if(u){throw s}}}e.setVertex(t,r);var y=true;var m=false;var w=undefined;try{for(var b=Object.keys(r)[Symbol.iterator](),x;!(y=(x=b.next()).done);y=true){var _=x.value;var O=true;var E=false;var P=undefined;try{for(var C=Object.keys(r)[Symbol.iterator](),A;!(O=(A=C.next()).done);O=true){var k=A.value;if(_>=k){continue}var j=p({},r[_]);var D=p({},r[k]);var T=true;var S=false;var M=undefined;try{for(var V=Object.keys(j)[Symbol.iterator](),R;!(T=(R=V.next()).done);T=true){var F=R.value;var I=true;var N=false;var U=undefined;try{for(var q=Object.keys(D)[Symbol.iterator](),W;!(I=(W=q.next()).done);I=true){var J=W.value;if(F===J){delete j[F];delete D[J]}}}catch(v){N=true;U=v}finally{try{if(!I&&q["return"]){q["return"]()}}finally{if(N){throw U}}}}}catch(v){S=true;M=v}finally{try{if(!T&&V["return"]){V["return"]()}}finally{if(S){throw M}}}var H=true;var z=false;var B=undefined;try{for(var K=Object.keys(j)[Symbol.iterator](),Y;!(H=(Y=K.next()).done);H=true){var F=Y.value;var $=true;var L=false;var G=undefined;try{for(var Q=Object.keys(D)[Symbol.iterator](),X;!($=(X=Q.next()).done);$=true){var J=X.value;g.apply(undefined,[d].concat(i([F,J].sort())))[t]=true}}catch(v){L=true;G=v}finally{try{if(!$&&Q["return"]){Q["return"]()}}finally{if(L){throw G}}}}}catch(v){z=true;B=v}finally{try{if(!H&&K["return"]){K["return"]()}}finally{if(z){throw B}}}}}catch(v){E=true;P=v}finally{try{if(!O&&C["return"]){C["return"]()}}finally{if(E){throw P}}}}}catch(v){m=true;w=v}finally{try{if(!y&&b["return"]){b["return"]()}}finally{if(m){throw w}}}};h(t);var y=[];var w=true;var b=false;var x=undefined;try{for(var _=Object.keys(d)[Symbol.iterator](),O;!(w=(O=_.next()).done);w=true){var E=O.value;var P=true;var C=false;var A=undefined;try{for(var k=Object.keys(d[E])[Symbol.iterator](),j;!(P=(j=k.next()).done);P=true){var D=j.value;var T=this.graph.vertexValue(E);var S=this.graph.vertexValue(D);if(!T.commutesWith(S)){var M={conflictingDeltas:[E,D],conflictResolvingDeltas:[]};var V=true;var R=false;var F=undefined;try{for(var I=Object.keys(d[E][D])[Symbol.iterator](),N;!(V=(N=I.next()).done);V=true){var U=N.value;var q=true;var W=false;var J=undefined;try{for(var H=m(e,U)[Symbol.iterator](),z;!(q=(z=H.next()).done);q=true){var B=z.value;var K=this.graph.vertexValue(B);if(B!==t){if(K.resolves(T,S)){M.conflictResolvingDeltas.push(B)}}}}catch(v){W=true;J=v}finally{try{if(!q&&H["return"]){H["return"]()}}finally{if(W){throw J}}}}}catch(v){R=true;F=v}finally{try{if(!V&&I["return"]){I["return"]()}}finally{if(R){throw F}}}y.push(M)}}}catch(v){C=true;A=v}finally{try{if(!P&&k["return"]){k["return"]()}}finally{if(C){throw A}}}}}catch(v){b=true;x=v}finally{try{if(!w&&_["return"]){_["return"]()}}finally{if(b){throw x}}}return y}}});return t}(e.Delta),function(t){function r(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++){t[n]=arguments[n]}f(this,r);s(Object.getPrototypeOf(r.prototype),"constructor",this).apply(this,t);this._childOptions=new Map;this._childApplicationConditions=new Map}l(r,t);u(r,{processProxyArguments:{value:function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++){t[r]=arguments[r]}var n={};do{if(t.length===0){throw new Error("The argument list for this Modify.DeltaModel method is insufficient.")}var a=t.shift();if(typeof a==="string"){if(!n.name){n.name=a}else{n.path=a}}else{p(n,a)}}while(!n.path||!n.name);return{options:n,args:t}}},addOperation:{value:function a(t,r){var n=r.path;var a=r.name;var i=r.feature;if(!this._childApplicationConditions.has(a)){var o=undefined;if(i){o=e.newFeature(a,r)}else{o=e.newFeature("delta__"+a,p({hidden:true},r))}if(d(r.resolves)){o["if"](r.resolves);r=p({},r,{feature:false})}if(d(r.requires)){o.selects(r.requires)}if(i||o.conditional){t.applicationCondition=o}this._childApplicationConditions.set(a,o)}var u;if(n.prop){var s=p({},r,{name:undefined});var l=this.addChildProxy(a,new e.Delta.Modify);u=l.addOperation(t,s)}else{u=this.addChildProxy(a,t)}if(!this._childOptions.has(a)){this._childOptions.set(a,r)}return u}},delta:{value:function(e){var t=function r(){return e.apply(this,arguments)};t.toString=function(){return e.toString()};return t}(function(){var e=s(Object.getPrototypeOf(r.prototype),"delta",this).call(this);e.graph.clear();var t=true;var n=false;var a=undefined;try{for(var o=this.childKeys()[Symbol.iterator](),u;!(t=(u=o.next()).done);t=true){var l=u.value;var f=this._childOptions.get(l);var c=this.childDelta(l);e.graph.addVertex(l,c);var v=true;var p=false;var d=undefined;try{for(var h=[].concat(i(f.resolves||[]),i(f.after||[]),i(f.requires||[]))[Symbol.iterator](),y;!(v=(y=h.next()).done);v=true){var g=y.value;e.graph.createEdge(g,l);if(e.graph.hasCycle()){e.graph.removeExistingEdge(g,l);throw new O(g,l)}}}catch(m){p=true;d=m}finally{try{if(!v&&h["return"]){h["return"]()}}finally{if(p){throw d}}}if(f.feature||this._childApplicationConditions.get(l).conditional){c.applicationCondition=this._childApplicationConditions.get(l)}}}catch(m){n=true;a=m}finally{try{if(!t&&o["return"]){o["return"]()}}finally{if(n){throw a}}}return e})}});return r}(e.ContainerProxy));e.newComposition(function(t,r){return t instanceof e.Delta.DeltaModel||r instanceof e.Delta.DeltaModel},true)})},function(e,t,r){"use strict";var n=function(e,t){if(Array.isArray(e)){return e}else if(Symbol.iterator in Object(e)){var r=[];for(var n=e[Symbol.iterator](),a;!(a=n.next()).done;){r.push(a.value);if(t&&r.length===t)break}return r}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}};var a=function(){function e(e,t){for(var r in t){var n=t[r];n.configurable=true;if(n.value)n.writable=true}Object.defineProperties(e,t)}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var o=r(4);var u=o.extend;var s=o.a;var l=o.assert;var f=o.isUndefined;var c=o.oncePer;var v=r(8).ConstraintFailure;e.exports=c("features",function(e){c(e.constructor,"features",function(){u(e.constructor.prototype,{newFeature:function t(e){var t=arguments[1]===undefined?{}:arguments[1];l(f(this.features[e]),"A feature with the name '"+e+"' already exists.");return this.features[e]=new this.Feature(e,t)}})});function t(t){t=Array.isArray(t)?t:[t];t=t.map(function(t){return t instanceof e.Feature?t.name:t});return t}var r=new Map;var o=new Map;function p(e){var n=arguments[1]===undefined?[]:arguments[1];w=true;if(n===true){o.set(e,true)}else if(n===false){}else if(r.get(e)!==true){s(r,e).push(t(n))}}function d(e,r){var n=true;var a=false;var i=undefined;try{for(var o=t(r)[Symbol.iterator](),u;!(n=(u=o.next()).done);n=true){var s=u.value;p(s,e)}}catch(l){a=true;i=l}finally{try{if(!n&&o["return"]){o["return"]()}}finally{if(a){throw i}}}}var h=new Map;var y=new Map;function g(e){var r=arguments[1]===undefined?[]:arguments[1];w=true;if(r===false){y.set(e,false)}else if(r===true){}else if(h.get(e)!==false){s(h,e).push(t(r))}}function m(e,r){var n=true;var a=false;var i=undefined;try{for(var o=t(r)[Symbol.iterator](),u;!(n=(u=o.next()).done);n=true){var s=u.value;g(s,e)}}catch(l){a=true;i=l}finally{try{if(!n&&o["return"]){o["return"]()}}finally{if(a){throw i}}}}var w=false;function b(){if(!w){return}w=false;var t;do{t=false;var n=true;var a=false;var i=undefined;try{for(var u=Object.keys(e.features)[Symbol.iterator](),s;!(n=(s=u.next()).done);n=true){var l=s.value;if(!o.get(l)){if(o.has(l)){o.set(l,false)}if((r.get(l)||[]).some(function(e){return e.every(function(e){return o.get(e)})})){o.set(l,true);t=true}}}}catch(f){a=true;i=f}finally{try{if(!n&&u["return"]){u["return"]()}}finally{if(a){throw i}}}}while(t);var c=true;var v=false;var p=undefined;try{for(var d=Object.keys(e.features)[Symbol.iterator](),g;!(c=(g=d.next()).done);c=true){var l=g.value;y.set(l,(h.get(l)||[]).every(function(e){return e.some(function(e){return o.get(e)})}))}}catch(f){v=true;p=f}finally{try{if(!c&&d["return"]){d["return"]()}}finally{if(v){throw p}}}}e.Feature=function(){function e(t){var r=arguments[1]===undefined?{}:arguments[1];i(this,e);this.name=t;this.options=r;var n=true;var a=false;var o=undefined;try{for(var u=Object.keys(r)[Symbol.iterator](),s;!(n=(s=u.next()).done);n=true){var l=s.value;this.addOption(l,r[l])}}catch(f){a=true;o=f}finally{try{if(!n&&u["return"]){u["return"]()}}finally{if(a){throw o}}}}a(e,{selected:{get:function(){b();if(o.get(this.name)&&!y.get(this.name)){throw new v(this)}return o.get(this.name)}},condition:{get:function(){return r.get(this.name)}},conditional:{get:function(){return s(r,this.name).length>0}},restricted:{get:function(){return s(h,this.name).length>0}},select:{value:function t(){this["if"](true)}}});return e}();var x=[["if",[p]],["onlyIf",[g]],["selects",[d]],["requiredBy",[m]],["iff",[p,g]]];e.Feature.prototype.addOption=function(e,t){var r=true;var a=false;var i=undefined;try{for(var o=x[Symbol.iterator](),u;!(r=(u=o.next()).done);r=true){var s=n(u.value,2);var l=s[0];var f=s[1];if(e===l){var c=true;var v=false;var p=undefined;try{for(var d=f[Symbol.iterator](),h;!(c=(h=d.next()).done);c=true){var y=h.value;y(this.name,t)}}catch(g){v=true;p=g}finally{try{if(!c&&d["return"]){d["return"]()}}finally{if(v){throw p}}}}}}catch(g){a=true;i=g}finally{try{if(!r&&o["return"]){o["return"]()}}finally{if(a){throw i}}}};var _=true;var O=false;var E=undefined;try{for(var P=x[Symbol.iterator](),C;!(_=(C=P.next()).done);_=true){var A;(function(){A=n(C.value,1);var t=A[0];e.Feature.prototype[t]=function(e){this.addOption(t,e)}})()}}catch(k){O=true;E=k}finally{try{if(!_&&P["return"]){P["return"]()}}finally{if(O){throw E}}}e.features={}})},function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e["default"]:e};var a=function(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})};var i=r(4);var o=i.extend;var u=i.oncePer;var s=n(r(15));e.exports=u("variation points",function(e){u(e.constructor,"variation points",function(){s(e);o(e.constructor.prototype,{vp:function t(e,r){var n=a({},e,r);this._deltaModelProxy.delta().applyTo(n,{restrictToProperty:e});return n[e]},"do":function r(){var e;for(var t=arguments.length,r=Array(t),n=0;n<t;n++){r[n]=arguments[n]}return(e=this._deltaModelProxy)["do"].apply(e,[{feature:true}].concat(r))}})});e._deltaModelProxy=(new e.Delta.DeltaModel)["do"]()})},function(e,t,r){"use strict";var n=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}else{return Array.from(e)}};var a=r(4);var i=a.extend;var o=a.isUndefined;var u=a.oncePer;e.exports=u("application conditions",function(e){u(e.constructor,"application conditions",function(){i(e.constructor.prototype,{select:function t(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++){t[r]=arguments[r]}var a=true;var i=false;var o=undefined;try{for(var u=t[Symbol.iterator](),s;!(a=(s=u.next()).done);a=true){var l=s.value;if(Array.isArray(l)){this.select.apply(this,n(l))}else{this.features[l].select()}}}catch(f){i=true;o=f}finally{try{if(!a&&u["return"]){u["return"]()}}finally{if(i){throw o}}}}})});i(e.Delta.prototype,Object.defineProperties({},{applicationCondition:{get:function(){return this._applicationCondition},set:function(e){this._applicationCondition=e},configurable:true,enumerable:true},selected:{get:function(){return o(this.applicationCondition)||this.applicationCondition.selected},configurable:true,enumerable:true}}))})},function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e["default"]:e};var a=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}else{return Array.from(e)}};var i=function(){function e(e,t){for(var r in t){var n=t[r];n.configurable=true;if(n.value)n.writable=true}Object.defineProperties(e,t)}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o=function w(e,t,r){var n=Object.getOwnPropertyDescriptor(e,t);if(n===undefined){var a=Object.getPrototypeOf(e);if(a===null){return undefined}else{return w(a,t,r)}}else if("value"in n&&n.writable){return n.value}else{var i=n.get;if(i===undefined){return undefined}return i.call(r)}};var u=function(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)e.__proto__=t};var s=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var l=n(r(22));var f=r(4);var c=f.extend;var v=f.a;var p=f.isUndefined;var d=f.oncePer;var h=n(r(7));var y=n(r(10));var g=n(r(24));var m=r(8).MultipleActiveProxiesError;e.exports=d("ContainerProxy",function(e){g(e);e.ContainerProxy=function(t){function r(){var e=arguments[0]===undefined?{}:arguments[0];s(this,r);o(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,e);this._doArgs=[];this._original=this;this._children=new Map}u(r,t);i(r,{deactivate:{value:function n(){var e=true;var t=false;var n=undefined;try{for(var a=this._children.keys()[Symbol.iterator](),i;!(e=(i=a.next()).done);e=true){var u=i.value;this.childProxy(u).deactivate()}}catch(s){t=true;n=s}finally{try{if(!e&&a["return"]){a["return"]()}}finally{if(t){throw n}}}o(Object.getPrototypeOf(r.prototype),"deactivate",this).call(this)}},addChildProxy:{value:function l(t,r){var n=this.childProxy(t);var a=r.constructor.Proxy||e.Proxy;var i=new a({delta:r,parent:this});if(n instanceof e.Delta.Modify.Proxy&&i instanceof e.Delta.Modify.Proxy){return n}if(n){n.deactivate()}this._children.get(t).push(i);return i}},childKeys:{value:function f(){return[].concat(a(this._children.keys()))}},childProxies:{value:function c(e){return v(this._children,e)}},childProxy:{value:function d(e){if(!this._children.has(e)){this._children.set(e,[])}return this._children.get(e)[this._children.get(e).length-1]}},childDelta:{value:function g(t){var r;return(r=e.Delta).composed.apply(r,a(this.childProxies(t).map(function(e){return e.delta()})))}},"do":{value:function w(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++){t[r]=arguments[r]}if(!this.active){throw new m}var n=Object.create(this);n._doArgs=[].concat(a(this._doArgs),t);n._original=this._original;return n}},_do:{value:function b(t,r){if(!this.active){throw new m}var n=this.processProxyArguments.apply(this,a(this._doArgs).concat(a(r)));var i=n.options;var o=n.args;if(typeof i.path==="string"){i.path=new h(i.path)}var u=e.ContainerProxy._newDeltaByMethod(t,o);var s=this.addOperation(u,i);return s instanceof e.ContainerProxy?s:this}},processProxyArguments:{value:function x(){throw new Error("A 'ContainerProxy' subclass needs to implement the 'processProxyArguments' method.")}},addOperation:{value:function _(){throw new Error("A 'ContainerProxy' subclass needs to implement the 'addOperation' method.")}}},{_newDeltaByMethod:{value:function O(t,r){var n=e.ContainerProxy._methodHandlers[t].map(function(e){return e.apply(undefined,a(r))});if(n.length===1){return n[0]}else{y(e);return new e.Delta.Overloaded(n)}}},newProxyMethod:{value:function E(t,r){if(p(e.ContainerProxy.prototype[t])){e.ContainerProxy.prototype[t]=function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++){r[n]=arguments[n]}return this._do(t,r)}}v(e.ContainerProxy,"_methodHandlers",t).push(r)}}});return r}(e.Proxy)})},,,function(e,t,r){"use strict";var n=function(e,t){if(Array.isArray(e)){return e}else if(Symbol.iterator in Object(e)){var r=[];for(var n=e[Symbol.iterator](),a;!(a=n.next()).done;){r.push(a.value);if(t&&r.length===t)break}return r}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}};var a=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}else{return Array.from(e)}};var i=function(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})};var o=function(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)e.__proto__=t};var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.configurable=true;if(n.value)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var s=function(){function e(e,t){for(var r in t){var n=t[r];n.configurable=true;if(n.value)n.writable=true}Object.defineProperties(e,t)}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var l=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var f=function(){function e(){l(this,e);this._callbacks=new Set}s(e,{add:{value:function t(e){var t=this;if(!this._callbacks.has(e)){this._callbacks.add(e)}return function(){t._callbacks["delete"](e)}}},fire:{value:function r(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++){t[r]=arguments[r]}var n=true;var a=false;var i=undefined;try{for(var o=this._callbacks[Symbol.iterator](),u;!(n=(u=o.next()).done);n=true){var s=u.value;s.apply(undefined,t)}}catch(l){a=true;i=l}finally{try{if(!n&&o["return"]){o["return"]()}}finally{if(a){throw i}}}}}});return e}();var c=function(){function e(){l(this,e);this._vertices=new Map;this._edges=new Map;this._reverseEdges=new Map;this._vertexCount=0;this._edgeCount=0;this._addVertexCallbacks=new f;this._removeVertexCallbacks=new f;this._addEdgeCallbacks=new f;this._removeEdgeCallbacks=new f}u(e,[{key:"onAddVertex",value:function t(e){return this._addVertexCallbacks.add(e)}},{key:"onRemoveVertex",value:function r(e){return this._removeVertexCallbacks.add(e)}},{key:"addNewVertex",value:function i(t,r){if(this.hasVertex(t)){throw new e.VertexExistsError(t,this._vertices.get(t))}this._vertices.set(t,r);this._edges.set(t,new Map);this._reverseEdges.set(t,new Set);this._vertexCount+=1;this._addVertexCallbacks.fire(t,r)}},{key:"setVertex",value:function o(t,r){if(!this.hasVertex(t)){throw new e.VertexNotExistsError(t)}this._vertices.set(t,r)}},{key:"ensureVertex",value:function s(e,t){if(!this.hasVertex(e)){this.addNewVertex(e,t)}}},{key:"addVertex",value:function c(e,t){if(this.hasVertex(e)){this.setVertex(e,t)}else{this.addNewVertex(e,t)}}},{key:"removeExistingVertex",value:function v(t){if(!this.hasVertex(t)){throw new e.VertexNotExistsError(t)}if(this._edges.get(t).size>0){throw new e.HasConnectedEdgesError(t)}if(this._reverseEdges.get(t).size>0){throw new e.HasConnectedEdgesError(t)}var r=this._vertices.get(t);this._vertices["delete"](t);this._vertexCount-=1;this._removeVertexCallbacks.fire(t,r)}},{key:"destroyExistingVertex",value:function p(t){var r=this;if(!this.hasVertex(t)){throw new e.VertexNotExistsError(t)}this.eachVertexFrom(t,function(e){r.removeEdge(t,e)});this.eachVertexTo(t,function(e){r.removeEdge(e,t)});this.removeExistingVertex(t)}},{key:"removeVertex",value:function d(e){if(this.hasVertex(e)){this.removeExistingVertex(e)}}},{key:"destroyVertex",value:function h(e){if(this.hasVertex(e)){this.destroyExistingVertex(e)}}},{key:"vertexCount",value:function y(){return this._vertexCount}},{key:"hasVertex",value:function g(e){return this._vertices.has(e)}},{key:"vertexValue",value:function m(e){return this._vertices.get(e)}},{key:"onAddEdge",value:function w(e){return this._addEdgeCallbacks.add(e)}},{key:"onRemoveEdge",value:function b(e){return this._removeEdgeCallbacks.add(e)}},{key:"addNewEdge",value:function x(t,r,n){if(this.hasEdge(t,r)){throw new e.EdgeExistsError(t,r,this.edgeValue(t,r))}if(!this.hasVertex(t)){if(this.hasVertex(r)){throw new e.VertexNotExistsError(t)}else{throw new e.VertexNotExistsError(t).v(r)}}else if(!this.hasVertex(r)){throw new e.VertexNotExistsError(r)}this._edges.get(t).set(r,n);this._reverseEdges.get(r).add(t);this._edgeCount+=1;this._addEdgeCallbacks.fire(t,r,n)}},{key:"createNewEdge",value:function _(t,r,n){if(this.hasEdge(t,r)){throw new e.EdgeExistsError(t,r,this.edgeValue(t,r))}this.ensureVertex(t);this.ensureVertex(r);this.addNewEdge(t,r,n)}},{key:"setEdge",value:function O(t,r,n){if(!this.hasEdge(t,r)){throw new e.EdgeNotExistsError(t,r)}this._edges.get(t).set(r,n)}},{key:"spanEdge",value:function E(t,r,n){if(!this.hasVertex(t)){if(this.hasVertex(r)){throw new e.VertexNotExistsError(t)}else{throw new e.VertexNotExistsError(t).v(r);

}}else if(!this.hasVertex(r)){throw new e.VertexNotExistsError(r)}if(!this.hasEdge(t,r)){this.addNewEdge(t,r,n)}}},{key:"addEdge",value:function P(e,t,r){if(this.hasEdge(e,t)){this.setEdge(e,t,r)}else{this.addNewEdge(e,t,r)}}},{key:"ensureEdge",value:function C(e,t,r){if(!this.hasEdge(e,t)){this.createNewEdge(e,t,r)}}},{key:"createEdge",value:function A(e,t,r){if(this.hasEdge(e,t)){this.setEdge(e,t,r)}else{this.createNewEdge(e,t,r)}}},{key:"removeExistingEdge",value:function k(t,r){if(!this.hasEdge(t,r)){throw new e.EdgeNotExistsError(t,r)}var n=this._edges.get(t).get(r);this._edges.get(t)["delete"](r);this._reverseEdges.get(r)["delete"](t);this._edgeCount-=1;this._removeEdgeCallbacks.fire(t,r,n)}},{key:"removeEdge",value:function j(e,t){if(this.hasEdge(e,t)){this.removeExistingEdge(e,t)}}},{key:"edgeCount",value:function D(){return this._edgeCount}},{key:"hasEdge",value:function T(e,t){return this.hasVertex(e)&&this.hasVertex(t)&&this._edges.has(e)&&this._edges.get(e).has(t)}},{key:"edgeValue",value:function S(e,t){return this.hasEdge(e,t)?this._edges.get(e).get(t):undefined}},{key:Symbol.iterator,value:function(){return this.vertices()}},{key:"vertices",value:regeneratorRuntime.mark(function M(){var e=this;var t,r,a,i,o,u,s,l,f;return regeneratorRuntime.wrap(function c(v){while(1)switch(v.prev=v.next){case 0:t=new Set;r=true;a=false;i=undefined;v.prev=4;o=e._vertices[Symbol.iterator]();case 6:if(r=(u=o.next()).done){v.next=17;break}s=n(u.value,2);l=s[0];f=s[1];if(!(e.hasVertex(l)&&!t.has(l))){v.next=14;break}t.add(l);v.next=14;return[l,f];case 14:r=true;v.next=6;break;case 17:v.next=23;break;case 19:v.prev=19;v.t0=v["catch"](4);a=true;i=v.t0;case 23:v.prev=23;v.prev=24;if(!r&&o["return"]){o["return"]()}case 26:v.prev=26;if(!a){v.next=29;break}throw i;case 29:return v.finish(26);case 30:return v.finish(23);case 31:case"end":return v.stop()}},M,this,[[4,19,23,31],[24,,26,30]])})},{key:"edges",value:regeneratorRuntime.mark(function V(){var e=this;var t,r,n,a,i,o,u,s,l,f,c,v,p;return regeneratorRuntime.wrap(function d(h){while(1)switch(h.prev=h.next){case 0:t=new Map;r=true;n=false;a=undefined;h.prev=4;i=e._edges.keys()[Symbol.iterator]();case 6:if(r=(o=i.next()).done){h.next=40;break}u=o.value;if(!t.has(u)){t.set(u,new Set)}s=true;l=false;f=undefined;h.prev=12;c=e._edges.get(u).keys()[Symbol.iterator]();case 14:if(s=(v=c.next()).done){h.next=23;break}p=v.value;if(!(e.hasEdge(u,p)&&!t.get(u).has(p))){h.next=20;break}t.get(u).add(p);h.next=20;return[u,p,e._edges.get(u).get(p)];case 20:s=true;h.next=14;break;case 23:h.next=29;break;case 25:h.prev=25;h.t1=h["catch"](12);l=true;f=h.t1;case 29:h.prev=29;h.prev=30;if(!s&&c["return"]){c["return"]()}case 32:h.prev=32;if(!l){h.next=35;break}throw f;case 35:return h.finish(32);case 36:return h.finish(29);case 37:r=true;h.next=6;break;case 40:h.next=46;break;case 42:h.prev=42;h.t2=h["catch"](4);n=true;a=h.t2;case 46:h.prev=46;h.prev=47;if(!r&&i["return"]){i["return"]()}case 49:h.prev=49;if(!n){h.next=52;break}throw a;case 52:return h.finish(49);case 53:return h.finish(46);case 54:case"end":return h.stop()}},V,this,[[4,42,46,54],[12,25,29,37],[30,,32,36],[47,,49,53]])})},{key:"verticesFrom",value:function R(t){if(!this.hasVertex(t)){throw new e.VertexNotExistsError(t)}return this._verticesFrom(t)}},{key:"_verticesFrom",value:regeneratorRuntime.mark(function F(e){var t=this;var r,n,a,i,o,u,s;return regeneratorRuntime.wrap(function l(f){while(1)switch(f.prev=f.next){case 0:r=new Set;n=true;a=false;i=undefined;f.prev=4;o=t._edges.get(e).keys()[Symbol.iterator]();case 6:if(n=(u=o.next()).done){f.next=15;break}s=u.value;if(!(t.hasEdge(e,s)&&!r.has(s))){f.next=12;break}r.add(s);f.next=12;return[s,t._vertices.get(s),t._edges.get(e).get(s)];case 12:n=true;f.next=6;break;case 15:f.next=21;break;case 17:f.prev=17;f.t3=f["catch"](4);a=true;i=f.t3;case 21:f.prev=21;f.prev=22;if(!n&&o["return"]){o["return"]()}case 24:f.prev=24;if(!a){f.next=27;break}throw i;case 27:return f.finish(24);case 28:return f.finish(21);case 29:case"end":return f.stop()}},F,this,[[4,17,21,29],[22,,24,28]])})},{key:"verticesTo",value:function I(t){if(!this.hasVertex(t)){throw new e.VertexNotExistsError(t)}return this._verticesTo(t)}},{key:"_verticesTo",value:regeneratorRuntime.mark(function N(e){var t=this;var r,n,a,i,o,u,s;return regeneratorRuntime.wrap(function l(f){while(1)switch(f.prev=f.next){case 0:r=new Set;n=true;a=false;i=undefined;f.prev=4;o=t._reverseEdges.get(e)[Symbol.iterator]();case 6:if(n=(u=o.next()).done){f.next=15;break}s=u.value;if(!(t.hasEdge(s,e)&&!r.has(s))){f.next=12;break}r.add(s);f.next=12;return[s,t._vertices.get(s),t._edges.get(s).get(e)];case 12:n=true;f.next=6;break;case 15:f.next=21;break;case 17:f.prev=17;f.t4=f["catch"](4);a=true;i=f.t4;case 21:f.prev=21;f.prev=22;if(!n&&o["return"]){o["return"]()}case 24:f.prev=24;if(!a){f.next=27;break}throw i;case 27:return f.finish(24);case 28:return f.finish(21);case 29:case"end":return f.stop()}},N,this,[[4,17,21,29],[22,,24,28]])})},{key:"vertices_topologically",value:regeneratorRuntime.mark(function U(){var t=this;var r=regeneratorRuntime.mark(function d(t){var r,u,s,l,f,c,v,p,h;return regeneratorRuntime.wrap(function y(g){while(1)switch(g.prev=g.next){case 0:a.push(t);r=a.indexOf(t);if(!(r!==a.length-1)){g.next=5;break}u=a.slice(r+1).reverse();throw new e.CycleError(u);case 5:if(i.has(t)){g.next=36;break}s=true;l=false;f=undefined;g.prev=9;c=o.verticesTo(t)[Symbol.iterator]();case 11:if(s=(v=c.next()).done){g.next=18;break}p=n(v.value,1);h=p[0];return g.delegateYield(d(h),"t5",15);case 15:s=true;g.next=11;break;case 18:g.next=24;break;case 20:g.prev=20;g.t6=g["catch"](9);l=true;f=g.t6;case 24:g.prev=24;g.prev=25;if(!s&&c["return"]){c["return"]()}case 27:g.prev=27;if(!l){g.next=30;break}throw f;case 30:return g.finish(27);case 31:return g.finish(24);case 32:if(!o.hasVertex(t)){g.next=35;break}g.next=35;return[t,o._vertices.get(t)];case 35:i.add(t);case 36:a.pop();case 37:case"end":return g.stop()}},d,this,[[9,20,24,32],[25,,27,31]])});var a,i,o,u,s,l,f,c,v,p;return regeneratorRuntime.wrap(function h(e){while(1)switch(e.prev=e.next){case 0:a=[];i=new Set;o=t;u=true;s=false;l=undefined;e.prev=6;f=t.vertices()[Symbol.iterator]();case 8:if(u=(c=f.next()).done){e.next=16;break}v=n(c.value,1);p=v[0];if(i.has(p)){e.next=13;break}return e.delegateYield(r(p),"t7",13);case 13:u=true;e.next=8;break;case 16:e.next=22;break;case 18:e.prev=18;e.t8=e["catch"](6);s=true;l=e.t8;case 22:e.prev=22;e.prev=23;if(!u&&f["return"]){f["return"]()}case 25:e.prev=25;if(!s){e.next=28;break}throw l;case 28:return e.finish(25);case 29:return e.finish(22);case 30:case"end":return e.stop()}},U,this,[[6,18,22,30],[23,,25,29]])})},{key:"eachVertex",value:function q(e){var t=true;var r=false;var n=undefined;try{for(var i=this.vertices()[Symbol.iterator](),o;!(t=(o=i.next()).done);t=true){var u=o.value;if(e.apply(undefined,a(u))===false){break}}}catch(s){r=true;n=s}finally{try{if(!t&&i["return"]){i["return"]()}}finally{if(r){throw n}}}}},{key:"eachVertexFrom",value:function W(e,t){var r=true;var n=false;var i=undefined;try{for(var o=this.verticesFrom(e)[Symbol.iterator](),u;!(r=(u=o.next()).done);r=true){var s=u.value;if(t.apply(undefined,a(s))===false){break}}}catch(l){n=true;i=l}finally{try{if(!r&&o["return"]){o["return"]()}}finally{if(n){throw i}}}}},{key:"eachVertexTo",value:function J(e,t){var r=true;var n=false;var i=undefined;try{for(var o=this.verticesTo(e)[Symbol.iterator](),u;!(r=(u=o.next()).done);r=true){var s=u.value;if(t.apply(undefined,a(s))===false){break}}}catch(l){n=true;i=l}finally{try{if(!r&&o["return"]){o["return"]()}}finally{if(n){throw i}}}}},{key:"eachEdge",value:function H(e){var t=true;var r=false;var n=undefined;try{for(var i=this.edges()[Symbol.iterator](),o;!(t=(o=i.next()).done);t=true){var u=o.value;if(e.apply(undefined,a(u))===false){break}}}catch(s){r=true;n=s}finally{try{if(!t&&i["return"]){i["return"]()}}finally{if(r){throw n}}}}},{key:"eachVertexTopologically",value:function z(e){var t=true;var r=false;var n=undefined;try{for(var i=this.vertices_topologically()[Symbol.iterator](),o;!(t=(o=i.next()).done);t=true){var u=o.value;if(e.apply(undefined,a(u))===false){break}}}catch(s){r=true;n=s}finally{try{if(!t&&i["return"]){i["return"]()}}finally{if(r){throw n}}}}},{key:"clearEdges",value:function B(){var e=this;this.eachEdge(function(t,r){e.removeEdge(t,r)})}},{key:"clear",value:function K(){var e=this;this.eachVertex(function(t){e.destroyVertex(t)})}},{key:"hasCycle",value:function Y(){var e=this;var t={};var r={};var n=false;var a=function(i){if(t[i]){n=true;return}if(r[i]){return}r[i]=true;t[i]=true;e.eachVertexFrom(i,function(e){a(e);if(n){return false}});t[i]=false};this.eachVertex(function(e){a(e);if(n){return false}});return n}},{key:"hasPath",value:function $(e,t){var r=this;if(!this.hasVertex(e)||!this.hasVertex(t)){return false}var n={};var a=function(e){if(r.hasEdge(e,t)){return true}n[e]=true;var i=false;r.eachVertexFrom(e,function(e){if(!i&&!n[e]&&a(e)){i=true}});delete n[e];return i};return a(e)}},{key:"clone",value:function L(){var t=new e;var r=true;var a=false;var i=undefined;try{for(var o=this.vertices()[Symbol.iterator](),u;!(r=(u=o.next()).done);r=true){var s=n(u.value,2);var l=s[0];var f=s[1];t.addVertex(l,f)}}catch(c){a=true;i=c}finally{try{if(!r&&o["return"]){o["return"]()}}finally{if(a){throw i}}}var v=true;var p=false;var d=undefined;try{for(var h=this.edges()[Symbol.iterator](),y;!(v=(y=h.next()).done);v=true){var g=n(y.value,3);var m=g[0];var w=g[1];var f=g[2];t.addEdge(m,w,f)}}catch(c){p=true;d=c}finally{try{if(!v&&h["return"]){h["return"]()}}finally{if(p){throw d}}}return t}},{key:"transitiveReduction",value:function G(){var e=this.clone();var t=true;var r=false;var a=undefined;try{for(var i=this.vertices()[Symbol.iterator](),o;!(t=(o=i.next()).done);t=true){var u=n(o.value,1);var s=u[0];var l=true;var f=false;var c=undefined;try{for(var v=this.vertices()[Symbol.iterator](),p;!(l=(p=v.next()).done);l=true){var d=n(p.value,1);var h=d[0];if(e.hasEdge(s,h)){var y=true;var g=false;var m=undefined;try{for(var w=this.vertices()[Symbol.iterator](),b;!(y=(b=w.next()).done);y=true){var x=n(b.value,1);var _=x[0];if(e.hasPath(h,_)){e.removeEdge(s,_)}}}catch(O){g=true;m=O}finally{try{if(!y&&w["return"]){w["return"]()}}finally{if(g){throw m}}}}}}catch(O){f=true;c=O}finally{try{if(!l&&v["return"]){v["return"]()}}finally{if(f){throw c}}}}}catch(O){r=true;a=O}finally{try{if(!t&&i["return"]){i["return"]()}}finally{if(r){throw a}}}return e}}]);return e}();e.exports=c;c.VertexExistsError=function(e){function t(e,r){l(this,t);this.vertices={};this.v(e,r)}o(t,e);s(t,{v:{value:function r(e,t){this.vertices[e]=t;this._refreshMessage();return this}},_refreshMessage:{value:function n(){var e=this.vertices===1?"a vertex":"vertices";this.message="This graph has "+e+" '"+Object.keys(this.vertices).join("', '")+"'"}}});return t}(Error);c.VertexNotExistsError=function(e){function t(e){l(this,t);this.vertices={};this.v(e)}o(t,e);s(t,{v:{value:function r(e){this.vertices[e]=undefined;this._refreshMessage();return this}},_refreshMessage:{value:function n(){var e=this.vertices===1?"a vertex":"vertices";this.message="This graph does not have "+e+" '"+Object.keys(this.vertices).join("', '")+"'"}}});return t}(Error);c.EdgeExistsError=function(e){function t(e,r,n){l(this,t);this.edges={};this.e(e,r,n)}o(t,e);s(t,{e:{value:function r(e,t,n){this.edges[e]=i({},t,n);this._refreshMessage();return this}},_refreshMessage:{value:function n(){var e=this;var t=[];Object.keys(this.edges).forEach(function(r){Object.keys(e.edges[r]).forEach(function(e){t.push("('"+r+"', '"+e+"')")})});var r=t.length===1?"an edge":"edges";this.message="This graph has "+r+" "+t.join(", ")}}});return t}(Error);c.EdgeNotExistsError=function(e){function t(e,r){l(this,t);this.edges={};this.e(e,r)}o(t,e);s(t,{e:{value:function r(e,t){this.edges[e]=i({},t,undefined);this._refreshMessage();return this}},_refreshMessage:{value:function n(){var e=this;var t=[];Object.keys(this.edges).forEach(function(r){Object.keys(e.edges[r]).forEach(function(e){t.push("('"+r+"', '"+e+"')")})});var r=t.length===1?"an edge":"edges";this.message="This graph does not have "+r+" "+t.join(", ")}}});return t}(Error);c.HasConnectedEdgesError=function(e){function t(e){l(this,t);this.message="The '"+e+"' vertex has connected edges";this.key=e}o(t,e);return t}(Error);c.CycleError=function(e){function t(e){l(this,t);this.message="This graph contains a cycle: "+e;this.cycle=e}o(t,e);return t}(Error)},function(e,t,r){"use strict";var n=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}else{return Array.from(e)}};var a=function(){function e(e,t){for(var r in t){var n=t[r];n.configurable=true;if(n.value)n.writable=true}Object.defineProperties(e,t)}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function v(e,t,r){var n=Object.getOwnPropertyDescriptor(e,t);if(n===undefined){var a=Object.getPrototypeOf(e);if(a===null){return undefined}else{return v(a,t,r)}}else if("value"in n&&n.writable){return n.value}else{var i=n.get;if(i===undefined){return undefined}return i.call(r)}};var o=function(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)e.__proto__=t};var u=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var s=r(4);var l=s.indent;var f=s.oncePer;var c=s.arraysEqual;e.exports=f("Composed",function(e){e.newOperationType("Composed",function(t){function r(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++){t[n]=arguments[n]}u(this,r);i(Object.getPrototypeOf(r.prototype),"constructor",this).apply(this,t);this._components=this.arg||[]}o(r,t);a(r,{clone:{value:function s(){var e=i(Object.getPrototypeOf(r.prototype),"clone",this).call(this);e._components=this._components.map(function(e){return e.clone()});return e}},equals:{value:function f(e){return c(this._components,e._components,function(e,t){return e.equals(t)})}},applyTo:{value:function v(e){var t=arguments[1]===undefined?{}:arguments[1];var r=true;var n=false;var a=undefined;try{for(var i=this._components[Symbol.iterator](),o;!(r=(o=i.next()).done);r=true){var u=o.value;u.applyTo(e,t)}}catch(s){n=true;a=s}finally{try{if(!r&&i["return"]){i["return"]()}}finally{if(n){throw a}}}}},toString:{value:function p(){var e=arguments[0]===undefined?{}:arguments[0];var t=i(Object.getPrototypeOf(r.prototype),"toString",this).call(this,e);if(this._components.length>0){var n="";var a=true;var o=false;var u=undefined;try{for(var s=this._components[Symbol.iterator](),f;!(a=(f=s.next()).done);a=true){var c=f.value;n+="• "+c.toString(e)+"\n"}}catch(v){o=true;u=v}finally{try{if(!a&&s["return"]){s["return"]()}}finally{if(o){throw u}}}t+="\n"+l(n,4)}return t}},precondition:{value:function d(e){if(this._components.length===0){return true}return this._components[0].precondition(e)}},_collapse:{value:function h(){var t=this;this._components=function(){var r=[];var a=true;var i=false;var o=undefined;try{for(var u=t._components[Symbol.iterator](),s;!(a=(s=u.next()).done);a=true){var l=s.value;if(l instanceof e.Delta.Composed){l._collapse();r.push.apply(r,n(l._components))}else{r.push(l)}}}catch(f){i=true;o=f}finally{try{if(!a&&u["return"]){u["return"]()}}finally{if(i){throw o}}}return r}();var r=undefined;do{r=false;this._components=function(){var n=[];for(var a=0;a<t._components.length-1;a+=1){var i=t._components[a].composedWith(t._components[a+1]);if(i instanceof e.Delta.Composed){n.push(t._components[a])}else{n.push(i);r=true;a+=1}}if(a===t._components.length-1){n.push(t._components[a])}return n}()}while(r)}},methods:{get:function(){return[]}}});return r}(e.Delta));e.newComposition(function(t,r){return t instanceof e.Delta.Composed||r instanceof e.Delta.Composed},function(t,r){var a=t instanceof e.Delta.Composed?t._components:[t];var i=r instanceof e.Delta.Composed?r._components:[r];var o=new e.Delta.Composed([].concat(n(a),n(i)));o._collapse();return o})})},function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e["default"]:e};var a=function(){function e(e,t){for(var r in t){var n=t[r];n.configurable=true;if(n.value)n.writable=true}Object.defineProperties(e,t)}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var o=n(r(22));var u=r(4);var s=u.extend;var l=u.oncePer;var f=n(r(9));e.exports=l("Proxy",function(e){f(e);e.Proxy=function(){function e(){var t=arguments[0]===undefined?{}:arguments[0];var r=t.parent;var n=t.delta;i(this,e);this._parent=r;this._active=true;this._delta=n}a(e,{delta:{value:function t(){return this._delta}},active:{get:function(){return this._active}},deactivate:{value:function r(){this._active=false}}});return e}();s(e.Delta.prototype,{"do":function t(){var e;for(var t=arguments.length,r=Array(t),n=0;n<t;n++){r[n]=arguments[n]}var a=this.constructor.Proxy;if(!a){throw new Error("Calling 'do' on delta type '"+this.type+"', which has no Proxy interface.")}return(e=new a({delta:this}))["do"].apply(e,r)}})})}])});
//# sourceMappingURL=dist/delta.min.js.map