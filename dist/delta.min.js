!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("js-graph")):"function"==typeof define&&define.amd?define(["js-graph"],e):"object"==typeof exports?exports.DeltaJs=e(require("js-graph")):t.DeltaJs=e(t.JsGraph)}(this,function(t){return function(t){function e(i){if(r[i])return r[i].exports;var n=r[i]={exports:{},id:i,loaded:!1};return t[i].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){var i,n;i=[r(1),r(3),r(2)],n=function(t,e,r){"use strict";function i(t,e){r.assert("function"==typeof t,"The operation '"+e+"' expects the property it acts on to be a function.")}function n(t,e){r.assert(r.isDefined(t),"The operation '"+e+"' expects the property to be defined.")}function o(t,e){r.assert(r.isUndefined(t),"The operation '"+e+"' expects the property to be undefined.")}var s=r.newClass(function(){var t={},e=[];r.extend(this,{_addOperationType:function(i){var n=i,o=n.name,s=n.constructor,a=n.applyTo,c=n.prototype,u=n.method,l={};t[o]={name:o,Delta:s,method:l[o]},r.extend(t[o].Delta.prototype,c,{constructor:s,type:o,applyTo:a,compose:function(t,i){var n=this;if(r.isUndefined(i))return this;var o;if(e.some(function(t){var e=t,r=e.op1Type,s=e.op2Type,a=e.composeFn;return n.type===r&&i.type===s?(o=a,!0):void 0}),!o){var s=new Error("You cannot follow a '"+this.type+"' operation "+("with a '"+i.type+"' operation on the same property."));throw s.op1=this.type,s.op2=i.type,s}o(this,t,i)}}),t.modify.Delta.prototype[o]=r.isDefined(u)?u:function(e){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];return this._addOperation(t[o],e,r),this}},_addOperationAlias:function(e){var r=e,i=r.name,n=r.target,o=r.transform,s={};Object.defineProperty(s,i,{value:function(e){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];return this._addOperation(t[n],e,o(r)),this}}),t[i]={name:i,method:s[i]},t.modify.Delta.prototype[i]=t[i].method},_addCompositionRule:function(t,r,i){e.push({op1Type:t,op2Type:r,composeFn:i})},_newDelta:function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];return r.applyConstructor(t[e].Delta,i)}}),Object.defineProperty(this,"Delta",{get:function(){return t.modify.Delta}});var i=this;this._addOperationType({name:"modify",constructor:function(e,i){var n=this;e=e||{},this.operations=i||{},Object.keys(e).forEach(function(i){var o=i.match(/^(\w+)\s+([\w\.]+)$/);if(o){var s=o[1],a=o[2];r.assert(s in t,"I don't know the '"+s+"' operation."),n[s](a,e[i])}})},applyTo:function(t,e){var i=this;r.isDefined(e)?(r.assert(r.isDefined(t[e]),"The 'modify' operation expects the property to be already defined."),Object.keys(this.operations).forEach(function(r){i.operations[r].applyTo(t[e],r)})):(r.assert(r.isDefined(t),"The 'modify' operation expects the property to be already defined."),Object.keys(this.operations).forEach(function(e){i.operations[e].applyTo(t,e)}))},prototype:{selectivelyApplyTo:function(t,e){r.assert(r.isDefined(t),"The 'modify' operation expects the property to be already defined."),r.isDefined(this.operations[e])&&this.operations[e].applyTo(t,e)},_addOperation:function(e,n,o){var s=n.indexOf(".");if(-1!==s){var a=n.slice(0,s),c=n.slice(s+1),u=this._addOperation(t.modify,a);return u[e.name].apply(u,[c].concat(o))}var l=i._newDelta.apply(i,[e.name].concat(o));return this.operations.hasOwnProperty(n)&&r.isDefined(this.operations[n])?this.compose(n,l):this.operations[n]=l,this.operations[n]}},method:function(e,r){return this._addOperation(t.modify,e,[r])}})}),a=function(){},c=function(t,e,r){t[e]=r},u=function(t,e,r){r.applyTo(t[e],"value")},l=r.newSubclass(s,function(){var t=this;this._addOperationType({name:"add",constructor:function(t){this.value=t},applyTo:function(t,e){o(t[e],"add"),t[e]=this.value}}),this._addOperationType({name:"replace",constructor:function(t){this.value=t},applyTo:function(t,e){n(t[e],"replace"),t[e]=this.value}}),this._addOperationType({name:"remove",constructor:function(){},applyTo:function(t,e){n(t[e],"remove"),delete t[e]}}),this._addOperationType({name:"forbid",constructor:function(){},applyTo:function(t,e){o(t[e],"forbid")}}),this._addCompositionRule("add","replace",function(t,e,r){t[e]=s._newDelta("add",r.value)}),this._addCompositionRule("add","modify",u),this._addCompositionRule("add","remove",function(t,e){t[e]=s._newDelta("forbid")}),this._addCompositionRule("replace","replace",c),this._addCompositionRule("replace","modify",u),this._addCompositionRule("replace","remove",c),this._addCompositionRule("modify","replace",c),this._addCompositionRule("modify","modify",function(t,e,r){Object.keys(r.operations).forEach(function(e){t.compose(e,r.operations[e])})}),this._addCompositionRule("modify","remove",c),this._addCompositionRule("remove","add",function(t,e,r){t[e]=s._newDelta("replace",r.value)}),this._addCompositionRule("remove","forbid",a),this._addCompositionRule("forbid","add",c),this._addCompositionRule("forbid","forbid",a),this._addOperationType({name:"alter",constructor:function(t,e){this.value=t||[],this.alias=e||"alter"},applyTo:function(t,e){i(t[e],this.alias),this.value.forEach(function(r){var i=t[e],n=r.value;t[e]="prepend"===r.type?function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];n.apply(this,t),i.apply(this,t)}:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];i.apply(this,t),n.apply(this,t)}})}}),this._addCompositionRule("alter","alter",function(t,e,r){[].push.apply(t[e].value,r.value)}),this._addCompositionRule("alter","replace",c),this._addCompositionRule("alter","remove",function(t,e){t[e]=s._newDelta("forbid")}),this._addCompositionRule("add","alter",function(t,e,r){i(t[e].value,r.alias),u(t,e,r)}),this._addCompositionRule("replace","alter",function(t,e,r){i(t[e].value,r.alias),u(t,e,r)}),["prepend","insert","append"].forEach(function(e){t._addOperationAlias({name:e,target:"alter",transform:function(t){return[[{type:e,value:t[0]}],e]}})}),this._addOperationType({name:"after",constructor:function(t){this.value=t},applyTo:function(t,r){i(t[r],"after");var n=t[r],o=this.value;t[r]=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.resolve(n.apply(this,t)).then(function(){return o.apply(this,t)}.bind(this))}}}),this._addCompositionRule("after","replace",c),this._addCompositionRule("after","remove",c),this._addCompositionRule("add","after",function(t,e,r){i(t[e].value,"after"),u(t,e,r)}),this._addCompositionRule("replace","after",function(t,e,r){i(t[e].value,"after"),u(t,e,r)}),this._addCompositionRule("insert","after",u),this._addCompositionRule("after","insert",u)}),f=r.newSubclass(l,function(){function e(t,e){a=!0,e===!0?s[t]=!0:o[t]!==!0&&r.array(o,t).push(e)}function i(){if(a){a=!1;var t;do t=!1,n.eachVertex(function(e){s[e]||r.isUndefined(o[e])||o[e].some(function(t){return t.every(function(t){return s[t]})})&&(s[e]=!0,t=!0)});while(t)}}var n=new t;r.extend(this,{graph:function(){return n}});var o={},s={},a=!1;r.extend(this,{register:function(t){r.assert(t instanceof Object,"A delta should be given as an object."),r.assert("string"==typeof t.id,"A delta should have a unique 'id'."),t.resolves&&t.resolves.length>0&&(t.manuallySelectable=!1),[["manuallySelectable",!0],["onlyIf",[]],["after",[]],["selects",[]],["expects",[]],["requires",[]]].forEach(function(e,i){r.isUndefined(t[e])&&(t[e]=i)});var o=new this.Delta(t);return Object.defineProperties(o,{id:{get:function(){return t.id}},manuallySelectable:{get:function(){return!!t.manuallySelectable}},selected:{get:function(){return i(),!!s[o.id]}},"if":{get:function(){return t["if"]===!0?!0:t["if"]||t.iff||t.resolves?[].concat(t["if"]||[],t.iff||[],t.resolves||[]):void 0}},onlyIf:{get:function(){return[].concat(t.onlyIf||[],t.iff||[],t.expects||[],t.resolves||[])}},after:{get:function(){return[].concat(t.after||[],t.expects||[],t.resolves||[],t.requires||[])}},selects:{get:function(){return[].concat(t.selects||[],t.requires||[])}}}),a=!0,r.isDefined(o.if)&&e(o.id,o.if),o.selects.forEach(function(t){e(t,[o.id])}),n.addVertex(o.id,o),o.after.forEach(function(t){n.createEdge(t,o.id)}),r.assert(!n.hasCycle(),"The delta "+o.id+" introduced a cycle in the application order."),o},select:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];t.forEach(function(t){e(t,!0)})},vp:function(t,e){var o={};return o[t]=e,i(),n.eachVertex(function(t,e){r.assert(!e.selected||e.onlyIf.every(function(t){return n.vertexValue(t).selected}),"The 'onlyIf' condition of delta '"+e.id+"' was violated.")}),n.topologically(function(e,r){r.selected&&r.selectivelyApplyTo(o,t)}),o[t]}})});return f}.apply(e,i),!(void 0!==n&&(t.exports=n))},function(e){e.exports=t},function(t,e,r){var i;i=function(){"use strict";var t={newClass:function(t,e){e=e||{};var r=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];t.apply(this,e)};return r.prototype=e,r.prototype.constructor=r,r},newSubclass:function(t,e,r){r=r||{};var i=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];t.prototype.constructor.apply(this,r),e.apply(this,r)};return i.prototype=Object.create(t.prototype,r),i.prototype.constructor=i,i},extend:function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return e.forEach(function(e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])}),t},array:function(e,r){return t.isUndefined(e[r])&&(e[r]=[]),e[r]},bindA:function(t,e,r){return t.bind.apply(t,[e].concat(r))},bind:function(e,r){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];return t.bindA(e[r],e,i)},applyConstructor:function(t,e){var r=t.bind.apply(t,[null].concat(e));return new r},assert:function(t,e){if(!t)throw new Error(e||"Assertion failed")},isUndefined:function(t){return"undefined"==typeof t},isDefined:function(t){return"undefined"!=typeof t}};return t}.call(e,r,e,t),!(void 0!==i&&(t.exports=i))},function(t,e,r){"use strict";var i=r(4)();t.exports=i},function(t,e,r){(function(e){"use strict";function i(t){try{Promise===t&&(Promise=n)}catch(e){}return t}var n;"undefined"!=typeof Promise&&(n=Promise),t.exports=function(){function t(e){if("function"!=typeof e)throw new F("the promise constructor requires a resolver function");if(this.constructor!==t)throw new F("the promise constructor cannot be invoked directly");this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._settledValue=void 0,this._boundTo=void 0,e!==u&&this._resolveFromResolver(e)}function n(t){return t[0]}function o(){return new t.PromiseInspection(this)}var s=r(5),a=r(6),c=r(7),u=function(){},l={},f={e:null},h=r(8)(t,u),p=r(9)(t,u,h),d=r(10)(),_=r(11)(f),v=r(12),y=s.isArray,m=s.errorObj,g=s.tryCatch1,b=s.tryCatch2,w=s.tryCatchApply,j=c.RangeError,F=c.TypeError,k=c.CancellationError,T=c.TimeoutError,E=c.OperationalError,R=c.originatesFromRejection,x=c.markAsOriginatingFromRejection,P=c.canAttach,C=s.thrower,A=r(13)(t),O=function(){return new F("circular promise resolution chain")};t.prototype.bind=function(e){var r=h(e,void 0),i=new t(u);if(r instanceof t){var o=r.then(function(t){i._setBoundTo(t)}),s=t.all([this,o]).then(n);i._follow(s)}else i._follow(this),i._setBoundTo(e);return i._propagateFrom(this,3),i},t.prototype.toString=function(){return"[object Promise]"},t.prototype.caught=t.prototype["catch"]=function(e){var r=arguments.length;if(r>1){var i,n=new Array(r-1),o=0;for(i=0;r-1>i;++i){var s=arguments[i];if("function"!=typeof s){var a=new F("A catch filter must be an error constructor or a filter function");return this._attachExtraTrace(a),t.reject(a)}n[o++]=s}n.length=o,e=arguments[i],this._resetTrace();var c=new _(n,e,this);return this._then(void 0,c.doFilter,void 0,c,void 0)}return this._then(void 0,e,void 0,void 0,void 0)},t.prototype.reflect=function(){return this._then(o,o,void 0,this,void 0)},t.prototype.then=function(t,e,r){return this._then(t,e,r,void 0,void 0)},t.prototype.done=function(t,e,r){var i=this._then(t,e,r,void 0,void 0);i._setIsFinal()},t.prototype.spread=function(t,e){return this._then(t,e,void 0,l,void 0)},t.prototype.isCancellable=function(){return!this.isResolved()&&this._cancellable()},t.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this._settledValue,t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this._settledValue,t.isRejected=!0),t},t.prototype.all=function(){return new p(this).promise()},t.is=function(e){return e instanceof t},t.all=function(t){return new p(t).promise()},t.prototype.error=function(t){return this.caught(R,t)},t.prototype._resolveFromSyncValue=function(e){if(e===m)this._cleanValues(),this._setRejected(),this._settledValue=e.e,this._ensurePossibleRejectionHandled();else{var r=h(e,void 0);r instanceof t?this._follow(r):(this._cleanValues(),this._setFulfilled(),this._settledValue=e)}},t.method=function(e){if("function"!=typeof e)throw new F("fn must be a function");return function(){var r;switch(arguments.length){case 0:r=g(e,this,void 0);break;case 1:r=g(e,this,arguments[0]);break;case 2:r=b(e,this,arguments[0],arguments[1]);break;default:for(var i=arguments.length,n=new Array(i),o=0;i>o;++o)n[o]=arguments[o];r=w(e,n,this)}var s=new t(u);return s._setTrace(void 0),s._resolveFromSyncValue(r),s}},t.attempt=t["try"]=function(e,r,i){if("function"!=typeof e)return A("fn must be a function");var n=y(r)?w(e,r,i):g(e,i,r),o=new t(u);return o._setTrace(void 0),o._resolveFromSyncValue(n),o},t.defer=t.pending=function(){var e=new t(u);return e._setTrace(void 0),new v(e)},t.bind=function(e){var r=h(e,void 0),i=new t(u);if(i._setTrace(void 0),r instanceof t){var n=r.then(function(t){i._setBoundTo(t)});i._follow(n)}else i._setBoundTo(e),i._setFulfilled();return i},t.cast=function(e){var r=h(e,void 0);if(!(r instanceof t)){var i=r;r=new t(u),r._setTrace(void 0),r._setFulfilled(),r._cleanValues(),r._settledValue=i}return r},t.resolve=t.fulfilled=t.cast,t.reject=t.rejected=function(e){var r=new t(u);if(r._setTrace(void 0),x(e),r._cleanValues(),r._setRejected(),r._settledValue=e,!P(e)){var i=new Error(e+"");r._setCarriedStackTrace(i)}return r._ensurePossibleRejectionHandled(),r},t.onPossiblyUnhandledRejection=function(t){d.possiblyUnhandledRejection="function"==typeof t?t:void 0};var S;t.onUnhandledRejectionHandled=function(t){S="function"==typeof t?t:void 0};var U=!1||!("undefined"==typeof e||"string"!=typeof e.execPath||"object"!=typeof e.env||!e.env.BLUEBIRD_DEBUG&&"development"!==e.env.NODE_ENV);t.longStackTraces=function(){if(a.haveItemsQueued()&&U===!1)throw new Error("cannot enable long stack traces after promises have been created");U=d.isSupported()},t.hasLongStackTraces=function(){return U&&d.isSupported()},t.prototype._then=function(e,r,i,n,o){var s=void 0!==o,c=s?o:new t(u);if(!s){if(U){var l=this._peekContext()===this._traceParent;c._traceParent=l?this._traceParent:this}c._propagateFrom(this,7)}var f=this._addCallbacks(e,r,i,c,n);return this.isResolved()&&a.invoke(this._queueSettleAt,this,f),c},t.prototype._length=function(){return 262143&this._bitField},t.prototype._isFollowingOrFulfilledOrRejected=function(){return(939524096&this._bitField)>0},t.prototype._isFollowing=function(){return 536870912===(536870912&this._bitField)},t.prototype._setLength=function(t){this._bitField=-262144&this._bitField|262143&t},t.prototype._setFulfilled=function(){this._bitField=268435456|this._bitField},t.prototype._setRejected=function(){this._bitField=134217728|this._bitField},t.prototype._setFollowing=function(){this._bitField=536870912|this._bitField},t.prototype._setIsFinal=function(){this._bitField=33554432|this._bitField},t.prototype._isFinal=function(){return(33554432&this._bitField)>0},t.prototype._cancellable=function(){return(67108864&this._bitField)>0},t.prototype._setCancellable=function(){this._bitField=67108864|this._bitField},t.prototype._unsetCancellable=function(){this._bitField=-67108865&this._bitField},t.prototype._setRejectionIsUnhandled=function(){this._bitField=2097152|this._bitField},t.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-2097153&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},t.prototype._isRejectionUnhandled=function(){return(2097152&this._bitField)>0},t.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=524288|this._bitField},t.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-524289&this._bitField},t.prototype._isUnhandledRejectionNotified=function(){return(524288&this._bitField)>0},t.prototype._setCarriedStackTrace=function(t){this._bitField=1048576|this._bitField,this._fulfillmentHandler0=t},t.prototype._unsetCarriedStackTrace=function(){this._bitField=-1048577&this._bitField,this._fulfillmentHandler0=void 0},t.prototype._isCarryingStackTrace=function(){return(1048576&this._bitField)>0},t.prototype._getCarriedStackTrace=function(){return this._isCarryingStackTrace()?this._fulfillmentHandler0:void 0},t.prototype._receiverAt=function(t){var e=0===t?this._receiver0:this[(t<<2)+t-5+4];return this._isBound()&&void 0===e?this._boundTo:e},t.prototype._promiseAt=function(t){return 0===t?this._promise0:this[(t<<2)+t-5+3]},t.prototype._fulfillmentHandlerAt=function(t){return 0===t?this._fulfillmentHandler0:this[(t<<2)+t-5+0]},t.prototype._rejectionHandlerAt=function(t){return 0===t?this._rejectionHandler0:this[(t<<2)+t-5+1]},t.prototype._addCallbacks=function(t,e,r,i,n){var o=this._length();if(o>=262138&&(o=0,this._setLength(0)),0===o)this._promise0=i,void 0!==n&&(this._receiver0=n),"function"!=typeof t||this._isCarryingStackTrace()||(this._fulfillmentHandler0=t),"function"==typeof e&&(this._rejectionHandler0=e),"function"==typeof r&&(this._progressHandler0=r);else{var s=(o<<2)+o-5;this[s+3]=i,this[s+4]=n,this[s+0]="function"==typeof t?t:void 0,this[s+1]="function"==typeof e?e:void 0,this[s+2]="function"==typeof r?r:void 0}return this._setLength(o+1),o},t.prototype._setProxyHandlers=function(t,e){var r=this._length();if(r>=262138&&(r=0,this._setLength(0)),0===r)this._promise0=e,this._receiver0=t;else{var i=(r<<2)+r-5;this[i+3]=e,this[i+4]=t,this[i+0]=this[i+1]=this[i+2]=void 0}this._setLength(r+1)},t.prototype._proxyPromiseArray=function(t,e){this._setProxyHandlers(t,e)},t.prototype._proxyPromise=function(t){t._setProxied(),this._setProxyHandlers(t,-15)},t.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=8388608|this._bitField,this._boundTo=t):this._bitField=-8388609&this._bitField},t.prototype._isBound=function(){return 8388608===(8388608&this._bitField)},t.prototype._resolveFromResolver=function(t){function e(t){i._tryFollow(t)||i._fulfill(t)}function r(t){var e=P(t)?t:new Error(t+"");i._attachExtraTrace(e),x(t),i._reject(t,e===t?void 0:e)}var i=this;this._setTrace(void 0),this._pushContext();var n=b(t,void 0,e,r);if(this._popContext(),void 0!==n&&n===m){var o=n.e,s=P(o)?o:new Error(o+"");i._reject(o,s)}},t.prototype._spreadSlowCase=function(t,e,r,i){var n=new p(r).promise(),o=n._then(function(){return t.apply(i,arguments)},void 0,void 0,l,void 0);e._follow(o)},t.prototype._callSpread=function(e,r,i){var n=this._boundTo;if(y(i))for(var o=0,s=i.length;s>o;++o)if(h(i[o],void 0)instanceof t)return void this._spreadSlowCase(e,r,i,n);return r._pushContext(),w(e,i,n)},t.prototype._callHandler=function(t,e,r,i){var n;return e!==l||this.isRejected()?(r._pushContext(),n=g(t,e,i)):n=this._callSpread(t,r,i),r._popContext(),n},t.prototype._settlePromiseFromHandler=function(e,r,i,n){if(!(n instanceof t))return void e.call(r,i,n);var o=this._callHandler(e,r,n,i);if(!n._isFollowing())if(o===m||o===n||o===f){var s=o===n?O():o.e,a=P(s)?s:new Error(s+"");o!==f&&n._attachExtraTrace(a),n._rejectUnchecked(s,a)}else{var c=h(o,n);if(c instanceof t){if(c.isRejected()&&!c._isCarryingStackTrace()&&!P(c._settledValue)){var a=new Error(c._settledValue+"");n._attachExtraTrace(a),c._setCarriedStackTrace(a)}n._follow(c),n._propagateFrom(c,1)}else n._fulfillUnchecked(o)}},t.prototype._follow=function(t){this._setFollowing(),t.isPending()?(this._propagateFrom(t,1),t._proxyPromise(this)):t.isFulfilled()?this._fulfillUnchecked(t._settledValue):this._rejectUnchecked(t._settledValue,t._getCarriedStackTrace()),t._isRejectionUnhandled()&&t._unsetRejectionIsUnhandled(),U&&null==t._traceParent&&(t._traceParent=this)},t.prototype._tryFollow=function(e){if(this._isFollowingOrFulfilledOrRejected()||e===this)return!1;var r=h(e,void 0);return r instanceof t?(this._follow(r),!0):!1},t.prototype._resetTrace=function(){U&&(this._trace=new d(void 0===this._peekContext()))},t.prototype._setTrace=function(t){if(U){var e=this._peekContext();this._traceParent=e;var r=void 0===e;this._trace=void 0!==t&&t._traceParent===e?t._trace:new d(r)}return this},t.prototype._attachExtraTrace=function(t){if(U){var e=this,r=t.stack;r="string"==typeof r?r.split("\n"):[],d.protectErrorMessageNewlines(r);for(var i=1,n=1;null!=e&&null!=e._trace;)r=d.combine(r,e._trace.stack.split("\n")),e=e._traceParent,n++;var o=Error.stackTraceLimit||10,s=(o+i)*n,a=r.length;a>s&&(r.length=s),a>0&&(r[0]=r[0].split("\x00").join("\n")),t.stack=r.length<=i?"(No stack trace)":r.join("\n")}},t.prototype._cleanValues=function(){this._cancellable()&&(this._cancellationParent=void 0)},t.prototype._propagateFrom=function(t,e){(1&e)>0&&t._cancellable()&&(this._setCancellable(),this._cancellationParent=t),(4&e)>0&&this._setBoundTo(t._boundTo),(2&e)>0&&this._setTrace(t)},t.prototype._fulfill=function(t){this._isFollowingOrFulfilledOrRejected()||this._fulfillUnchecked(t)},t.prototype._reject=function(t,e){this._isFollowingOrFulfilledOrRejected()||this._rejectUnchecked(t,e)},t.prototype._settlePromiseAt=function(e){var r=this.isFulfilled()?this._fulfillmentHandlerAt(e):this._rejectionHandlerAt(e),i=this._settledValue,n=this._receiverAt(e),o=this._promiseAt(e);if("function"==typeof r)this._settlePromiseFromHandler(r,n,i,o);else{var s=!1,a=this.isFulfilled();void 0!==n&&(n instanceof t&&n._isProxied()?(n._unsetProxied(),a?n._fulfillUnchecked(i):n._rejectUnchecked(i,this._getCarriedStackTrace()),s=!0):n instanceof p&&(a?n._promiseFulfilled(i,o):n._promiseRejected(i,o),s=!0)),s||(a?o._fulfill(i):o._reject(i,this._getCarriedStackTrace()))}e>=4&&this._queueGC()},t.prototype._isProxied=function(){return 4194304===(4194304&this._bitField)},t.prototype._setProxied=function(){this._bitField=4194304|this._bitField},t.prototype._unsetProxied=function(){this._bitField=-4194305&this._bitField},t.prototype._isGcQueued=function(){return-1073741824===(-1073741824&this._bitField)},t.prototype._setGcQueued=function(){this._bitField=-1073741824|this._bitField},t.prototype._unsetGcQueued=function(){this._bitField=1073741823&this._bitField},t.prototype._queueGC=function(){this._isGcQueued()||(this._setGcQueued(),a.invokeLater(this._gc,this,void 0))},t.prototype._gc=function(){for(var t=5*this._length()-5,e=0;t>e;e++)delete this[e];this._clearFirstHandlerData(),this._setLength(0),this._unsetGcQueued()},t.prototype._clearFirstHandlerData=function(){this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0},t.prototype._queueSettleAt=function(t){this._isRejectionUnhandled()&&this._unsetRejectionIsUnhandled(),a.invoke(this._settlePromiseAt,this,t)},t.prototype._fulfillUnchecked=function(t){if(this.isPending()){if(t===this){var e=O();return this._attachExtraTrace(e),this._rejectUnchecked(e,void 0)}this._cleanValues(),this._setFulfilled(),this._settledValue=t;var r=this._length();r>0&&a.invoke(this._settlePromises,this,r)}},t.prototype._rejectUncheckedCheckError=function(t){var e=P(t)?t:new Error(t+"");this._rejectUnchecked(t,e===t?void 0:e)},t.prototype._rejectUnchecked=function(t,e){if(this.isPending()){if(t===this){var r=O();return this._attachExtraTrace(r),this._rejectUnchecked(r)}if(this._cleanValues(),this._setRejected(),this._settledValue=t,this._isFinal())return void a.invokeLater(C,void 0,void 0===e?t:e);var i=this._length();void 0!==e&&this._setCarriedStackTrace(e),i>0?a.invoke(this._rejectPromises,this,null):this._ensurePossibleRejectionHandled()}},t.prototype._rejectPromises=function(){this._settlePromises(),this._unsetCarriedStackTrace()},t.prototype._settlePromises=function(){for(var t=this._length(),e=0;t>e;e++)this._settlePromiseAt(e)},t.prototype._ensurePossibleRejectionHandled=function(){this._setRejectionIsUnhandled(),void 0!==d.possiblyUnhandledRejection&&a.invokeLater(this._notifyUnhandledRejection,this,void 0)},t.prototype._notifyUnhandledRejectionIsHandled=function(){"function"==typeof S&&a.invokeLater(S,void 0,this)},t.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._settledValue,e=this._getCarriedStackTrace();this._setUnhandledRejectionIsNotified(),void 0!==e&&(this._unsetCarriedStackTrace(),t=e),"function"==typeof d.possiblyUnhandledRejection&&d.possiblyUnhandledRejection(t,this)}};var D=[];return t.prototype._peekContext=function(){var t=D.length-1;return t>=0?D[t]:void 0},t.prototype._pushContext=function(){U&&D.push(this)},t.prototype._popContext=function(){U&&D.pop()},t.noConflict=function(){return i(t)},t.setScheduler=function(t){if("function"!=typeof t)throw new F("fn must be a function");a._schedule=t},d.isSupported()||(t.longStackTraces=function(){},U=!1),t._makeSelfResolutionError=O,r(14)(t,f,h),r(15)(t),r(16)(t),r(17)(t,p,h,u),t.RangeError=j,t.CancellationError=k,t.TimeoutError=T,t.TypeError=F,t.OperationalError=E,t.RejectionError=E,t.AggregateError=c.AggregateError,s.toFastProperties(t),s.toFastProperties(t.prototype),t.Promise=t,r(18)(t,u,h),r(19)(t,u,h),r(20)(t),r(21)(t,A,u,h),r(22)(t,p,A,h,u),r(23)(t),r(24)(t,u),r(25)(t,p,h),r(26)(t,p,A,h,u),r(27)(t,p),r(28)(t,p,A),r(29)(t,p),r(30)(t,u),r(31)(t,u),r(32)(t,p),r(33)(t,u),r(34)(t,A,h),t.prototype=t.prototype,t}}).call(e,r(35))},function(t,e,r){"use strict";function i(t,e,r){try{return t.call(e,r)}catch(i){return F.e=i,F}}function n(t,e,r,i){try{return t.call(e,r,i)}catch(n){return F.e=n,F}}function o(t,e,r,i,n){try{return t.call(e,r,i,n)}catch(o){return F.e=o,F}}function s(t,e,r,i,n,o){try{return t.call(e,r,i,n,o)}catch(s){return F.e=s,F}}function a(t,e,r){try{return t.apply(r,e)}catch(i){return F.e=i,F}}function c(t){return"string"==typeof t?t:""+t}function u(t){return null==t||t===!0||t===!1||"string"==typeof t||"number"==typeof t}function l(t){return!u(t)}function f(t){return u(t)?new Error(c(t)):t}function h(t,e){var r,i=t.length,n=new Array(i+1);for(r=0;i>r;++r)n[r]=t[r];return n[r]=e,n}function p(t,e,r){if(!b.isES5)return{}.hasOwnProperty.call(t,e)?t[e]:void 0;var i=Object.getOwnPropertyDescriptor(t,e);return null!=i?null==i.get&&null==i.set?i.value:r:void 0}function d(t,e,r){if(u(t))return t;var i={value:r,configurable:!0,enumerable:!1,writable:!0};return b.defineProperty(t,e,i),t}function _(t){throw t}function v(t){try{if("function"==typeof t){var e=b.keys(t.prototype);return e.length>0&&!(1===e.length&&"constructor"===e[0])}return!1}catch(r){return!1}}function y(t){function e(){}return e.prototype=t,e}function m(t){return R.test(t)}function g(t,e,r){for(var i=new Array(t),n=0;t>n;++n)i[n]=e+n+r;return i}var b=r(36),w=function(){try{var t={};return b.defineProperty(t,"f",{get:function(){return 3}}),3===t.f}catch(e){return!1}}(),j="undefined"==typeof navigator,F={e:{}},k=function(t,e){function r(){this.constructor=t,this.constructor$=e;for(var r in e.prototype)i.call(e.prototype,r)&&"$"!==r.charAt(r.length-1)&&(this[r+"$"]=e.prototype[r])}var i={}.hasOwnProperty;return r.prototype=e.prototype,t.prototype=new r,t.prototype},T=function(){return"string"!==this}.call("string"),E=function(){return b.isES5?function(t,e){for(var r=[],i=Object.create(null),n=Object(e).includeHidden?Object.getOwnPropertyNames:Object.keys;null!=t;){var o;try{o=n(t)}catch(s){return r}for(var a=0;a<o.length;++a){var c=o[a];if(!i[c]){i[c]=!0;var u=Object.getOwnPropertyDescriptor(t,c);null!=u&&null==u.get&&null==u.set&&r.push(c)}}t=b.getPrototypeOf(t)}return r}:function(t){var e=[];for(var r in t)e.push(r);return e}}(),R=/^[a-z$_][a-z$_0-9]*$/i,x={isClass:v,isIdentifier:m,inheritedDataKeys:E,getDataPropertyOrDefault:p,thrower:_,isArray:b.isArray,haveGetters:w,notEnumerableProp:d,isPrimitive:u,isObject:l,canEvaluate:j,errorObj:F,tryCatch1:i,tryCatch2:n,tryCatch3:o,tryCatch4:s,tryCatchApply:a,inherits:k,withAppended:h,asString:c,maybeWrapAsError:f,wrapsPrimitiveReceiver:T,toFastProperties:y,filledRange:g};t.exports=x},function(t,e,r){(function(e){"use strict";function i(){this._isTickUsed=!1,this._schedule=n,this._length=0,this._lateBuffer=new o(16),this._functionBuffer=new o(65536);var t=this;this.consumeFunctionBuffer=function(){t._consumeFunctionBuffer()}}var n=r(37),o=r(38),s=r(5).errorObj,a=r(5).tryCatch1,c="undefined"!=typeof e?e:void 0;i.prototype.haveItemsQueued=function(){return this._length>0},i.prototype.invokeLater=function(t,e,r){void 0===c||null==c.domain||t.domain||(t=c.domain.bind(t)),this._lateBuffer.push(t,e,r),this._queueTick()},i.prototype.invoke=function(t,e,r){void 0===c||null==c.domain||t.domain||(t=c.domain.bind(t));var i=this._functionBuffer;i.push(t,e,r),this._length=i.length(),this._queueTick()},i.prototype._consumeFunctionBuffer=function(){for(var t=this._functionBuffer;t.length()>0;){var e=t.shift(),r=t.shift(),i=t.shift();e.call(r,i)}this._reset(),this._consumeLateBuffer()},i.prototype._consumeLateBuffer=function(){for(var t=this._lateBuffer;t.length()>0;){var e=t.shift(),r=t.shift(),i=t.shift(),n=a(e,r,i);if(n===s){if(this._queueTick(),null==e.domain)throw n.e;e.domain.emit("error",n.e)}}},i.prototype._queueTick=function(){this._isTickUsed||(this._schedule(this.consumeFunctionBuffer),this._isTickUsed=!0)},i.prototype._reset=function(){this._isTickUsed=!1,this._length=0},t.exports=new i}).call(e,r(35))},function(t,e,r){"use strict";function i(t){try{d(t,"isOperational",!0)}catch(e){}}function n(t){return null==t?!1:t instanceof c||t.isOperational===!0}function o(t){return t instanceof Error}function s(t){return o(t)}function a(t,e){function r(i){return this instanceof r?(this.message="string"==typeof i?i:e,this.name=t,void(Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor))):new r(i)}return p(r,Error),r}function c(t){this.name="OperationalError",this.message=t,this.cause=t,this.isOperational=!0,t instanceof Error?(this.message=t.message,this.stack=t.stack):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}var u,l,f=r(36).freeze,h=r(5),p=h.inherits,d=h.notEnumerableProp,_=a("CancellationError","cancellation error"),v=a("TimeoutError","timeout error"),y=a("AggregateError","aggregate error");try{u=TypeError,l=RangeError}catch(m){u=a("TypeError","type error"),l=a("RangeError","range error")}for(var g="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),b=0;b<g.length;++b)"function"==typeof Array.prototype[g[b]]&&(y.prototype[g[b]]=Array.prototype[g[b]]);y.prototype.length=0,y.prototype.isOperational=!0;var w=0;y.prototype.toString=function(){var t=Array(4*w+1).join(" "),e="\n"+t+"AggregateError of:\n";w++,t=Array(4*w+1).join(" ");for(var r=0;r<this.length;++r){for(var i=this[r]===this?"[Circular AggregateError]":this[r]+"",n=i.split("\n"),o=0;o<n.length;++o)n[o]=t+n[o];i=n.join("\n"),e+=i+"\n"}return w--,e},p(c,Error);var j="__BluebirdErrorTypes__",F=Error[j];F||(F=f({CancellationError:_,TimeoutError:v,OperationalError:c,RejectionError:c,AggregateError:y}),d(Error,j,F)),t.exports={Error:Error,TypeError:u,RangeError:l,CancellationError:F.CancellationError,OperationalError:F.OperationalError,TimeoutError:F.TimeoutError,AggregateError:F.AggregateError,originatesFromRejection:n,markAsOriginatingFromRejection:i,canAttach:s}},function(t,e,r){"use strict";t.exports=function(t,e){function i(t){try{return t.then}catch(e){return u.e=e,u}}function n(r,n){if(l(r)){if(r instanceof t)return r;
if(o(r)){var a=new t(e);return a._setTrace(void 0),r._then(a._fulfillUnchecked,a._rejectUncheckedCheckError,a._progressUnchecked,a,null),a._setFollowing(),a}var f=i(r);if(f===u)return void 0!==n&&c(f.e)&&n._attachExtraTrace(f.e),t.reject(f.e);if("function"==typeof f)return s(r,f,n)}return r}function o(t){return f.call(t,"_promise0")}function s(e,r,i){function n(r){if(!u){if(u=!0,e===r){var n=t._makeSelfResolutionError();return void 0!==i&&i._attachExtraTrace(n),void a.promise._reject(n,void 0)}a.resolve(r)}}function o(t){if(!u){u=!0;var e=c(t)?t:new Error(t+"");void 0!==i&&i._attachExtraTrace(e),a.promise._reject(t,e)}}function s(t){if(!u){var e=a.promise;"function"==typeof e._progress&&e._progress(t)}}var a=t.defer(),u=!1;try{r.call(e,n,o,s)}catch(l){if(!u){u=!0;var f=c(l)?l:new Error(l+"");void 0!==i&&i._attachExtraTrace(f),a.promise._reject(l,f)}}return a.promise}var a=r(5),c=r(7).canAttach,u=a.errorObj,l=a.isObject,f={}.hasOwnProperty;return n}},function(t,e,r){"use strict";t.exports=function(t,e,i){function n(t){switch(t){case-1:return void 0;case-2:return[];case-3:return{}}}function o(r){var i=this._promise=new t(e),n=void 0;r instanceof t&&(n=r,i._propagateFrom(n,5)),i._setTrace(n),this._values=r,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var s=r(7).canAttach,a=r(5),c=a.isArray;return o.prototype.length=function(){return this._length},o.prototype.promise=function(){return this._promise},o.prototype._init=function u(e,r){var o=i(this._values,void 0);if(o instanceof t){if(this._values=o,o._setBoundTo(this._promise._boundTo),!o.isFulfilled())return o.isPending()?void o._then(u,this._reject,void 0,this,r):(o._unsetRejectionIsUnhandled(),void this._reject(o._settledValue));if(o=o._settledValue,!c(o)){var s=new t.TypeError("expecting an array, a promise or a thenable");return void this.__hardReject__(s)}}else if(!c(o)){var s=new t.TypeError("expecting an array, a promise or a thenable");return void this.__hardReject__(s)}if(0===o.length)return void(-5===r?this._resolveEmptyArray():this._resolve(n(r)));for(var a=this.getActualLength(o.length),l=a,f=this.shouldCopyValues()?new Array(a):this._values,h=!1,p=0;a>p;++p){var d=i(o[p],void 0);d instanceof t?d.isPending()?d._proxyPromiseArray(this,p):(d._unsetRejectionIsUnhandled(),h=!0):h=!0,f[p]=d}this._values=f,this._length=l,h&&this._scanDirectValues(a)},o.prototype._settlePromiseAt=function(e){var r=this._values[e];r instanceof t?r.isFulfilled()?this._promiseFulfilled(r._settledValue,e):r.isRejected()&&this._promiseRejected(r._settledValue,e):this._promiseFulfilled(r,e)},o.prototype._scanDirectValues=function(t){for(var e=0;t>e&&!this._isResolved();++e)this._settlePromiseAt(e)},o.prototype._isResolved=function(){return null===this._values},o.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},o.prototype.__hardReject__=o.prototype._reject=function(t){this._values=null;var e=s(t)?t:new Error(t+"");this._promise._attachExtraTrace(e),this._promise._reject(t,e)},o.prototype._promiseProgressed=function(t,e){this._isResolved()||this._promise._progress({index:e,value:t})},o.prototype._promiseFulfilled=function(t,e){if(!this._isResolved()){this._values[e]=t;var r=++this._totalResolved;r>=this._length&&this._resolve(this._values)}},o.prototype._promiseRejected=function(t){this._isResolved()||(this._totalResolved++,this._reject(t))},o.prototype.shouldCopyValues=function(){return!0},o.prototype.getActualLength=function(t){return t},o}},function(t,e,r){"use strict";t.exports=function(){function t(t){var r;if("function"==typeof t)r="[function "+(t.name||"anonymous")+"]";else{r=t.toString();var i=/\[object [a-zA-Z0-9$_]+\]/;if(i.test(r))try{var n=JSON.stringify(t);r=n}catch(o){}0===r.length&&(r="(empty array)")}return"(<"+e(r)+">, no stack trace)"}function e(t){var e=41;return t.length<e?t:t.substr(0,e-3)+"..."}function i(t,e){this.captureStackTrace(i,e)}var n=r(5).inherits,o=r(36).defineProperty,s=new RegExp("\\b(?:[a-zA-Z0-9.]+\\$_\\w+|tryCatch(?:1|2|3|4|Apply)|new \\w*PromiseArray|\\w*PromiseArray\\.\\w*PromiseArray|setTimeout|CatchFilter\\$_\\w+|makeNodePromisified|processImmediate|process._tickCallback|nextTick|Async\\$\\w+)\\b"),a=null,c=null;n(i,Error),i.prototype.captureStackTrace=function(t,e){u(this,t,e)},i.possiblyUnhandledRejection=function(t){if("object"==typeof console){var e;if("object"==typeof t||"function"==typeof t){var r=t.stack;e="Possibly unhandled "+c(r,t)}else e="Possibly unhandled "+String(t);"function"==typeof console.error||"object"==typeof console.error?console.error(e):("function"==typeof console.log||"object"==typeof console.log)&&console.log(e)}},i.combine=function(t,e){for(var r=t.length-1,i=e.length-1;i>=0;--i){var n=e[i];if(t[r]!==n)break;t.pop(),r--}t.push("From previous event:");for(var o=t.concat(e),c=[],i=0,u=o.length;u>i;++i)s.test(o[i])&&a.test(o[i])||i>0&&!a.test(o[i])&&"From previous event:"!==o[i]||c.push(o[i]);return c},i.protectErrorMessageNewlines=function(t){for(var e=0;e<t.length&&!a.test(t[e]);++e);if(!(1>=e)){for(var r=[],i=0;e>i;++i)r.push(t.shift());t.unshift(r.join("\x00"))}},i.isSupported=function(){return"function"==typeof u};var u=function l(){if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){a=/^\s*at\s*/,c=function(e,r){return"string"==typeof e?e:void 0!==r.name&&void 0!==r.message?r.name+". "+r.message:t(r)};var e=Error.captureStackTrace;return function(t,r){e(t,r)}}var r=new Error;if("string"==typeof r.stack&&"function"==typeof"".startsWith&&r.stack.startsWith("stackDetection@")&&"stackDetection"===l.name){o(Error,"stackTraceLimit",{writable:!0,enumerable:!1,configurable:!1,value:25}),a=/@/;var i=/[@\n]/;return c=function(e,r){return"string"==typeof e?r.name+". "+r.message+"\n"+e:void 0!==r.name&&void 0!==r.message?r.name+". "+r.message:t(r)},function(t){for(var e=(new Error).stack,r=e.split(i),n=r.length,o="",s=0;n>s;s+=2)o+=r[s],o+="@",o+=r[s+1],o+="\n";t.stack=o}}return c=function(e,r){return"string"==typeof e?e:"object"!=typeof r&&"function"!=typeof r||void 0===r.name||void 0===r.message?t(r):r.name+". "+r.message},null}();return i}},function(t,e,r){"use strict";t.exports=function(t){function e(t,e,r){this._instances=t,this._callback=e,this._promise=r}function i(t,e){var r={},i=s(t,r,e);if(i===a)return i;var n=c(r);return n.length?(a.e=new u("Catch filter must inherit from Error or be a simple predicate function"),a):i}var n=r(5),o=r(7),s=n.tryCatch1,a=n.errorObj,c=r(36).keys,u=o.TypeError;return e.prototype.doFilter=function(e){for(var r=this._callback,n=this._promise,c=n._boundTo,u=0,l=this._instances.length;l>u;++u){var f=this._instances[u],h=f===Error||null!=f&&f.prototype instanceof Error;if(h&&e instanceof f){var p=s(r,c,e);return p===a?(t.e=p.e,t):p}if("function"==typeof f&&!h){var d=i(f,e);if(d===a){var _=o.canAttach(a.e)?a.e:new Error(a.e+"");this._promise._attachExtraTrace(_),e=a.e;break}if(d){var p=s(r,c,e);return p===a?(t.e=p.e,t):p}}}return t.e=e,t},e}},function(t,e,r){"use strict";function i(t){return t instanceof Error&&d.getPrototypeOf(t)===Error.prototype}function n(t){var e;return e=i(t)?new f(t):t,u.markAsOriginatingFromRejection(e),e}function o(t){function e(e,r){if(null!==t){if(e){var i=n(c(e));t._attachExtraTrace(i),t._reject(i)}else if(arguments.length>2){for(var o=arguments.length,s=new Array(o-1),a=1;o>a;++a)s[a-1]=arguments[a];t._fulfill(s)}else t._fulfill(r);t=null}}return e}var s,a=r(5),c=a.maybeWrapAsError,u=r(7),l=u.TimeoutError,f=u.OperationalError,h=r(6),p=a.haveGetters,d=r(36);if(s=p?function(t){this.promise=t}:function(t){this.promise=t,this.asCallback=o(t),this.callback=this.asCallback},p){var _={get:function(){return o(this.promise)}};d.defineProperty(s.prototype,"asCallback",_),d.defineProperty(s.prototype,"callback",_)}s._nodebackForPromise=o,s.prototype.toString=function(){return"[object PromiseResolver]"},s.prototype.resolve=s.prototype.fulfill=function(t){if(!(this instanceof s))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");var e=this.promise;e._tryFollow(t)||h.invoke(e._fulfill,e,t)},s.prototype.reject=function(t){if(!(this instanceof s))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");var e=this.promise;u.markAsOriginatingFromRejection(t);var r=u.canAttach(t)?t:new Error(t+"");e._attachExtraTrace(r),h.invoke(e._reject,e,t),r!==t&&h.invoke(this._setCarriedStackTrace,this,r)},s.prototype.progress=function(t){if(!(this instanceof s))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");h.invoke(this.promise._progress,this.promise,t)},s.prototype.cancel=function(){h.invoke(this.promise.cancel,this.promise,void 0)},s.prototype.timeout=function(){this.reject(new l("timeout"))},s.prototype.isResolved=function(){return this.promise.isResolved()},s.prototype.toJSON=function(){return this.promise.toJSON()},s.prototype._setCarriedStackTrace=function(t){this.promise.isRejected()&&this.promise._setCarriedStackTrace(t)},t.exports=s},function(t,e,r){"use strict";t.exports=function(t){function e(e){var r=new i(e),n=t.rejected(r),o=n._peekContext();return null!=o&&o._attachExtraTrace(r),n}var i=r(7).TypeError;return e}},function(t,e,r){"use strict";t.exports=function(t,e,i){function n(){return this}function o(){throw this}function s(t){return function(){return t}}function a(t){return function(){throw t}}function c(t,e,r){var i;return i=h&&p(e)?r?s(e):a(e):r?n:o,t._then(i,d,void 0,e,void 0)}function u(r){var n=this.promise,o=this.handler,s=n._isBound()?o.call(n._boundTo):o();if(void 0!==s){var a=i(s,void 0);if(a instanceof t)return c(a,r,n.isFulfilled())}return n.isRejected()?(e.e=r,e):r}function l(e){var r=this.promise,n=this.handler,o=r._isBound()?n.call(r._boundTo,e):n(e);if(void 0!==o){var s=i(o,void 0);if(s instanceof t)return c(s,e,!0)}return e}var f=r(5),h=f.wrapsPrimitiveReceiver,p=f.isPrimitive,d=f.thrower;t.prototype._passThroughHandler=function(t,e){if("function"!=typeof t)return this.then();var r={promise:this,handler:t};return this._then(e?u:l,e?u:void 0,void 0,r,void 0)},t.prototype.lastly=t.prototype["finally"]=function(t){return this._passThroughHandler(t,!0)},t.prototype.tap=function(t){return this._passThroughHandler(t,!1)}}},function(t,e,r){"use strict";var i=r(5),n=i.isPrimitive,o=i.wrapsPrimitiveReceiver;t.exports=function(t){var e=function(){return this},r=function(){throw this},i=function(t,e){return 1===e?function(){throw t}:2===e?function(){return t}:void 0};t.prototype["return"]=t.prototype.thenReturn=function(t){return o&&n(t)?this._then(i(t,2),void 0,void 0,void 0,void 0):this._then(e,void 0,void 0,t,void 0)},t.prototype["throw"]=t.prototype.thenThrow=function(t){return o&&n(t)?this._then(i(t,1),void 0,void 0,void 0,void 0):this._then(r,void 0,void 0,t,void 0)}}},function(t){"use strict";t.exports=function(t){function e(t){void 0!==t?(this._bitField=t._bitField,this._settledValue=t.isResolved()?t._settledValue:void 0):(this._bitField=0,this._settledValue=void 0)}e.prototype.isFulfilled=t.prototype.isFulfilled=function(){return(268435456&this._bitField)>0},e.prototype.isRejected=t.prototype.isRejected=function(){return(134217728&this._bitField)>0},e.prototype.isPending=t.prototype.isPending=function(){return 0===(402653184&this._bitField)},e.prototype.value=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise");return this._settledValue},e.prototype.error=e.prototype.reason=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise");return this._settledValue},e.prototype.isResolved=t.prototype.isResolved=function(){return(402653184&this._bitField)>0},t.PromiseInspection=e}},function(t,e,r){"use strict";t.exports=function(t,e,i,n){var o=r(5),s=o.canEvaluate,a=o.tryCatch1,c=o.errorObj;if(s){for(var u=function(t){return new Function("value","holder","                             \n	            'use strict';                                                    \n	            holder.pIndex = value;                                           \n	            holder.checkFulfillment(this);                                   \n	            ".replace(/Index/g,t))},l=function(t){for(var e=[],r=1;t>=r;++r)e.push("holder.p"+r);return new Function("holder","                                      \n	            'use strict';                                                    \n	            var callback = holder.fn;                                        \n	            return callback(values);                                         \n	            ".replace(/values/g,e.join(", ")))},f=[],h=[void 0],p=1;5>=p;++p)f.push(u(p)),h.push(l(p));var d=function(t,e){this.p1=this.p2=this.p3=this.p4=this.p5=null,this.fn=e,this.total=t,this.now=0};d.prototype.callers=h,d.prototype.checkFulfillment=function(t){var e=this.now;e++;var r=this.total;if(e>=r){var i=this.callers[r],n=a(i,void 0,this);n===c?t._rejectUnchecked(n.e):t._tryFollow(n)||t._fulfillUnchecked(n)}else this.now=e}}t.join=function(){var r,o=arguments.length-1;if(o>0&&"function"==typeof arguments[o]&&(r=arguments[o],6>o&&s)){var a=new t(n);a._setTrace(void 0);for(var c=new d(o,r),u=a._reject,l=f,h=0;o>h;++h){var p=i(arguments[h],void 0);p instanceof t?p.isPending()?p._then(l[h],u,void 0,a,c):p.isFulfilled()?l[h].call(a,p._settledValue,c):(a._reject(p._settledValue),p._unsetRejectionIsUnhandled()):l[h].call(a,p,c)}return a}for(var _=arguments.length,v=new Array(_),y=0;_>y;++y)v[y]=arguments[y];var a=new e(v).promise();return void 0!==r?a.spread(r):a}}},function(t,e,r){"use strict";var i=function(t,e){var r=arguments.length,i=arguments[2],n=arguments[3],o=r>=5?arguments[4]:void 0;setTimeout(function(){t(i,n,o)},0|e)};t.exports=function(t,e,n){var o=(r(5),r(7)),s=(r(13)(t),t.TimeoutError),a=function(t,e,r){if(t.isPending()){"string"!=typeof e&&(e="operation timed out after "+r+" ms");var i=new s(e);o.markAsOriginatingFromRejection(i),t._attachExtraTrace(i),t._cancel(i)}},c=function(t,e){e._fulfill(t)},u=t.delay=function(r,o){void 0===o&&(o=r,r=void 0),o=+o;var s=n(r,void 0),a=new t(e);return s instanceof t?(a._propagateFrom(s,7),a._follow(s),a.then(function(e){return t.delay(e,o)})):(a._setTrace(void 0),i(c,o,r,a),a)};t.prototype.delay=function(t){return u(this,t)},t.prototype.timeout=function(r,n){r=+r;var o=new t(e);return o._propagateFrom(this,7),o._follow(this),i(a,r,o,n,r),o.cancellable()}}},function(t,e,r){"use strict";t.exports=function(t,e,i){function n(r,n){var u=i(r,void 0);if(u instanceof t)return a(u);if(!s(r))return o("expecting an array, a promise or a thenable");var l=new t(e);void 0!==n?l._propagateFrom(n,7):l._setTrace(void 0);for(var f=l._fulfill,h=l._reject,p=0,d=r.length;d>p;++p){var _=r[p];(void 0!==_||c.call(r,p))&&t.cast(_)._then(f,h,void 0,l,null)}return l}var o=r(13)(t),s=r(5).isArray,a=function(t){return t.then(function(e){return n(e,t)})},c={}.hasOwnProperty;t.race=function(t){return n(t,void 0)},t.prototype.race=function(){return n(this,void 0)}}},function(t,e,r){"use strict";var i=Object.create;if(i){var n=i(null),o=i(null);n[" size"]=o[" size"]=0}t.exports=function(t){function e(t){return new Function("obj","                                             \n	        'use strict'                                                         \n	        var len = this.length;                                               \n	        switch(len) {                                                        \n	            case 1: return obj.methodName(this[0]);                          \n	            case 2: return obj.methodName(this[0], this[1]);                 \n	            case 3: return obj.methodName(this[0], this[1], this[2]);        \n	            case 0: return obj.methodName();                                 \n	            default: return obj.methodName.apply(obj, this);                 \n	        }                                                                    \n	        ".replace(/methodName/g,t))}function i(t){return new Function("obj","                                             \n	        'use strict';                                                        \n	        return obj.propertyName;                                             \n	        ".replace("propertyName",t))}function s(t,e,r){var i=r[t];if("function"!=typeof i){if(!d(t))return null;if(i=e(t),r[t]=i,r[" size"]++,r[" size"]>512){for(var n=Object.keys(r),o=0;256>o;++o)delete r[n[o]];r[" size"]=n.length-256}}return i}function a(t){return s(t,e,n)}function c(t){return s(t,i,o)}function u(t){return t[this.pop()].apply(t,this)}function l(t){return t[this]}function f(t){return t[this]}var h=r(5),p=h.canEvaluate,d=h.isIdentifier;t.prototype.call=function(t){for(var e=arguments.length,r=new Array(e-1),i=1;e>i;++i)r[i-1]=arguments[i];if(p){var n=a(t);if(null!==n)return this._then(n,void 0,void 0,r,void 0)}return r.push(t),this._then(u,void 0,void 0,r,void 0)},t.prototype.get=function(t){var e,r="number"==typeof t;if(r)e=f;else if(p){var i=c(t);e=null!==i?i:l}else e=l;return this._then(e,void 0,void 0,t,void 0)}}},function(t,e,r){"use strict";t.exports=function(t,e,i,n){function o(e,r){for(var i=f,s=t,a=r.length,c=0;a>c;++c){var u=h(r[c],void 0,e);if(u===i)return s.reject(i.e);var l=n(u,o);if(l instanceof s)return l}return null}function s(e,r,n){var o=this._promise=new t(i);o._setTrace(void 0),this._generatorFunction=e,this._receiver=r,this._generator=void 0,this._yieldHandlers="function"==typeof n?[n].concat(p):p}var a=r(7),c=a.TypeError,u=r(5).deprecated,l=r(5),f=l.errorObj,h=l.tryCatch1,p=[];s.prototype.promise=function(){return this._promise},s.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._next(void 0)},s.prototype._continue=function(e){if(e===f){this._generator=void 0;var r=a.canAttach(e.e)?e.e:new Error(e.e+"");return this._promise._attachExtraTrace(r),void this._promise._reject(e.e,r)}var i=e.value;if(e.done===!0)this._generator=void 0,this._promise._tryFollow(i)||this._promise._fulfill(i);else{var s=n(i,void 0);if(!(s instanceof t)&&(s=o(s,this._yieldHandlers),null===s))return void this._throw(new c("A value was yielded that could not be treated as a promise"));s._then(this._next,this._throw,void 0,this,null)}},s.prototype._throw=function(t){a.canAttach(t)&&this._promise._attachExtraTrace(t),this._continue(h(this._generator["throw"],this._generator,t))},s.prototype._next=function(t){this._continue(h(this._generator.next,this._generator,t))},t.coroutine=function(t,e){if("function"!=typeof t)throw new c("generatorFunction must be a function");var r=Object(e).yieldHandler,i=s;return function(){var e=t.apply(this,arguments),n=new i(void 0,void 0,r);return n._generator=e,n._next(void 0),n.promise()}},t.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new c("fn must be a function");p.push(t)},t.spawn=function(r){if(u("Promise.spawn is deprecated. Use Promise.coroutine instead."),"function"!=typeof r)return e("generatorFunction must be a function");var i=new s(r,this),n=i.promise();return i._run(t.spawn),n}}},function(t,e,r){"use strict";t.exports=function(t,e,i,n,o){function s(t,e,r,i){this.constructor$(t),this._callback=e,this._preservedValues=i===o?new Array(this.length()):null,this._limit=r,this._inFlight=0,this._queue=r>=1?[]:h,this._init$(void 0,-2)}function a(t,e,r,i){var n="object"==typeof r&&null!==r?r.concurrency:0;return n="number"==typeof n&&isFinite(n)&&n>=1?n:0,new s(t,e,n,i)}var c=r(5),u=c.tryCatch3,l=c.errorObj,f={},h=[];c.inherits(s,e),s.prototype._init=function(){},s.prototype._promiseFulfilled=function(e,r){var i=this._values;if(null!==i){var o=this.length(),s=this._preservedValues,a=this._limit;if(i[r]===f){if(i[r]=e,a>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return}else{if(a>=1&&this._inFlight>=a)return i[r]=e,void this._queue.push(r);null!==s&&(s[r]=e);var c=this._callback,h=this._promise._boundTo,p=u(c,h,e,r,o);if(p===l)return this._reject(p.e);var d=n(p,void 0);if(d instanceof t){if(d.isPending())return a>=1&&this._inFlight++,i[r]=f,d._proxyPromiseArray(this,r);if(!d.isFulfilled())return d._unsetRejectionIsUnhandled(),this._reject(d.reason());p=d.value()}i[r]=p}var _=++this._totalResolved;_>=o&&(null!==s?this._filter(i,s):this._resolve(i))}},s.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,r=this._values;t.length>0&&this._inFlight<e;){var i=t.pop();this._promiseFulfilled(r[i],i)}},s.prototype._filter=function(t,e){for(var r=e.length,i=new Array(r),n=0,o=0;r>o;++o)t[o]&&(i[n++]=e[o]);i.length=n,this._resolve(i)},s.prototype.preservedValues=function(){return this._preservedValues},t.prototype.map=function(t,e){return"function"!=typeof t?i("fn must be a function"):a(this,t,e,null).promise()},t.map=function(t,e,r,n){return"function"!=typeof e?i("fn must be a function"):a(t,e,r,n).promise()}}},function(t,e,r){"use strict";t.exports=function(t){function e(t){throw t}function i(t,r){if(!s.isArray(t))return n(t,r);var i=s.tryCatchApply(this,[null].concat(t),r);i===l&&a.invokeLater(e,void 0,i.e)}function n(t,r){var i=this,n=void 0===t?u(i,r,null):c(i,r,null,t);n===l&&a.invokeLater(e,void 0,n.e)}function o(t,r){var i=this,n=u(i,r,t);n===l&&a.invokeLater(e,void 0,n.e)}var s=r(5),a=r(6),c=s.tryCatch2,u=s.tryCatch1,l=s.errorObj;t.prototype.nodeify=function(t,e){if("function"==typeof t){var r=n;void 0!==e&&Object(e).spread&&(r=i),this._then(r,o,void 0,t,this._boundTo)}return this}}},function(t,e,r){"use strict";t.exports=function(t,e){function i(t){return t.replace(/([$])/,"\\$")}function n(t){try{return t.__isPromisified__===!0}catch(e){return!1}}function o(t,e,r){var i=m.getDataPropertyOrDefault(t,e+r,E);return i?n(i):!1}function s(t,e,r){for(var i=0;i<t.length;i+=2){var n=t[i];if(r.test(n))for(var o=n.replace(r,""),s=0;s<t.length;s+=2)if(t[s]===o)throw new F("Cannot promisify an API that has normal methods with '"+e+"'-suffix")}}function a(t,e,r,i){for(var a=m.inheritedDataKeys(t),c=[],u=0;u<a.length;++u){var l=a[u],f=t[l];"function"!=typeof f||n(f)||o(t,l,e)||!i(l,f,t)||c.push(l,f)}return s(c,e,r),c}function c(t){for(var e=[t],r=Math.max(0,t-1-5),i=t-1;i>=r;--i)i!==t&&e.push(i);for(var i=t+1;5>=i;++i)e.push(i);return e}function u(t){return m.filledRange(t,"arguments[","]")}function l(t){return m.filledRange(t,"_arg","")}function f(t){return"number"==typeof t.length?Math.max(Math.min(t.length,1024),0):0}function h(t){return m.isIdentifier(t)?"."+t:"['"+t.replace(/(['\\])/g,"\\$1")+"']"}function p(r,i,n,o,s){function a(t){var e,n=u(t).join(", "),o=t>0?", ":"";return e="string"==typeof r?"                                                          \n	                this.method({{args}}, fn);                                   \n	                break;                                                       \n	            ".replace(".method",h(r)):i===y?"                                                         \n	                callback.call(this, {{args}}, fn);                           \n	                break;                                                       \n	            ":void 0!==i?"                                                         \n	                callback.call(receiver, {{args}}, fn);                       \n	                break;                                                       \n	            ":"                                                         \n	                callback({{args}}, fn);                                      \n	                break;                                                       \n	            ",e.replace("{{args}}",n).replace(", ",o)}function p(){for(var t="",e=0;e<_.length;++e)t+="case "+_[e]+":"+a(_[e]);var n;return n="string"==typeof r?"                                                  \n	                this.property.apply(this, args);                             \n	            ".replace(".property",h(r)):i===y?"                                                  \n	                callback.apply(this, args);                                  \n	            ":"                                                  \n	                callback.apply(receiver, args);                              \n	            ",t+="                                                             \n	        default:                                                             \n	            var args = new Array(len + 1);                                   \n	            var i = 0;                                                       \n	            for (var i = 0; i < len; ++i) {                                  \n	               args[i] = arguments[i];                                       \n	            }                                                                \n	            args[i] = fn;                                                    \n	            [CodeForCall]                                                    \n	            break;                                                           \n	        ".replace("[CodeForCall]",n)}var d=Math.max(0,f(o)-1),_=c(d),v="string"==typeof n&&m.isIdentifier(n)?n+s:"promisified";return new Function("Promise","callback","receiver","withAppended","maybeWrapAsError","nodebackForPromise","INTERNAL","                                         \n	        var ret = function FunctionName(Parameters) {                        \n	            'use strict';                                                    \n	            var len = arguments.length;                                      \n	            var promise = new Promise(INTERNAL);                             \n	            promise._setTrace(void 0);                                       \n	            var fn = nodebackForPromise(promise);                            \n	            try {                                                            \n	                switch(len) {                                                \n	                    [CodeForSwitchCase]                                      \n	                }                                                            \n	            } catch (e) {                                                    \n	                var wrapped = maybeWrapAsError(e);                           \n	                promise._attachExtraTrace(wrapped);                          \n	                promise._reject(wrapped);                                    \n	            }                                                                \n	            return promise;                                                  \n	        };                                                                   \n	        ret.__isPromisified__ = true;                                        \n	        return ret;                                                          \n	        ".replace("FunctionName",v).replace("Parameters",l(d)).replace("[CodeForSwitchCase]",p()))(t,r,i,b,w,g,e)}function d(r,i){function n(){var n=i;i===y&&(n=this),"string"==typeof r&&(r=n[r]);var o=new t(e);o._setTrace(void 0);var s=g(o);try{r.apply(n,b(arguments,s))}catch(a){var c=w(a);o._attachExtraTrace(c),o._reject(c)}return o}return n.__isPromisified__=!0,n}function _(t,e,r,n){for(var o=new RegExp(i(e)+"$"),s=a(t,e,o,r),c=0,u=s.length;u>c;c+=2){var l=s[c],f=s[c+1],h=l+e;t[h]=n===R?R(l,y,l,f,e):n(f)}return m.toFastProperties(t),t}function v(t,e){return R(t,e,void 0,t)}var y={},m=r(5),g=r(12)._nodebackForPromise,b=m.withAppended,w=m.maybeWrapAsError,j=m.canEvaluate,F=r(7).TypeError,k="Async",T=function(t,e){return m.isIdentifier(t)&&"_"!==t.charAt(0)&&!m.isClass(e)},E={__isPromisified__:!0},R=j?p:d;t.promisify=function(t,e){if("function"!=typeof t)throw new F("fn must be a function");return n(t)?t:v(t,arguments.length<2?y:e)},t.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!=typeof t)throw new F("the target of promisifyAll must be an object or a function");e=Object(e);var r=e.suffix;"string"!=typeof r&&(r=k);var i=e.filter;"function"!=typeof i&&(i=T);var n=e.promisifier;if("function"!=typeof n&&(n=R),!m.isIdentifier(r))throw new RangeError("suffix must be a valid identifier");for(var o=m.inheritedDataKeys(t,{includeHidden:!0}),s=0;s<o.length;++s){var a=t[o[s]];"constructor"!==o[s]&&m.isClass(a)&&(_(a.prototype,r,i,n),_(a,r,i,n))}return _(t,r,i,n)}}},function(t,e,r){"use strict";t.exports=function(t,e,i){function n(t){for(var e=u.keys(t),r=e.length,i=new Array(2*r),n=0;r>n;++n){var o=e[n];i[n]=t[o],i[n+r]=o}this.constructor$(i)}function o(e){var r,o=i(e,void 0);return c(o)?(r=o instanceof t?o._then(t.props,void 0,void 0,void 0,void 0):new n(o).promise(),o instanceof t&&r._propagateFrom(o,4),r):a("cannot await properties of a non-object")}var s=r(5),a=r(13)(t),c=s.isObject,u=r(36);s.inherits(n,e),n.prototype._init=function(){this._init$(void 0,-3)},n.prototype._promiseFulfilled=function(t,e){if(!this._isResolved()){this._values[e]=t;var r=++this._totalResolved;if(r>=this._length){for(var i={},n=this.length(),o=0,s=this.length();s>o;++o)i[this._values[o+n]]=this._values[o];this._resolve(i)}}},n.prototype._promiseProgressed=function(t,e){this._isResolved()||this._promise._progress({key:this._values[e+this.length()],value:t})},n.prototype.shouldCopyValues=function(){return!1},n.prototype.getActualLength=function(t){return t>>1},t.prototype.props=function(){return o(this)},t.props=function(t){return o(t)}}},function(t,e,r){"use strict";t.exports=function(t,e,i,n,o){function s(e,r,i,s){this.constructor$(e),this._preservedValues=s===o?[]:null,this._zerothIsAccum=void 0===i,this._gotAccum=!1,this._reducingIndex=this._zerothIsAccum?1:0,this._valuesPhase=void 0;var a=n(i,void 0),c=!1,u=a instanceof t;u&&(a.isPending()?a._proxyPromiseArray(this,-1):a.isFulfilled()?(i=a.value(),this._gotAccum=!0):(a._unsetRejectionIsUnhandled(),this._reject(a.reason()),c=!0)),u||this._zerothIsAccum||(this._gotAccum=!0),this._callback=r,this._accum=i,c||this._init$(void 0,-5)}function a(t,e,r,n){if("function"!=typeof e)return i("fn must be a function");var o=new s(t,e,r,n);return o.promise()}var c=r(5),u=c.tryCatch4,l=c.tryCatch3,f=c.errorObj;c.inherits(s,e),s.prototype._init=function(){},s.prototype._resolveEmptyArray=function(){(this._gotAccum||this._zerothIsAccum)&&this._resolve(null!==this._preservedValues?[]:this._accum)},s.prototype._promiseFulfilled=function(e,r){var i=this._values;if(null!==i){var o,s=this.length(),a=this._preservedValues,c=null!==a,h=this._gotAccum,p=this._valuesPhase;if(!p)for(p=this._valuesPhase=Array(s),o=0;s>o;++o)p[o]=0;if(o=p[r],0===r&&this._zerothIsAccum?(h||(this._accum=e,this._gotAccum=h=!0),p[r]=0===o?1:2):-1===r?h||(this._accum=e,this._gotAccum=h=!0):0===o?p[r]=1:(p[r]=2,h&&(this._accum=e)),h){for(var d,_=this._callback,v=this._promise._boundTo,y=this._reducingIndex;s>y;++y)if(o=p[y],2!==o){if(1!==o)return;if(e=i[y],e instanceof t){if(!e.isFulfilled())return e.isPending()?void 0:(e._unsetRejectionIsUnhandled(),this._reject(e.reason()));e=e._settledValue}if(c?(a.push(e),d=l(_,v,e,y,s)):d=u(_,v,this._accum,e,y,s),d===f)return this._reject(d.e);var m=n(d,void 0);if(m instanceof t){if(m.isPending())return p[y]=4,m._proxyPromiseArray(this,y);if(!m.isFulfilled())return m._unsetRejectionIsUnhandled(),this._reject(m.reason());d=m.value()}this._reducingIndex=y+1,this._accum=d}else this._reducingIndex=y+1;this._reducingIndex<s||this._resolve(c?a:this._accum)}}},t.prototype.reduce=function(t,e){return a(this,t,e,null)},t.reduce=function(t,e,r,i){return a(t,e,r,i)}}},function(t,e,r){"use strict";t.exports=function(t,e){function i(t){this.constructor$(t)}var n=t.PromiseInspection,o=r(5);o.inherits(i,e),i.prototype._promiseResolved=function(t,e){this._values[t]=e;var r=++this._totalResolved;r>=this._length&&this._resolve(this._values)
},i.prototype._promiseFulfilled=function(t,e){if(!this._isResolved()){var r=new n;r._bitField=268435456,r._settledValue=t,this._promiseResolved(e,r)}},i.prototype._promiseRejected=function(t,e){if(!this._isResolved()){var r=new n;r._bitField=134217728,r._settledValue=t,this._promiseResolved(e,r)}},t.settle=function(t){return new i(t).promise()},t.prototype.settle=function(){return new i(this).promise()}}},function(t,e,r){"use strict";t.exports=function(t,e,i){function n(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function o(t,e){if((0|e)!==e||0>e)return i("expecting a positive integer");var r=new n(t),o=r.promise();return o.isRejected()?o:(r.setHowMany(e),r.init(),o)}var s=r(5),a=r(7).RangeError,c=r(7).AggregateError,u=s.isArray;s.inherits(n,e),n.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-5);var t=u(this._values);!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},n.prototype.init=function(){this._initialized=!0,this._init()},n.prototype.setUnwrap=function(){this._unwrap=!0},n.prototype.howMany=function(){return this._howMany},n.prototype.setHowMany=function(t){this._isResolved()||(this._howMany=t)},n.prototype._promiseFulfilled=function(t){this._isResolved()||(this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),this._resolve(1===this.howMany()&&this._unwrap?this._values[0]:this._values)))},n.prototype._promiseRejected=function(t){if(!this._isResolved()&&(this._addRejected(t),this.howMany()>this._canPossiblyFulfill())){for(var e=new c,r=this.length();r<this._values.length;++r)e.push(this._values[r]);this._reject(e)}},n.prototype._fulfilled=function(){return this._totalResolved},n.prototype._rejected=function(){return this._values.length-this.length()},n.prototype._addRejected=function(t){this._values.push(t)},n.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},n.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},n.prototype._getRangeError=function(t){var e="Input array must contain at least "+this._howMany+" items but contains only "+t+" items";return new a(e)},n.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},t.some=function(t,e){return o(t,e)},t.prototype.some=function(t){return o(this,t)},t._SomePromiseArray=n}},function(t,e,r){"use strict";t.exports=function(t,e){var i=r(5),n=r(6),o=r(7),s=i.tryCatch1,a=i.errorObj;t.prototype.progressed=function(t){return this._then(void 0,void 0,t,void 0,void 0)},t.prototype._progress=function(t){this._isFollowingOrFulfilledOrRejected()||this._progressUnchecked(t)},t.prototype._clearFirstHandlerData$Base=t.prototype._clearFirstHandlerData,t.prototype._clearFirstHandlerData=function(){this._clearFirstHandlerData$Base(),this._progressHandler0=void 0},t.prototype._progressHandlerAt=function(t){return 0===t?this._progressHandler0:this[(t<<2)+t-5+2]},t.prototype._doProgressWith=function(e){var r=e.value,i=e.handler,n=e.promise,c=e.receiver,u=s(i,c,r);if(u===a){if(null!=u.e&&"StopProgressPropagation"!==u.e.name){var l=o.canAttach(u.e)?u.e:new Error(u.e+"");n._attachExtraTrace(l),n._progress(u.e)}}else u instanceof t?u._then(n._progress,null,null,n,void 0):n._progress(u)},t.prototype._progressUnchecked=function(r){if(this.isPending())for(var i=this._length(),o=this._progress,s=0;i>s;s++){var a=this._progressHandlerAt(s),c=this._promiseAt(s);if(c instanceof t)"function"==typeof a?n.invoke(this._doProgressWith,this,{handler:a,promise:c,receiver:this._receiverAt(s),value:r}):n.invoke(o,c,r);else{var u=this._receiverAt(s);"function"==typeof a?a.call(u,r,c):u instanceof t&&u._isProxied()?u._progressUnchecked(r):u instanceof e&&u._promiseProgressed(r,c)}}}}},function(t,e,r){"use strict";t.exports=function(t,e){var i=r(7),n=i.canAttach,o=r(6),s=i.CancellationError;t.prototype._cancel=function(t){if(!this.isCancellable())return this;for(var e,r=this;void 0!==(e=r._cancellationParent)&&e.isCancellable();)r=e;r._attachExtraTrace(t),r._rejectUnchecked(t)},t.prototype.cancel=function(t){return this.isCancellable()?(t=void 0!==t?n(t)?t:new Error(t+""):new s,o.invokeLater(this._cancel,this,t),this):this},t.prototype.cancellable=function(){return this._cancellable()?this:(this._setCancellable(),this._cancellationParent=void 0,this)},t.prototype.uncancellable=function(){var r=new t(e);return r._propagateFrom(this,6),r._follow(this),r._unsetCancellable(),r},t.prototype.fork=function(t,e,r){var i=this._then(t,e,r,void 0,void 0);return i._setCancellable(),i._cancellationParent=void 0,i}}},function(t){"use strict";t.exports=function(t,e){var r=t.map;t.prototype.filter=function(t,i){return r(this,t,i,e)},t.filter=function(t,i,n){return r(t,i,n,e)}}},function(t){"use strict";t.exports=function(t){function e(t){var e=new r(t),i=e.promise();return i.isRejected()?i:(e.setHowMany(1),e.setUnwrap(),e.init(),i)}var r=t._SomePromiseArray;t.any=function(t){return e(t)},t.prototype.any=function(){return e(this)}}},function(t){"use strict";t.exports=function(t,e){var r=t.reduce;t.prototype.each=function(t){return r(this,t,null,e)},t.each=function(t,i){return r(t,i,null,e)}}},function(t,e,r){"use strict";t.exports=function(t,e,i){function n(e){for(var r=e.length,i=0;r>i;++i){var n=e[i];if(n.isRejected())return t.reject(n.error());e[i]=n.value()}return e}function o(t){setTimeout(function(){throw t},0)}function s(t){var e=i(t,void 0);return e!==t&&"function"==typeof t._isDisposable&&"function"==typeof t._getDisposer&&t._isDisposable()&&e._setDisposable(t._getDisposer()),e}function a(e,r){function n(){if(a>=c)return u.resolve();var l=s(e[a++]);if(l instanceof t&&l._isDisposable()){try{l=i(l._getDisposer().tryDispose(r),void 0)}catch(f){return o(f)}if(l instanceof t)return l._then(n,o,null,null,null)}n()}var a=0,c=e.length,u=t.defer();return n(),u.promise}function c(t){var e=new d;return e._settledValue=t,e._bitField=268435456,a(this,e).thenReturn(t)}function u(t){var e=new d;return e._settledValue=t,e._bitField=134217728,a(this,e).thenThrow(t)}function l(t,e){this._data=t,this._promise=e}function f(t,e){this.constructor$(t,e)}var h=r(7).TypeError,p=r(5).inherits,d=t.PromiseInspection;l.prototype.data=function(){return this._data},l.prototype.promise=function(){return this._promise},l.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():null},l.prototype.tryDispose=function(t){var e=this.resource(),r=null!==e?this.doDispose(e,t):null;return this._promise._unsetDisposable(),this._data=this._promise=null,r},l.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},p(f,l),f.prototype.doDispose=function(t,e){var r=this.data();return r.call(t,t,e)},t.using=function(){var r=arguments.length;if(2>r)return e("you must pass at least 2 arguments to Promise.using");var i=arguments[r-1];if("function"!=typeof i)return e("fn must be a function");r--;for(var o=new Array(r),s=0;r>s;++s){var a=arguments[s];if(l.isDisposer(a)){var f=a;a=a.promise(),a._setDisposable(f)}o[s]=a}return t.settle(o).then(n).spread(i)._then(c,u,void 0,o,void 0)},t.prototype._setDisposable=function(t){this._bitField=262144|this._bitField,this._disposer=t},t.prototype._isDisposable=function(){return(262144&this._bitField)>0},t.prototype._getDisposer=function(){return this._disposer},t.prototype._unsetDisposable=function(){this._bitField=-262145&this._bitField,this._disposer=void 0},t.prototype.disposer=function(t){if("function"==typeof t)return new f(t,this);throw new h}}},function(t){function e(){}var r=t.exports={};r.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var r=[];return window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),r.length>0)){var i=r.shift();i()}},!0),function(t){r.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.on=e,r.addListener=e,r.once=e,r.off=e,r.removeListener=e,r.removeAllListeners=e,r.emit=e,r.binding=function(){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(){throw new Error("process.chdir is not supported")}},function(t){var e=function(){"use strict";return void 0===this}();if(e)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,keys:Object.keys,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:e};else{var r={}.hasOwnProperty,i={}.toString,n={}.constructor.prototype,o=function(t){var e=[];for(var i in t)r.call(t,i)&&e.push(i);return e},s=function(t,e,r){return t[e]=r.value,t},a=function(t){return t},c=function(t){try{return Object(t).constructor.prototype}catch(e){return n}},u=function(t){try{return"[object Array]"===i.call(t)}catch(e){return!1}};t.exports={isArray:u,keys:o,defineProperty:s,freeze:a,getPrototypeOf:c,isES5:e}}},function(t,e,r){(function(e){"use strict";var r,i;if("object"==typeof e&&"string"==typeof e.version)r=function(t){e.nextTick(t)};else if("undefined"!=typeof MutationObserver&&(i=MutationObserver)||"undefined"!=typeof WebKitMutationObserver&&(i=WebKitMutationObserver))r=function(){var t=document.createElement("div"),e=void 0,r=new i(function(){var t=e;e=void 0,t()});return r.observe(t,{attributes:!0}),function(r){e=r,t.classList.toggle("foo")}}();else{if("undefined"==typeof setTimeout)throw new Error("no async scheduler available");r=function(t){setTimeout(t,0)}}t.exports=r}).call(e,r(35))},function(t){"use strict";function e(t,e,r,i,n){for(var o=0;n>o;++o)r[o+i]=t[o+e]}function r(t){this._capacity=t,this._length=0,this._front=0,this._makeCapacity()}r.prototype._willBeOverCapacity=function(t){return this._capacity<t},r.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1);var r=this._front+e&this._capacity-1;this[r]=t,this._length=e+1},r.prototype.push=function(t,e,r){var i=this.length()+3;if(this._willBeOverCapacity(i))return this._pushOne(t),this._pushOne(e),void this._pushOne(r);var n=this._front+i-3;this._checkCapacity(i);var o=this._capacity-1;this[n+0&o]=t,this[n+1&o]=e,this[n+2&o]=r,this._length=i},r.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},r.prototype.length=function(){return this._length},r.prototype._makeCapacity=function(){for(var t=this._capacity,e=0;t>e;++e)this[e]=void 0},r.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<3)},r.prototype._resizeTo=function(t){var r=this._front,i=this._capacity,n=new Array(i),o=this.length();if(e(this,0,n,0,i),this._capacity=t,this._makeCapacity(),this._front=0,i>=r+o)e(n,r,this,0,o);else{var s=o-(r+o&i-1);e(n,r,this,0,s),e(n,0,this,s,o-s)}},t.exports=r}])});