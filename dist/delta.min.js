!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("js-graph")):"function"==typeof define&&define.amd?define(["js-graph"],e):"object"==typeof exports?exports.DeltaJs=e(require("js-graph")):t.DeltaJs=e(t.JsGraph)}(this,function(t){return function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return t[o].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)["default"]}([function(t,e,n){"use strict";Object.defineProperties(e,{"default":{get:function(){return b}},__esModule:{value:!0}});var o,r,i,a,u,s=(o=n(1),o&&o.__esModule&&o||{"default":o})["default"],l=(r=n(2),r&&r.__esModule&&r||{"default":r})["default"],c=(i=n(3),i&&i.__esModule&&i||{"default":i}),f=c.ReadableTarget,p=c.WritableTarget;s.extend(l,{ReadableTarget:f,WritableTarget:p});var d=(a=n(4),a&&a.__esModule&&a||{"default":a})["default"];s.extend(l,{Path:d});var h=(u=n(5),u&&u.__esModule&&u||{"default":u}),v=h.ApplicationError,g=h.MultipleOverloadsApplicationError,m=h.NoOverloadsApplicationError,_=h.DeltaArgApplicationError,y=h.CompositionError,w=h.MultipleOverloadsCompositionError;s.extend(l,{ApplicationError:v,MultipleOverloadsApplicationError:g,NoOverloadsApplicationError:m,DeltaArgApplicationError:_,CompositionError:y,MultipleOverloadsCompositionError:w});var b=l},function(t,e){"use strict";Object.defineProperties(e,{"default":{get:function(){return o}},__esModule:{value:!0}});var n={newClass:function(){var t=void 0!==arguments[0]?arguments[0]:{},e=void 0!==arguments[1]?arguments[1]:{};"function"!=typeof t&&(e=t,t=function(){});var n=t;return n.prototype=e,n.prototype.constructor=n,n},newSubclass:function(t){var e=void 0!==arguments[1]?arguments[1]:{},o=void 0!==arguments[2]?arguments[2]:{};"function"!=typeof e&&(o=e,e=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.apply(this,e)}});var r=e(t.prototype.constructor);return r.prototype=Object.create(t.prototype),n.extend(r.prototype,o),r.prototype.constructor=r,r},extend:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.forEach(function(e){for(var n in e)e.hasOwnProperty(n)&&Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}),t},"default":function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];var r=e.slice(0,-1),i=e[e.length-1];if(0===r.length)return t;var a=n.o.apply(null,[t].concat(r.slice(0,-1)));return n.isUndefined(a[r[r.length-1]])&&(a[r[r.length-1]]=i),a[r[r.length-1]]},o:function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return n["default"].apply(null,[t].concat(e).concat([{}]))},a:function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return n["default"].apply(null,[t].concat(e).concat([[]]))},applyConstructor:function(t,e){var n=Object.create(t.prototype);return t.apply(n,e),n},assert:function(t,e){if(!t)throw new Error(e||"Assertion failed")},isUndefined:function(t){return"undefined"==typeof t},isDefined:function(t){return"undefined"!=typeof t},repeat:function(t,e){return new Array(t+1).join(e)},indent:function(t,e){var o=void 0!==arguments[2]?arguments[2]:" ";return t.replace(/^(?!\s*$)/gm,n.repeat(e,o))}},o=n},function(t,e,n){"use strict";Object.defineProperties(e,{"default":{get:function(){return R}},__esModule:{value:!0}});var o,r,i,a,u,s,l,c,f,p,d,h,v,g,m=((o=n(6),o&&o.__esModule&&o||{"default":o})["default"],(r=n(1),r&&r.__esModule&&r||{"default":r})["default"]),_=((i=n(4),i&&i.__esModule&&i||{"default":i})["default"],a=n(3),a&&a.__esModule&&a||{"default":a}),y=(_.ReadableTarget,_.WritableTarget,_.rt,_.wt,u=n(5),u&&u.__esModule&&u||{"default":u}),w=y.ApplicationError,b=(y.MultipleOverloadsApplicationError,y.NoOverloadsApplicationError,y.DeltaArgApplicationError,y.CompositionError),M=(y.MultipleOverloadsCompositionError,(s=n(7),s&&s.__esModule&&s||{"default":s})["default"]),O=(l=n(8),l&&l.__esModule&&l||{"default":l})["default"],D=(c=n(9),c&&c.__esModule&&c||{"default":c})["default"],A=(f=n(10),f&&f.__esModule&&f||{"default":f})["default"],T=(p=n(11),p&&p.__esModule&&p||{"default":p})["default"],j=(d=n(12),d&&d.__esModule&&d||{"default":d})["default"],C=(h=n(13),h&&h.__esModule&&h||{"default":h})["default"],E=(v=n(14),v&&v.__esModule&&v||{"default":v})["default"],P=(g=n(15),g&&g.__esModule&&g||{"default":g})["default"],R=m.newClass(function(){this._compositions=[],this._overloads={},this._onNewOperationTypeListeners=[],M(this),O(this),D(this),A(this),T(this),j(this),C(this),E(this),P(this)},{_evaluatePrecondition:function(t,e){if("function"==typeof t.precondition){var n=t.precondition(e);if(n instanceof w)return n;if(!n)return new w(t,e.value)}return!0},newOperationType:function(t,e,n){var o,r=this;"string"==typeof t&&(o=[void 0,t,e],t=o[0],e=o[1],n=o[2],o),n=n||{};var i=this;m.assert(e[0]===e[0].toUpperCase(),"Delta operations must have a name starting with a capital letter -- '"+e+"' does not."),m.assert(!this.Delta[e],"The '"+e+"' operation type already exists.");var a=this.Delta[e]=m.newSubclass(t||this.Delta,function(t){return function(e,n){t.call(this,e,n),this.construct&&this.construct()}},m.extend({},n,{applyTo:function(t){var e=i._evaluatePrecondition(this,t);if(e!==!0)throw e;m.isDefined(n.applyTo)&&n.applyTo.call(this,t)}}));return a.type=a.prototype.type=e,a.meta=a.prototype.meta={methods:n.methods||[e[0].toLowerCase()+e.slice(1)]},a.meta.methods.forEach(function(t){m.a(r._overloads,t).push(e)}),this._onNewOperationTypeListeners.forEach(function(t){t(a)}),a},onNewOperationType:function(t){var e=this;this._onNewOperationTypeListeners.push(t),Object.keys(this.Delta).forEach(function(n){n[0]===n[0].toUpperCase()&&t(e.Delta[n])})},newComposition:function(t,e){this._compositions.push({precondition:t,compose:e})},composed:function(t,e){m.isUndefined(t)&&(t=new this.Delta.NoOp),m.isUndefined(e)&&(e=new this.Delta.NoOp);var n=function(){},o=this._compositions.some(function(o){var r=o,i=r.precondition,a=r.compose;return i(t,e)?(n=a,!0):void 0});if(!o)throw new b(t,e);return n(t,e)}})},function(t,e,n){"use strict";function o(t,e){return new s(t,e)}function r(t,e){return new u(t,e)}Object.defineProperties(e,{ReadableTarget:{get:function(){return u}},WritableTarget:{get:function(){return s}},wt:{get:function(){return o}},rt:{get:function(){return r}},__esModule:{value:!0}});var i,a=(i=n(1),i&&i.__esModule&&i||{"default":i})["default"],u=a.newClass(function(t){this._val=t},{getValue:function(){return this._val},get value(){return this.getValue()},set value(t){this.setValue(t)}}),s=a.newSubclass(u,function(){return function(t,e){this._obj=t,this._prop=e}},{getValue:function(){return this._obj[this._prop]},setValue:function(t){this._obj[this._prop]=t},"delete":function(){delete this._obj[this._prop]}});u.prototype.chain=function(t){return a.assert(this.value instanceof Object,"The ReadableTarget.prototype.chain method expects the target value to be an Object."),new s(this.value,t)}},function(t,e,n){"use strict";Object.defineProperties(e,{"default":{get:function(){return a}},__esModule:{value:!0}});var o,r=(o=n(1),o&&o.__esModule&&o||{"default":o})["default"],i=r.newClass(function(){var t=void 0!==arguments[0]?arguments[0]:"",e=t.match(/^([.#]?)(\w*|\(\w+\))(.*)$/);r.assert(e,"The path string '"+t+"' is not well formed.");var n=e,o=n[1],a=n[2],u=n[3];"#"===o?this.set(new i(".(instance)."+a+u)):""!==a&&(this._prop=a,""!==u&&(this._rest=new i(u)))},{set:function(t){this._prop=t._prop,this._rest=t._rest},get prop(){return this._prop},get rest(){return this._rest}}),a=i},function(t,e,n){"use strict";Object.defineProperties(e,{ApplicationError:{get:function(){return i}},MultipleOverloadsApplicationError:{get:function(){return a}},NoOverloadsApplicationError:{get:function(){return u}},DeltaArgApplicationError:{get:function(){return s}},CompositionError:{get:function(){return l}},MultipleOverloadsCompositionError:{get:function(){return c}},__esModule:{value:!0}});var o,r=(o=n(1),o&&o.__esModule&&o||{"default":o})["default"],i=r.newSubclass(Error,function(t){return function(e,n){t.call(this,"This delta of type '"+e.type+"' cannot apply to this value of type '"+typeof n+"."),this.delta=e,this.value=n}}),a=r.newSubclass(i,function(t){return function(e,n){var o=void 0!==arguments[2]?arguments[2]:[];t.call(this,e,n),this.errors=o,this.message="None of these deltas of types "+e.overloads.map(function(t){return"'"+t.type+"'"}).join(",")+" can apply to this value of type '"+typeof n+"."+o.map(function(t){return"\n-- "+t.message}).join("")}}),u=r.newSubclass(i,function(t){return function(e,n){t.call(this,e,n),this.message="This delta of type '"+e.type+"' has no spcific deltas assigned to it, so it cannot apply to this value of type '"+typeof n+"."}}),s=r.newSubclass(i,function(t){return function(e,n){t.call(this,e,n.arg),this.message="This delta of type '"+e.type+"' cannot apply to the type-'"+typeof n.arg+"'-value of this base delta of type '"+n.type+"'.",this.baseDelta=n}}),l=r.newSubclass(Error,function(t){return function(e,n){t.call(this,"This delta of type '"+e.type+"' cannot be composed with this other delta of type '"+n.type+"."),this.delta1=e,this.delta2=n}}),c=r.newSubclass(l,function(t){return function(e,n){var o=void 0!==arguments[2]?arguments[2]:[];t.call(this,e,n),this.errors=o,this.message="There are no overloads to compose this delta of type '"+e.type+"' with this other delta of type '"+n.type+"'."+o.map(function(t){return"\n-- "+t.message}).join("")}})},function(e){e.exports=t},function(t,e,n){"use strict";Object.defineProperties(e,{"default":{get:function(){return l}},__esModule:{value:!0}});var o,r,i=(o=n(1),o&&o.__esModule&&o||{"default":o})["default"],a=(r=n(3),r&&r.__esModule&&r||{"default":r}),u=a.ReadableTarget,s=a.wt,l=function(t){i.isDefined(t.Delta)||(t._nextDeltaUUID=0,t.Delta=i.newClass(function(e,n){this.arg=e,this.meta=i.extend({},n||{},{uuid:t._nextDeltaUUID++})},{clone:function(){return new this.constructor(this.arg,this.meta)},appliedTo:function(t){t instanceof u&&(t=t.value),"function"==typeof t.clone&&(t=t.clone());var e={value:t};return this.applyTo(s(e,"value")),e.value},composedWith:function(e){return t.composed(this,e)},toString:function(){var t=void 0!==arguments[0]?arguments[0]:{},e=this.type;return this.meta.targetProp&&(e+=" ‹"+this.meta.targetProp+"›"),i.isDefined(this.arg)&&(e+=": "+JSON.stringify(this.arg)),t.debug&&(e+=" ("+this.meta.uuid+")"),e}}))}},function(t,e,n){"use strict";Object.defineProperties(e,{"default":{get:function(){return u}},__esModule:{value:!0}});var o,r,i=(o=n(1),o&&o.__esModule&&o||{"default":o})["default"],a=(r=n(7),r&&r.__esModule&&r||{"default":r})["default"],u=function(t){if(!i.isDefined(t.Delta.Composite)){a(t),i.extend(t.constructor.prototype,{_getDeltaByMethod:function(t,e){var n=this,o=this._overloads[t].map(function(o){return new n.Delta[o](e,{method:t})});if(1===o.length)return o[0];var r=new this.Delta.Overloaded(e,{method:t});return r.overloads=o,r}}),t.Delta.Composite=i.newSubclass(t.Delta,function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.apply(this,e)}},{operation:function(){throw new Error("A Delta.Composite subclass needs to implement the 'operation' method.")},facade:function(){return t.facade(this)}});var e={};t.onNewOperationType(function(n){(n.meta&&n.meta.methods||[]).forEach(function(n){i.isUndefined(e[n])&&(e[n]=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var r=this._applyOperationMethod.apply(this,[n].concat(e));return t.facade(r instanceof t.Delta.Composite?r:this.delta)})})}),t.facade=function n(t){var o=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=n(t);return i._args=o._args.concat(e),i};return o._args=[],i.extend(o,e,{_applyOperationMethod:function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return t.operation.apply(t,[e].concat(o._args).concat(n))},delta:t}),o}}}},function(t,e,n){"use strict";Object.defineProperties(e,{"default":{get:function(){return p}},__esModule:{value:!0}});var o,r,i,a=(o=n(1),o&&o.__esModule&&o||{"default":o})["default"],u=(r=n(7),r&&r.__esModule&&r||{"default":r})["default"],s=(i=n(5),i&&i.__esModule&&i||{"default":i}),l=s.MultipleOverloadsApplicationError,c=s.NoOverloadsApplicationError,f=s.MultipleOverloadsCompositionError,p=function(t){a.isDefined(t.Delta.Overloaded)||(u(t),t.newOperationType(t.Delta,"Overloaded",{construct:function(){this.overloads=[]},clone:function(){var e=t.Delta.prototype.clone.call(this,this.arg,this.meta);return e.overloads=this.overloads.map(function(t){return t.clone()}),e},applyTo:function(e){var n=[],o=this.overloads.some(function(o){var r=t._evaluatePrecondition(o,e);return r!==!0?(n.push(r),!1):(o.applyTo(e),!0)});if(!o)throw 0===n.length?new c(this,e.value):1===n.length?n[0]:new l(this,e.value,n)},toString:function(e){var n=t.Delta.prototype.toString.call(this,e),o=this.overloads.map(function(t){return t.toString(e)}).join("\n");return n+="\n"+a.indent(o,4)}}),t.newComposition(function(e,n){return e instanceof t.Delta.Overloaded||n instanceof t.Delta.Overloaded},function(e,n){var o=e instanceof t.Delta.Overloaded?e.overloads:[e],r=n instanceof t.Delta.Overloaded?n.overloads:[n],i=new t.Delta.Overloaded,a=[];if(o.forEach(function(t){r.forEach(function(e){try{i.overloads.push(t.composedWith(e))}catch(n){a.push(n)}})}),0===i.overloads.length)throw new f(e,n,a);return i}))}},function(t,e,n){"use strict";Object.defineProperties(e,{"default":{get:function(){return f}},__esModule:{value:!0}});var o,r,i,a,u=(o=n(1),o&&o.__esModule&&o||{"default":o})["default"],s=(r=n(4),r&&r.__esModule&&r||{"default":r})["default"],l=(i=n(3),i&&i.__esModule&&i||{"default":i}).wt,c=(a=n(8),a&&a.__esModule&&a||{"default":a})["default"],f=function(t){u.isDefined(t.Delta.Modify)||(c(t),t.newOperationType(t.Delta.Composite,"Modify",{construct:function(){this.deltas={}},clone:function(){var e=this,n=t.Delta.prototype.clone.call(this,this.arg,this.meta);return Object.keys(this.deltas).forEach(function(t){n.deltas[t]=e.deltas[t].clone()}),n},precondition:function(t){return t.value instanceof Object},applyTo:function(t){var e=this;Object.keys(this.deltas).forEach(function(n){e.deltas[n].applyTo(l(t.value,n))})},toString:function(e){var n=this,o=t.Delta.prototype.toString.call(this,e);if(Object.keys(this.deltas).length>0){var r=Object.keys(this.deltas).map(function(t){return n.deltas[t].toString(e)}).join("\n");o+="\n"+u.indent(r,4)}return o},operation:function(e,n,o,r){var i;"string"==typeof n&&(i=[{},n,o],n=i[0],o=i[1],r=i[2],i);var a=t._getDeltaByMethod(e,r);return this._addOperation(n,new s(o),a)},_addOperation:function(e,n,o){return n.rest?this.operation("modify",n.prop)._addOperation(e,n.rest,o):(this.deltas[n.prop]=this.deltas[n.prop]?this.deltas[n.prop].composedWith(o):o,this.deltas[n.prop].meta.targetProp=n.prop,this.deltas[n.prop]instanceof t.Delta.Composite?this.deltas[n.prop]:o)}}))}},function(t,e,n){"use strict";Object.defineProperties(e,{"default":{get:function(){return d}},__esModule:{value:!0}});var o,r,i,a,u=(o=n(1),o&&o.__esModule&&o||{"default":o})["default"],s=(r=n(3),r&&r.__esModule&&r||{"default":r}),l=s.WritableTarget,c=(s.ReadableTarget,s.rt,s.wt),f=(i=n(5),i&&i.__esModule&&i||{"default":i}).DeltaArgApplicationError,p=(a=n(7),a&&a.__esModule&&a||{"default":a})["default"],d=function(t){function e(t,e){return function(n,o){return n.type===t&&o.type===e}}function n(e,n){return"string"==typeof n&&(n=function(t){return function(e){return e[t]}}(n)),function(o,r){return new t.Delta[e](n&&n({d1:o,d2:r,p1:o.arg,p2:r.arg}))}}if(!u.isDefined(t._basicOperationsDefined)){t._basicOperationsDefined=!0,p(t);var o=t.newOperationType("NoOp");t.newComposition(function(t){return t instanceof o},function(t,e){return e.clone()}),t.newComposition(function(t,e){return e instanceof o},function(t){return t.clone()}),[["Add","add",function(t){return u.isUndefined(t.value)}],["Replace","replace",function(t){return u.isDefined(t.value)}]].forEach(function(e){var n=e,o=n[0],r=(n[1],n[2]);t.newOperationType(o,{construct:function(){this.deltasToApplyToArg=[]},precondition:function(t){return t instanceof l&&r(t)},applyTo:function(t){t.value=this.deltasToApplyToArg.reduce(function(t,e){return e.appliedTo(t)},this.arg)},clone:function(){var e=t.Delta.prototype.clone.call(this,this.arg,this.meta);return e.deltasToApplyToArg=this.deltasToApplyToArg.map(function(t){return t}),e},afterApplying:function(e){var n=this.clone();if(n.deltasToApplyToArg.push(e),n.deltasToApplyToArg.reduce(function(e,n){return t.composed(e,n)}).precondition(c(n,"arg"))!==!0)throw new f(e,this);return n},toString:function(e){var n=this,o=t.Delta.prototype.toString.call(this,e);if(Object.keys(this.deltasToApplyToArg).length>0){var r=Object.keys(this.deltasToApplyToArg).map(function(t){return n.deltasToApplyToArg[t].toString(e)}).join("\n");o+="\n"+u.indent(r,4)}return o}})}),t.newOperationType("Remove",{precondition:function(t){return t instanceof l&&u.isDefined(t.value)},applyTo:function(t){t["delete"]()}}),t.newOperationType("Forbid",{precondition:function(t){return u.isUndefined(t.value)}}),t.newComposition(e("Modify","Modify"),function(e,n){var o=e.clone();return Object.keys(n.deltas).forEach(function(e){o.deltas[e]=t.composed(o.deltas[e],n.deltas[e])}),o}),t.newComposition(e("Add","Modify"),function(t,e){return t.afterApplying(e)}),t.newComposition(e("Modify","Remove"),n("Remove")),t.newComposition(e("Add","Remove"),n("Forbid")),t.newComposition(e("Remove","Add"),n("Replace",function(t){var e=t.p2;return e})),t.newComposition(e("Remove","Forbid"),n("Remove")),t.newComposition(e("Forbid","Add"),n("Add",function(t){var e=t.p2;return e})),t.newComposition(e("Forbid","Forbid"),n("Forbid")),t.newComposition(e("Modify","Replace"),n("Replace",function(t){var e=t.p2;return e})),t.newComposition(e("Add","Replace"),n("Add",function(t){var e=t.p2;return e})),t.newComposition(e("Replace","Modify"),function(t,e){return t.afterApplying(e)}),t.newComposition(e("Replace","Remove"),n("Remove")),t.newComposition(e("Replace","Replace"),n("Replace",function(t){var e=t.p2;return e}))}}},function(t,e,n){"use strict";Object.defineProperties(e,{"default":{get:function(){return c}},__esModule:{value:!0}});var o,r,i,a,u=(o=n(1),o&&o.__esModule&&o||{"default":o})["default"],s=(r=n(3),r&&r.__esModule&&r||{"default":r}),l=(s.WritableTarget,s.ReadableTarget,s.rt,s.wt,(i=n(5),i&&i.__esModule&&i||{"default":i}).DeltaArgApplicationError,(a=n(11),a&&a.__esModule&&a||{"default":a})["default"]),c=function(t){function e(t,e){return function(n,o){return n.type===t&&o.type===e}}function n(e,n){return"string"==typeof n&&(n=function(t){return function(e){return e[t]}}(n)),function(o,r){return new t.Delta[e](n&&n({d1:o,d2:r,p1:o.arg,p2:r.arg}))}}u.isDefined(t.Delta.PutIntoArray)||(l(t),t.newOperationType("PutIntoArray",{construct:function(){this.values=this.meta.method?[{method:this.meta.method,value:this.arg}]:[]},clone:function(){var e=t.Delta.prototype.clone.call(this,this.arg,this.meta);return e.values=[],this.values.forEach(function(t){e.values.push(t)}),e},precondition:function(t){return u.isDefined(t.value)&&Array.isArray(t.value)},applyTo:function(t){var e=t.value;this.values.forEach(function(t){var n=t,o=n.method,r=n.value;switch(o){case"prepend":e.unshift(r);break;case"insert":var i=Math.floor(Math.random()*(e.length+1));e.splice(i,0,r);break;case"append":e.push(r)}})},methods:["prepend","insert","append"]}),t.newComposition(e("Add","PutIntoArray"),function(t,e){return t.afterApplying(e)}),t.newComposition(e("Replace","PutIntoArray"),function(t,e){return t.afterApplying(e)}),t.newComposition(e("PutIntoArray","Remove"),n("Remove")),t.newComposition(e("PutIntoArray","Replace"),n("Replace",function(t){var e=t.p2;return e})),t.newComposition(e("PutIntoArray","PutIntoArray"),function(e,n){var o=new t.Delta.PutIntoArray;return o.values=e.values.concat(n.values),o}))}},function(t,e,n){"use strict";Object.defineProperties(e,{"default":{get:function(){return l}},__esModule:{value:!0}});var o,r,i,a=(o=n(1),o&&o.__esModule&&o||{"default":o})["default"],u=(r=n(3),r&&r.__esModule&&r||{"default":r}).WritableTarget,s=(i=n(11),i&&i.__esModule&&i||{"default":i})["default"],l=function(t){function e(t,e){return function(n,o){return n.type===t&&o.type===e}}function n(e,n){return"string"==typeof n&&(n=function(t){return function(e){return e[t]}}(n)),function(o,r){return new t.Delta[e](n&&n({d1:o,d2:r,p1:o.arg,p2:r.arg}))}}a.isDefined(t.Delta.PutIntoFunction)||(s(t),t.newOperationType("PutIntoFunction",{construct:function(){this.values=this.meta.method?[{method:this.meta.method,value:this.arg}]:[]},clone:function(){var e=t.Delta.prototype.clone.call(this,this.arg,this.meta);return e.values=[],this.values.forEach(function(t){e.values.push(t)}),e},precondition:function(t){return a.isDefined(t.value)&&"function"==typeof t.value&&(a.isDefined(t.value._DeltaJs_functions)||t instanceof u)},applyTo:function(t){if(a.isUndefined(t.value._DeltaJs_functions)){var e=t.value,n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var o,r=this;return n._DeltaJs_functions.forEach(function(e){o=e.apply(r,t)}),o};n._DeltaJs_functions=[function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.apply(this,t)}],t.value=n}var o=t.value._DeltaJs_functions;this.values.forEach(function(t){var e=t,n=e.method,r=e.value;switch(n){case"prepend":o.unshift(r);break;case"insert":var i=Math.floor(Math.random()*(o.length+1));o.splice(i,0,r);break;case"append":o.push(r)}})},methods:["prepend","insert","append"]}),t.newComposition(e("Add","PutIntoFunction"),function(t,e){return t.afterApplying(e)}),t.newComposition(e("Replace","PutIntoFunction"),function(t,e){return t.afterApplying(e)}),t.newComposition(e("PutIntoFunction","Remove"),n("Remove")),t.newComposition(e("PutIntoFunction","Replace"),n("Replace",function(t){var e=t.p2;return e})),t.newComposition(e("PutIntoFunction","PutIntoFunction"),function(e,n){var o=new t.Delta.PutIntoFunction;return o.values=e.values.concat(n.values),o}))}},function(t,e,n){"use strict";Object.defineProperties(e,{"default":{get:function(){return f}},__esModule:{value:!0}});var o,r,i,a,u=(o=n(6),o&&o.__esModule&&o||{"default":o})["default"],s=(r=n(1),r&&r.__esModule&&r||{"default":r})["default"],l=(i=n(4),i&&i.__esModule&&i||{"default":i})["default"],c=(a=n(8),a&&a.__esModule&&a||{"default":a})["default"],f=function(t){if(!s.isDefined(t.Delta.DeltaModel)){c(t);var e=t.newOperationType(t.Delta.Composite,"DeltaModel",{construct:function(){this.graph=new u},clone:function(){var t=new e;return t.graph=this.graph.clone(),t.graph.eachVertex(function(e,n){t.graph.setVertex(e,n.clone())}),t},applyTo:function(t){this.graph.topologically(function(e,n){n.applyTo(t)})},operation:function(e,n,o,r,i){var a;"string"==typeof o&&(a=[{},o,r],o=a[0],r=a[1],i=a[2],a);var u=t._getDeltaByMethod(e,i);return this._addOperation(n,o,new l(r),u)},toString:function(e){var n=t.Delta.prototype.toString.call(this,e);if(this.graph.vertexCount()>0){var o="";this.graph.topologically(function(t,n){o+="["+t+"] "+n.toString(e)+"\n"}),n+="\n"+s.indent(o,4)}return n},_addOperation:function(e,n,o,r){var i=this,a=n.before,u=r;return o.prop&&(u=new t.Delta.Modify,u._addOperation(n,o,r)),s.assert(!this.graph.vertexValue(e),"A delta by the name “"+e+"” is already in this delta model."),this.graph.addVertex(e,u),(a||[]).forEach(function(t){i.graph.createEdge(t,e)}),r}});t.newComposition(function(t,n){return t instanceof e||n instanceof e},function(t,n){var o=new e;return o.graph.addNewVertex(1,t),o.graph.addNewVertex(2,n),o.graph.addNewEdge(1,2),o})}}},function(t,e,n){"use strict";Object.defineProperties(e,{"default":{get:function(){return i}},__esModule:{value:!0}});var o,r=(o=n(1),o&&o.__esModule&&o||{"default":o})["default"],i=function(t){function e(t,e){a=!0,e===!0?i[t]=!0:e===!1||o[t]!==!0&&r.a(o,t).push(e)}function n(){if(a){a=!1;var e;do e=!1,Object.keys(t.features).forEach(function(t){i[t]||r.isUndefined(o[t])||o[t].some(function(t){return t.every(function(t){return i[t]})})&&(i[t]=!0,e=!0)});while(e)}}if(!t._featuresImplemented){t._featuresImplemented=!0;var o={},i={},a=!1;t.Feature=r.newClass(function(t){var n=void 0!==arguments[1]?arguments[1]:{};this.name=t,this.options=n,e(t,this["if"]),this.selects.forEach(function(n){e(n,[t])})},{select:function(){e(this.name,!0)},get selected(){return n(),i[this.name]},get if(){return this.options?this.options["if"]===!0||this.options["if"]===!1?this.options["if"]:this.options["if"]||this.options.iff?[].concat(this.options["if"]||[],this.options.iff||[]):!1:void 0},get onlyIf(){return this.options?this.options.onlyIf===!0||this.options.onlyIf===!1?this.options.onlyIf:this.options.onlyIf||this.options.iff||this.options.expects?[].concat(this.options.onlyIf||[],this.options.iff||[],this.options.expects||[]):!0:void 0},get selects(){return this.options?this.options.selects||[]:void 0}}),t.features={},r.isDefined(t.constructor._featuresImplemented)||(t.constructor._featuresImplemented=!0,r.extend(t.constructor.prototype,{newFeature:function(t){var e=void 0!==arguments[1]?arguments[1]:{};return r.assert(r.isUndefined(this.features[t]),"A feature with the name '"+t+"' already exists."),this.features[t]=new this.Feature(t,e)}}))}}}])});