!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("js-graph")):"function"==typeof define&&define.amd?define(["js-graph"],e):"object"==typeof exports?exports.DeltaJs=e(require("js-graph")):t.DeltaJs=e(t.JsGraph)}(this,function(t){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},o=n(1).extend,i=r(n(2)),a=n(3),u=a.ReadableTarget,s=a.WritableTarget;o(i,{ReadableTarget:u,WritableTarget:s});var c=r(n(4));o(i,{Path:c});var l=n(5),f=l.ApplicationError,p=l.PreconditionFailure,h=l.MultipleOverloadsApplicationError,d=l.NoOverloadsApplicationError,v=l.CompositionError,y=l.MultipleOverloadsCompositionError,g=l.ConstraintFailure,b=l.ApplicationOrderCycle,m=l.UnresolvedDeltaConflict,w=l.MultipleActiveProxiesError;o(i,{ApplicationError:f,PreconditionFailure:p,MultipleOverloadsApplicationError:h,NoOverloadsApplicationError:d,CompositionError:v,MultipleOverloadsCompositionError:y,ConstraintFailure:g,ApplicationOrderCycle:b,UnresolvedDeltaConflict:m,MultipleActiveProxiesError:w}),t.exports=i},function(t,e){"use strict";function n(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;e>r;r++)n[r-1]=arguments[r];return n.forEach(function(e){for(var n in e)e.hasOwnProperty(n)&&Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}),t}function r(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;e>r;r++)n[r-1]=arguments[r];var i=n.slice(0,-1),a=n[n.length-1];if(0===i.length)return t;var s=o.apply(void 0,[t].concat(b(i.slice(0,-1))));return u(s[i[i.length-1]])&&(s[i[i.length-1]]=a),s[i[i.length-1]]}function o(t){for(var e=arguments.length,n=Array(e>1?e-1:0),o=1;e>o;o++)n[o-1]=arguments[o];return r.apply(void 0,[t].concat(n,[{}]))}function i(t){for(var e=arguments.length,n=Array(e>1?e-1:0),o=1;e>o;o++)n[o-1]=arguments[o];return r.apply(void 0,[t].concat(n,[[]]))}function a(t,e){if(!t)throw new Error(e||"Assertion failed")}function u(t){return"undefined"==typeof t}function s(t){return"undefined"!=typeof t}function c(t,e){return new Array(t+1).join(e)}function l(t,e){var n=void 0===arguments[2]?" ":arguments[2];return t.replace(/^(?!\s*$)/gm,c(e,n))}function f(t,e,n){var r=function(t){var r="_once per: "+e;if(!t[r])return t[r]=!0,n.call(t,t)};if("string"==typeof t){var o=[t,e],i=g(o,2);return e=i[0],n=i[1],r}return r(t)}function p(t,e){for(var n=void 0===arguments[2]?function(t,e){return t===e}:arguments[2],r=0;r<t.length;++r)if(n(t[r],e))return r;return-1}function h(t,e){var n=void 0===arguments[2]?function(t,e){return t===e}:arguments[2];if(t.length!==e.length)return!1;for(var r=0;r<t.length;++r)if(!n(t[r],e[r]))return!1;return!0}function d(t,e){var n=void 0===arguments[2]?function(t,e){return t===e}:arguments[2];if(t.length!==e.length)return!1;for(var r=[].concat(b(e)),o=0;o<t.length;++o){for(var i=!1,a=0;a<r.length;++a)if(n(t[o],r[a])){r.splice(a,1),i=!0;break}if(!i)return!1}return!0}function v(t,e){var n=void 0===arguments[2]?function(t,e){return t===e}:arguments[2],r=Object.keys(t),o=Object.keys(e);if(r.length!==o.length)return!1;r.sort(),o.sort();for(var i=0;i<r.length;++i){if(r[i]!==o[i])return!1;if(!n(t[r[i]],e[o[i]]))return!1}return!0}function y(t,e){return Object.keys(function r(e){return n.apply(void 0,[m({},e,!0)].concat(b(t.successors(e).map(function(t){return r(t)}))))}(e))}var g=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t)){for(var n,r=[],o=t[Symbol.iterator]();!(n=o.next()).done&&(r.push(n.value),!e||r.length!==e););return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},b=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},m=function(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0})};e.extend=n,e.o=o,e.a=i,e.assert=a,e.isUndefined=u,e.isDefined=s,e.repeat=c,e.indent=l,e.oncePer=f,e.customIndexOf=p,e.arraysEqual=h,e.arraysHaveSameElements=d,e.objectsEqual=v,e.graphDescendants=y;e.t=function(t,e){return function(n,r){return n.type===t&&r.type===e}},e.define_d=function(t){return function(e,n){return"string"==typeof n&&(n=function(t){return function(e){return e[t]}}(n)),function(r,o){return new t.Delta[e](n&&n({d1:r,d2:o,p1:r.arg,p2:o.arg}))}}};Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},o=function(t,e){var n=Object.create(t.prototype),r=t.apply(n,e);return null==r||"object"!=typeof r&&"function"!=typeof r?n:r},i=function(t,e,n){e&&Object.defineProperties(t,e),n&&Object.defineProperties(t.prototype,n)},a=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},u=(r(n(6)),n(1)),s=u.extend,c=u.assert,l=u.isUndefined,f=u.isDefined,p=u.arraysEqual,h=(r(n(4)),n(3)),d=(h.ReadableTarget,h.WritableTarget,h.rt,h.wt,r(n(7))),v=r(n(8)),y=r(n(9)),g=r(n(10)),b=r(n(11)),m=r(n(12)),w=r(n(13)),O=r(n(14)),P=r(n(15)),_=r(n(16)),C=r(n(17)),A=function(){function t(){a(this,t),C(this),d(this),v(this),y(this),g(this),b(this),m(this),w(this),O(this),P(this),_(this)}return i(t,null,{newOperationType:{value:function(e,n,r){var i=this;c(e[0]===e[0].toUpperCase(),"Delta operation classes must have a name starting with a capital letter - '"+e+"' does not."),c(l(this.Delta[e]),"The '"+e+"' operation type already exists."),this.Delta[e]=n,n.Proxy=r;var a=n.prototype.applyTo||function(){},u=n.prototype.refines,h=n.prototype.equals,d=n.prototype.commutesWith,v=n.prototype.resolves;s(n.prototype,{applyTo:function(e){var n=void 0===arguments[1]?{}:arguments[1];if(this.selected){e instanceof t.ReadableTarget||(e=new t.ReadableTarget(e));var r=this.evaluatePrecondition(e);if(r!==!0)throw r;a.call(this,e,n)}},refines:function(t){return this.type!==t.type?!1:f(u)?u.call(this,t):this.equals(t)},equals:function(t){return this.type!==t.type?!1:f(h)?h.call(this,t):f(u)?this.refines(t)&&t.refines(this):p(this.args,t.args)},commutesWith:function(t){return f(d)?d.call(this,t):this.composedWith(t).equals(t.composedWith(this))},resolves:function(t,e){return f(v)?v.call(this,t,e):t.composedWith(e).composedWith(this).equals(e.composedWith(t).composedWith(this))},type:e});var y=e[0].toLowerCase()+e.slice(1);return(n.prototype.methods||[y]).forEach(function(t){i.ContainerProxy.newProxyMethod(t,function(){for(var t=arguments.length,e=Array(t),r=0;t>r;r++)e[r]=arguments[r];return o(n,e)})}),n},writable:!0,configurable:!0},newProxyMethod:{value:function(t,e){this.ContainerProxy.newProxyMethod(t,e)},writable:!0,configurable:!0}}),t}();t.exports=A},function(t,e){"use strict";function n(t,e){return new c(t,e)}function r(t,e){return new s(t,e)}var o=function l(t,e,n){var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:l(o,e,n)}if("value"in r&&r.writable)return r.value;var i=r.get;return void 0===i?void 0:i.call(n)},i=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},a=function(t,e,n){e&&Object.defineProperties(t,e),n&&Object.defineProperties(t.prototype,n)},u=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};e.wt=n,e.rt=r;var s=e.ReadableTarget=function(){function t(e){u(this,t),this._val=e}return a(t,null,{getValue:{value:function(){return this._val},writable:!0,configurable:!0},value:{get:function(){return this.getValue()},set:function(t){this.setValue(t)},configurable:!0}}),t}(),c=e.WritableTarget=function(t){function e(t,n){u(this,e),o(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this._obj=t,this._prop=n}return i(e,t),a(e,null,{getValue:{value:function(){return this._obj[this._prop]},writable:!0,configurable:!0},setValue:{value:function(t){this._obj[this._prop]=t},writable:!0,configurable:!0},"delete":{value:function(){delete this._obj[this._prop]},writable:!0,configurable:!0}}),e}(s);Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";var r=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t)){for(var n,r=[],o=t[Symbol.iterator]();!(n=o.next()).done&&(r.push(n.value),!e||r.length!==e););return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(t,e,n){e&&Object.defineProperties(t,e),n&&Object.defineProperties(t.prototype,n)},i=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},a=n(1),u=a.assert,s=a.isDefined,c=function(){function t(){var e=void 0===arguments[0]?"":arguments[0];i(this,t);var n=e.match(/^([.#]?)(\w*|\(\w+\))(.*)$/);u(n,"The path string '"+e+"' is not well formed.");var o=r(n,4),a=o[1],s=o[2],c=o[3];"#"===a?this.set(new t(".(instance)."+s+c)):""!==s&&(this._prop=s,""!==c&&(this._rest=new t(c)))}return o(t,null,{set:{value:function(t){this._prop=t._prop,this._rest=t._rest},writable:!0,configurable:!0},prop:{get:function(){return this._prop},configurable:!0},rest:{get:function(){return this._rest},configurable:!0},toString:{value:function(){var t="";return s(this.prop)&&(t+=this.prop,s(this.rest)&&(t+="."+this.rest.toString())),t},writable:!0,configurable:!0}}),t}();t.exports=c},function(t,e){"use strict";{var n=function s(t,e,n){var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:s(o,e,n)}if("value"in r&&r.writable)return r.value;var i=r.get;return void 0===i?void 0:i.call(n)},r=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=e.ApplicationError=function(t){function e(){o(this,e),null!=t&&t.apply(this,arguments)}return r(e,t),e}(Error),a=e.PreconditionFailure=function(t){function e(t,r){o(this,e),n(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.name="PreconditionFailure",this.message="This delta of type '"+t.type+"' cannot apply to this value of type '"+typeof r+"'.",this.delta=t,this.value=r}return r(e,t),e}(i),u=(e.MultipleOverloadsApplicationError=function(t){function e(t,r){var i=void 0===arguments[2]?[]:arguments[2];o(this,e),n(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t,r),this.name="MultipleOverloadsApplicationError",this.message="None of the delta-types "+t.overloads.map(function(t){return"'"+t.type+"'"}).join(",")+" can apply to this value of type '"+typeof r+"'."+i.map(function(t){return"\n-- "+t.message}).join(""),this.errors=i}return r(e,t),e}(a),e.NoOverloadsApplicationError=function(t){function e(t,r){o(this,e),n(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t,r),this.name="NoOverloadsApplicationError",this.message="This delta of type '"+t.type+"' has no specific deltas assigned to it, so it cannot apply to this value of type '"+typeof r+"."}return r(e,t),e}(a),e.CompositionError=function(t){function e(t,r){o(this,e),n(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.name="CompositionError",this.message="This delta of type '"+t.type+"' cannot be composed with this other delta of type '"+r.type+"'.",this.delta1=t,this.delta2=r}return r(e,t),e}(Error));e.MultipleOverloadsCompositionError=function(t){function e(t,r){var i=void 0===arguments[2]?[]:arguments[2];o(this,e),n(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t,r),this.name="MultipleOverloadsCompositionError",this.message="There are no overloads to compose this delta of type '"+t.type+"' with this other delta of type '"+r.type+"'."+i.map(function(t){return"\n-- "+t.message}).join(""),this.errors=i}return r(e,t),e}(u),e.ConstraintFailure=function(t){function e(t){o(this,e),n(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.name="ConstraintFailure",this.message="The feature '"+t.name+"' is both selected and excluded by its constraints.",this.feature=t}return r(e,t),e}(Error),e.ApplicationOrderCycle=function(t){function e(t,r){o(this,e),n(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.name="ApplicationOrderCycle",this.message="The new application order between "+t+" and "+r+" created a cycle.",this.from=t,this.to=r}return r(e,t),e}(Error),e.UnresolvedDeltaConflict=function(t){function e(t){o(this,e),n(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.name="UnresolvedDeltaConflict";var r=t.slice(0,-1).map(function(t){return"'"+t+"'"}).join(",");this.message="There is an unresolved conflict between deltas "+r+" and '"+t[t.length-1]+"'.",this.deltaNames=t}return r(e,t),e}(i),e.MultipleActiveProxiesError=function(t){function e(){o(this,e),n(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.name="MultipleActiveProxiesError",this.message="Only one Proxy per path can be active at any given time."}return r(e,t),e}(Error)}Object.defineProperty(e,"__esModule",{value:!0})},function(e){e.exports=t},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},o=function(t,e,n){e&&Object.defineProperties(t,e),n&&Object.defineProperties(t.prototype,n)},i=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},a=n(1),u=a.extend,s=a.oncePer,c=n(3),l=c.ReadableTarget,f=c.wt,p=n(5),h=p.PreconditionFailure,d=p.CompositionError,v=r(n(18));t.exports=s("Delta",function(t){s(t.constructor,"Delta",function(){u(t.constructor.prototype,{newComposition:function(t,e){this.Delta.newComposition(t,e)}})}),t.Delta=function(){function e(){for(var n=arguments.length,r=Array(n),o=0;n>o;o++)r[o]=arguments[o];i(this,e),this.id=++t.Delta._nextID,this.args=r}return o(e,{newComposition:{value:function(e,n){t.Delta._compositions.push({precondition:e,compose:n})},writable:!0,configurable:!0},composed:{value:function(){for(var n=arguments.length,r=Array(n),o=0;n>o;o++)r[o]=arguments[o];var i=new t.Delta.NoOp;return r.forEach(function(n){var r=i,o=n||new t.Delta.NoOp,a=function(){},u=e._compositions.some(function(t){var e=t.precondition,n=t.compose;return e(r,o)?(a=n,!0):void 0});if(a===!1||!u)throw new d(r,o);a===!0&&(a=function(e,n){return new t.Delta.Composed([e,n])}),i=a(r,o)}),i},writable:!0,configurable:!0}},{arg:{get:function(){return this.args[0]},set:function(t){this.args[0]=t},configurable:!0},clone:{value:function(){return new this.constructor(this.arg)},writable:!0,configurable:!0},evaluatePrecondition:{value:function(t){if(this.precondition){var e=this.precondition(t);if(e instanceof h)return e;if(!e)return new h(this,t.value)}return!0},writable:!0,configurable:!0},appliedTo:{value:function(t){var e=void 0===arguments[1]?{}:arguments[1];t instanceof l&&(t=t.value),"function"==typeof t.clone&&(t=t.clone());var n={value:t};return this.applyTo(f(n,"value"),e),n.value},writable:!0,configurable:!0},composedWith:{value:function(e){return t.Delta.composed(this,e)},writable:!0,configurable:!0},toString:{value:function(){var t=void 0===arguments[0]?{}:arguments[0],e=this.type;return t.targetProp&&(e+=" ‹"+t.targetProp+"›"),this.args.length>0&&(e+=": "+this.args.map(function(t){return JSON.stringify(t)}).join(",")),t.debug&&(e+=" ("+this.id+")"),e},writable:!0,configurable:!0}}),e}(),t.Delta._nextID=0,t.Delta._compositions=[],v(t)})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},o=function(t,e,n){e&&Object.defineProperties(t,e),n&&Object.defineProperties(t.prototype,n)},i=function g(t,e,n){var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:g(o,e,n)}if("value"in r&&r.writable)return r.value;var i=r.get;return void 0===i?void 0:i.call(n)},a=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},u=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},s=r(n(7)),c=n(1),l=c.indent,f=c.oncePer,p=c.arraysEqual,h=n(5),d=h.MultipleOverloadsApplicationError,v=h.NoOverloadsApplicationError,y=h.MultipleOverloadsCompositionError;t.exports=f("Overloaded",function(t){s(t),t.newOperationType("Overloaded",function(t){function e(){for(var t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];u(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,n),this.overloads=this.arg||[]}return a(e,t),o(e,null,{clone:{value:function(){var t=i(Object.getPrototypeOf(e.prototype),"clone",this).call(this);return t.overloads=this.overloads.map(function(t){return t.clone()}),t},writable:!0,configurable:!0},equals:{value:function(t){return p(this.overloads,t.overloads,function(t,e){return t.equals(e)})},writable:!0,configurable:!0},applyTo:{value:function(t){var e=void 0===arguments[1]?{}:arguments[1],n=[],r=this.overloads.some(function(r){var o=r.evaluatePrecondition(t);return o!==!0?(n.push(o),!1):(r.applyTo(t,e),!0)});if(!r)throw 0===n.length?new v(this,t.value):1===n.length?n[0]:new d(this,t.value,n)},writable:!0,configurable:!0},toString:{value:function(){var t=void 0===arguments[0]?{}:arguments[0],n=i(Object.getPrototypeOf(e.prototype),"toString",this).call(this,t),r=this.overloads.map(function(e){return e.toString(t)}).join("\n");return n+="\n"+l(r,4)},writable:!0,configurable:!0}}),e}(t.Delta)),t.newComposition(function(e,n){return e instanceof t.Delta.Overloaded||n instanceof t.Delta.Overloaded},function(e,n){var r=e instanceof t.Delta.Overloaded?e.overloads:[e],o=n instanceof t.Delta.Overloaded?n.overloads:[n],i=new t.Delta.Overloaded,a=[];if(r.forEach(function(t){o.forEach(function(e){try{i.overloads.push(t.composedWith(e))}catch(n){a.push(n)}})}),0===i.overloads.length)throw new y(e,n,a);return i})})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},o=function(t,e,n){e&&Object.defineProperties(t,e),n&&Object.defineProperties(t.prototype,n)},i=function y(t,e,n){var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:y(o,e,n)}if("value"in r&&r.writable)return r.value;var i=r.get;return void 0===i?void 0:i.call(n)},a=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},u=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},s=n(1),c=s.extend,l=s.indent,f=s.t,p=s.oncePer,h=s.objectsEqual,d=(r(n(4)),n(3).wt),v=r(n(17));t.exports=p("Modify",function(t){v(t),t.newOperationType("Modify",function(t){function e(){for(var t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];u(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,n),this.subDeltas={},c(this.subDeltas,this.arg||{})}return a(e,t),o(e,null,{clone:{value:function(){var t=this,n=i(Object.getPrototypeOf(e.prototype),"clone",this).call(this);return Object.keys(this.subDeltas).forEach(function(e){n.subDeltas[e]=t.subDeltas[e].clone()}),n},writable:!0,configurable:!0},equals:{value:function(t){return h(this.subDeltas,t.subDeltas,function(t,e){return t.equals(e)})},writable:!0,configurable:!0},precondition:{value:function(t){return t.value instanceof Object},writable:!0,configurable:!0},applyTo:{value:function(t){var e=this,n=void 0===arguments[1]?{}:arguments[1];Object.keys(this.subDeltas).forEach(function(r){n.restrictToProperty&&n.restrictToProperty!==r||e.subDeltas[r].applyTo(d(t.value,r),c({},n,{restrictToProperty:null}))})},writable:!0,configurable:!0},toString:{value:function(){var t=this,n=void 0===arguments[0]?{}:arguments[0],r=i(Object.getPrototypeOf(e.prototype),"toString",this).call(this,n);if(Object.keys(this.subDeltas).length>0){var o=Object.keys(this.subDeltas).map(function(e){return t.subDeltas[e].toString(c({},n,{targetProp:e}))}).join("\n");r+="\n"+l(o,4)}return r},writable:!0,configurable:!0}}),e}(t.Delta),function(e){function n(){u(this,n),null!=e&&e.apply(this,arguments)}return a(n,e),o(n,null,{processProxyArguments:{value:function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];var r={};do{if(0===e.length)throw new Error("The argument list for this Modify.Proxy method is insufficient.");var o=e.shift();"string"==typeof o?r.path=o:c(r,o)}while(!r.path);return{options:r,args:e}},writable:!0,configurable:!0},addOperation:{value:function(e,n){var r=n.path;if(!r.prop)throw new Error("Operations on a Modify.Proxy need to have a non-empty path.");var o;if(r.rest){var i=c({},n,{path:r.rest}),a=this.addChildProxy(r.prop,new t.Delta.Modify);o=a.addOperation(e,i)}else o=this.addChildProxy(r.prop,e);return o},writable:!0,configurable:!0},delta:{value:function(){var t=this,e=i(Object.getPrototypeOf(n.prototype),"delta",this).call(this);return e.subDeltas={},this.childKeys().forEach(function(n){e.subDeltas[n]=t.childDelta(n)}),e},writable:!0,configurable:!0}}),n}(t.ContainerProxy)),t.newComposition(f("Modify","Modify"),function(e,n){var r=e.clone();return Object.keys(n.subDeltas).forEach(function(e){r.subDeltas[e]=t.Delta.composed(r.subDeltas[e],n.subDeltas[e])}),r})})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},o=function(t,e,n){e&&Object.defineProperties(t,e),n&&Object.defineProperties(t.prototype,n)},i=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},a=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},u=n(1),s=u.isUndefined,c=u.isDefined,l=u.t,f=u.define_d,p=u.oncePer,h=n(3),d=h.WritableTarget,v=(h.ReadableTarget,h.rt,h.wt,r(n(7))),y=r(n(9));t.exports=p("basic operations",function(t){v(t),y(t),t.newOperationType("NoOp",function(t){function e(){a(this,e),null!=t&&t.apply(this,arguments)}return i(e,t),e}(t.Delta)),t.newOperationType("Add",function(t){function e(){a(this,e),null!=t&&t.apply(this,arguments)}return i(e,t),o(e,null,{precondition:{value:function(t){return t instanceof d&&s(t.value)},writable:!0,configurable:!0},applyTo:{value:function(t){t.value=this.arg},writable:!0,configurable:!0}}),e}(t.Delta)),t.newOperationType("Remove",function(t){function e(){a(this,e),null!=t&&t.apply(this,arguments)}return i(e,t),o(e,null,{precondition:{value:function(t){return t instanceof d&&c(t.value)},writable:!0,configurable:!0},applyTo:{value:function(t){t["delete"]()},writable:!0,configurable:!0}}),e}(t.Delta)),t.newOperationType("Forbid",function(t){function e(){a(this,e),null!=t&&t.apply(this,arguments)}return i(e,t),o(e,null,{precondition:{value:function(t){return s(t.value)},writable:!0,configurable:!0}}),e}(t.Delta)),t.newOperationType("Replace",function(t){function e(){a(this,e),null!=t&&t.apply(this,arguments)}return i(e,t),o(e,null,{precondition:{value:function(t){return t instanceof d&&c(t.value)},writable:!0,configurable:!0},applyTo:{value:function(t){t.value=this.arg},writable:!0,configurable:!0}}),e}(t.Delta)),t.newOperationType("Update",function(t){function e(){a(this,e),null!=t&&t.apply(this,arguments)}return i(e,t),o(e,null,{precondition:{value:function(t){return t instanceof d&&c(t.value)},writable:!0,configurable:!0},applyTo:{value:function(t){t.value=this.arg(t.value)},writable:!0,configurable:!0}}),e}(t.Delta)),t.newComposition(function(e){return e instanceof t.Delta.NoOp},function(t,e){return e.clone()}),t.newComposition(function(e,n){return n instanceof t.Delta.NoOp},function(t){return t.clone()});var e=f(t);t.newComposition(l("Add","Modify"),e("Add",function(t){var e=t.d2,n=t.p1;return e.appliedTo(n)})),t.newComposition(l("Modify","Add"),!1),t.newComposition(l("Add","Add"),!1),t.newComposition(l("Modify","Remove"),e("Remove")),t.newComposition(l("Add","Remove"),e("Forbid")),t.newComposition(l("Remove","Modify"),!1),t.newComposition(l("Remove","Add"),e("Replace",function(t){var e=t.p2;return e})),t.newComposition(l("Remove","Remove"),!1),t.newComposition(l("Modify","Forbid"),!1),t.newComposition(l("Add","Forbid"),!1),t.newComposition(l("Remove","Forbid"),e("Remove")),t.newComposition(l("Forbid","Modify"),!1),t.newComposition(l("Forbid","Add"),e("Add",function(t){var e=t.p2;return e})),t.newComposition(l("Forbid","Remove"),!1),t.newComposition(l("Forbid","Forbid"),e("Forbid")),t.newComposition(l("Modify","Replace"),e("Replace",function(t){var e=t.p2;return e})),t.newComposition(l("Add","Replace"),e("Add",function(t){var e=t.p2;return e})),t.newComposition(l("Remove","Replace"),!1),t.newComposition(l("Forbid","Replace"),!1),t.newComposition(l("Replace","Modify"),e("Replace",function(t){var e=t.d2,n=t.p1;return e.appliedTo(n)})),t.newComposition(l("Replace","Add"),!1),t.newComposition(l("Replace","Remove"),e("Remove")),t.newComposition(l("Replace","Forbid"),!1),t.newComposition(l("Replace","Replace"),e("Replace",function(t){var e=t.p2;return e})),t.newComposition(l("Modify","Update"),!0),t.newComposition(l("Add","Update"),e("Add",function(t){var e=t.d2,n=t.p1;return e.appliedTo(n)})),t.newComposition(l("Remove","Update"),!0),t.newComposition(l("Forbid","Update"),!0),t.newComposition(l("Replace","Update"),e("Replace",function(t){var e=t.d2,n=t.p1;return e.appliedTo(n)})),t.newComposition(l("Update","Modify"),!0),t.newComposition(l("Update","Add"),!0),t.newComposition(l("Update","Remove"),e("Remove")),t.newComposition(l("Update","Forbid"),!0),t.newComposition(l("Update","Replace"),e("Replace",function(t){var e=t.p2;return e})),t.newComposition(l("Update","Update"),e("Update",function(t){var e=t.p1,n=t.p2;return function(t){return n(e(t))}}))})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},o=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},i=function(t,e,n){e&&Object.defineProperties(t,e),n&&Object.defineProperties(t.prototype,n)},a=function w(t,e,n){var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:w(o,e,n)}if("value"in r&&r.writable)return r.value;var i=r.get;return void 0===i?void 0:i.call(n)},u=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},s=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},c=n(1),l=c.isDefined,f=c.t,p=c.define_d,h=c.oncePer,d=c.arraysEqual,v=c.arraysHaveSameElements,y=c.customIndexOf,g=r(n(9)),b=r(n(10)),m=r(n(19));t.exports=h("PutIntoArray",function(t){g(t),b(t),m(t),t.newOperationType("PutIntoArray",function(t){function e(){for(var t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];s(this,e),a(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,n),this.values=this.arg?Array.isArray(this.arg)?this.arg:[this.arg]:[]}return u(e,t),i(e,null,{clone:{value:function(){var t=a(Object.getPrototypeOf(e.prototype),"clone",this).call(this);return t.values=[].concat(o(this.values)),t},writable:!0,configurable:!0},refines:{value:function(t){var e=function(t,e){return t.method===e.method&&t.value===e.value};if(!v(this.values,t.values,e))return!1;if(!d(this.values.filter(function(t){return"append"===t.method}),t.values.filter(function(t){return"append"===t.method}),e))return!1;if(!d(this.values.filter(function(t){return"prepend"===t.method}),t.values.filter(function(t){return"prepend"===t.method}),e))return!1;for(var n=[],r=0;r<this.values.length;++r)if("insert"===this.values[r].method){for(var o=y(t.values,this.values[r],e),i=[].concat(n),a=0;o>=a;++a){var u=y(i,t.values[a],e);u>-1&&i.splice(u,1)}if(i.length>0)return!1}else n.push(this.values[r]);return!0},writable:!0,configurable:!0},precondition:{value:function(t){return l(t.value)&&Array.isArray(t.value)},writable:!0,configurable:!0},applyTo:{value:function(t){var e=t.value;this.values.forEach(function(t){var n=t.method,r=t.value;switch(n){case"prepend":e.unshift(r);break;case"insert":var o=Math.floor(Math.random()*(e.length+1));e.splice(o,0,r);break;case"append":e.push(r)}})},writable:!0,configurable:!0},methods:{get:function(){return[]},configurable:!0}}),e}(t.Delta)),t.newProxyMethod("prepend",function(e){return new t.Delta.PutIntoArray({method:"prepend",value:e})}),t.newProxyMethod("insert",function(e){return new t.Delta.PutIntoArray({method:"insert",value:e})}),t.newProxyMethod("append",function(e){return new t.Delta.PutIntoArray({method:"append",value:e})});var e=p(t);t.newComposition(f("Modify","PutIntoArray"),!1),t.newComposition(f("Add","PutIntoArray"),e("Add",function(t){var e=t.d2,n=t.p1;return e.appliedTo(n)})),t.newComposition(f("Remove","PutIntoArray"),!1),t.newComposition(f("Forbid","PutIntoArray"),!1),t.newComposition(f("Replace","PutIntoArray"),e("Replace",function(t){var e=t.d2,n=t.p1;return e.appliedTo(n)})),t.newComposition(f("Update","PutIntoArray"),!0),t.newComposition(f("PutIntoArray","Modify"),!1),t.newComposition(f("PutIntoArray","Add"),!1),t.newComposition(f("PutIntoArray","Remove"),e("Remove")),t.newComposition(f("PutIntoArray","Forbid"),!1),t.newComposition(f("PutIntoArray","Replace"),e("Replace",function(t){var e=t.p2;return e})),t.newComposition(f("PutIntoArray","Update"),!0),t.newComposition(f("PutIntoArray","PutIntoArray"),function(e,n){return new t.Delta.PutIntoArray([].concat(o(e.values),o(n.values)))})})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},o=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},i=function(t,e,n){e&&Object.defineProperties(t,e),n&&Object.defineProperties(t.prototype,n)},a=function w(t,e,n){var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:w(o,e,n)}if("value"in r&&r.writable)return r.value;var i=r.get;return void 0===i?void 0:i.call(n)},u=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},s=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},c=n(1),l=c.isUndefined,f=c.isDefined,p=c.t,h=c.define_d,d=c.oncePer,v=c.arraysEqual,y=n(3).WritableTarget,g=r(n(9)),b=r(n(10)),m=r(n(19));t.exports=d("PutIntoFunction",function(t){g(t),b(t),m(t),t.newOperationType("PutIntoFunction",function(t){function e(){for(var t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];s(this,e),a(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,n),this.values=this.arg?Array.isArray(this.arg)?this.arg:[this.arg]:[]}return u(e,t),i(e,null,{clone:{value:function(){var t=a(Object.getPrototypeOf(e.prototype),"clone",this).call(this);return t.values=[].concat(o(this.values)),t},writable:!0,configurable:!0},equals:{value:function(t){return v(this.values,t.values,function(t,e){return t.method===e.method&&t.value&&e.value})},writable:!0,configurable:!0},precondition:{value:function(t){return f(t.value)&&"function"==typeof t.value&&(f(t.value._DeltaJs_functions)||t instanceof y)
},writable:!0,configurable:!0},applyTo:{value:function(t){if(l(t.value._DeltaJs_functions)){var e=t.value,n=function(t){var e=function(){return t.apply(this,arguments)};return e.toString=function(){return t.toString()},e}(function(){for(var t=this,e=arguments.length,r=Array(e),o=0;e>o;o++)r[o]=arguments[o];var i;return n._DeltaJs_functions.forEach(function(e){i=e.apply(t,r)}),i});n._DeltaJs_functions=[function(){for(var t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];e.apply(this,n)}],t.value=n}var r=t.value._DeltaJs_functions;this.values.forEach(function(t){var e=t.method,n=t.value;switch(e){case"prepend":r.unshift(n);break;case"insert":var o=Math.floor(Math.random()*(r.length+1));r.splice(o,0,n);break;case"append":r.push(n)}})},writable:!0,configurable:!0},methods:{get:function(){return[]},configurable:!0}}),e}(t.Delta)),t.newProxyMethod("prepend",function(e){return new t.Delta.PutIntoFunction({method:"prepend",value:e})}),t.newProxyMethod("insert",function(e){return new t.Delta.PutIntoFunction({method:"insert",value:e})}),t.newProxyMethod("append",function(e){return new t.Delta.PutIntoFunction({method:"append",value:e})});var e=h(t);t.newComposition(p("Modify","PutIntoFunction"),!1),t.newComposition(p("Add","PutIntoFunction"),e("Add",function(t){var e=t.d2,n=t.p1;return e.appliedTo(n)})),t.newComposition(p("Remove","PutIntoFunction"),!1),t.newComposition(p("Forbid","PutIntoFunction"),!1),t.newComposition(p("Replace","PutIntoFunction"),e("Replace",function(t){var e=t.d2,n=t.p1;return e.appliedTo(n)})),t.newComposition(p("Update","PutIntoFunction"),!0),t.newComposition(p("PutIntoFunction","Modify"),!1),t.newComposition(p("PutIntoFunction","Add"),!1),t.newComposition(p("PutIntoFunction","Remove"),e("Remove")),t.newComposition(p("PutIntoFunction","Forbid"),!1),t.newComposition(p("PutIntoFunction","Replace"),e("Replace",function(t){var e=t.p2;return e})),t.newComposition(p("PutIntoFunction","Update"),!0),t.newComposition(p("PutIntoFunction","PutIntoFunction"),function(e,n){return new t.Delta.PutIntoFunction([].concat(o(e.values),o(n.values)))})})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},o=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},i=function(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0})},a=function(t,e,n){e&&Object.defineProperties(t,e),n&&Object.defineProperties(t.prototype,n)},u=function P(t,e,n){var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:P(o,e,n)}if("value"in r&&r.writable)return r.value;var i=r.get;return void 0===i?void 0:i.call(n)},s=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},c=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},l=r(n(6)),f=n(1),p=f.extend,h=f.isDefined,d=f.indent,v=f.oncePer,y=f.o,g=f.graphDescendants,b=(r(n(4)),r(n(9)),r(n(17))),m=n(5),w=m.ApplicationOrderCycle,O=m.UnresolvedDeltaConflict;t.exports=v("DeltaModel",function(t){b(t),t.newOperationType("DeltaModel",function(t){function e(){for(var t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];c(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,n),this.graph=new l}return s(e,t),a(e,null,{clone:{value:function(){var t=u(Object.getPrototypeOf(e.prototype),"clone",this).call(this);return t.graph=this.graph.clone(),t.graph.eachVertex(function(e,n){t.graph.setVertex(e,n.clone())}),t},writable:!0,configurable:!0},equals:{value:function(t){var e=this.graph.transitiveReduction(),n=t.graph.transitiveReduction(),r=!0;return e.eachVertex(function(t,e){return n.vertexValue(t).equals(e)?(r=!1,!1):void 0}),r?(n.eachVertex(function(t,n){return e.vertexValue(t).equals(n)?(r=!1,!1):void 0}),r?(e.eachEdge(function(t,e){return n.hasEdge(t,e)?(r=!1,!1):void 0}),r?(e.eachEdge(function(t,n){return e.hasEdge(t,n)?(r=!1,!1):void 0}),r):!1):!1):!1},writable:!0,configurable:!0},_assertNoUnresolvedConflicts:{value:function(){var t=this.conflicts();t.forEach(function(t){if(0===t.conflictResolvingDeltas.length)throw new O(t.conflictingDeltas)})},writable:!0,configurable:!0},applyTo:{value:function(t){var e=void 0===arguments[1]?{}:arguments[1];this._assertNoUnresolvedConflicts(),this.graph.topologically(function(n,r){r.applyTo(t,e)})},writable:!0,configurable:!0},toString:{value:function(){var t=void 0===arguments[0]?{}:arguments[0],n=u(Object.getPrototypeOf(e.prototype),"toString",this).call(this,t);if(this.graph.vertexCount()>0){var r="";this.graph.topologically(function(e,n){r+="["+e+"] "+n.toString(t)+"\n"}),n+="\n"+d(r,4)}return n},writable:!0,configurable:!0},conflicts:{value:function(){for(var t=this,e=this.graph.clone(),n="(sink)";e.hasVertex(n);)n=""+n+"'";e.addNewVertex(n,null),e.eachVertex(function(t){e.setVertex(t,null),t!==n&&e.ensureEdge(t,n)}),e=e.transitiveReduction();var r={},a=function(t){if(!e.vertexValue(t)){var n={};e.predecessors(t).forEach(function(t){a(t),n[t]=i({},t,!0);var r=e.vertexValue(t);p.apply(void 0,[n[t]].concat(o(Object.keys(r).map(function(t){return r[t]}))))}),e.setVertex(t,n),Object.keys(n).forEach(function(e){Object.keys(n).forEach(function(i){if(!(e>=i)){var a=p({},n[e]),u=p({},n[i]);Object.keys(a).forEach(function(t){Object.keys(u).forEach(function(e){t===e&&(delete a[t],delete u[e])})}),Object.keys(a).forEach(function(e){Object.keys(u).forEach(function(n){y.apply(void 0,[r].concat(o([e,n].sort())))[t]=!0})})}})})}};a(n);var u=[];return Object.keys(r).forEach(function(o){Object.keys(r[o]).forEach(function(i){var a=t.graph.vertexValue(o),s=t.graph.vertexValue(i);if(!a.commutesWith(s)){var c={conflictingDeltas:[o,i],conflictResolvingDeltas:[]};Object.keys(r[o][i]).forEach(function(r){g(e,r).forEach(function(e){var r=t.graph.vertexValue(e);e!==n&&r.resolves(a,s)&&c.conflictResolvingDeltas.push(e)})}),u.push(c)}})}),u},writable:!0,configurable:!0}}),e}(t.Delta),function(e){function n(){for(var t=arguments.length,e=Array(t),r=0;t>r;r++)e[r]=arguments[r];c(this,n),u(Object.getPrototypeOf(n.prototype),"constructor",this).apply(this,e),this._childOptions={},this._childApplicationConditions={}}return s(n,e),a(n,null,{processProxyArguments:{value:function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];var r={};do{if(0===e.length)throw new Error("The argument list for this Modify.DeltaModel method is insufficient.");var o=e.shift();"string"==typeof o?r.name?r.path=o:r.name=o:p(r,o)}while(!r.path||!r.name);return{options:r,args:e}},writable:!0,configurable:!0},addOperation:{value:function(e,n){var r=n.path,o=n.name,i=n.feature;if(!this._childApplicationConditions[o]){var a=void 0;a=i?t.newFeature(o,n):t.newFeature("delta__"+o,p({hidden:!0},n)),h(n.resolves)&&(a["if"](n.resolves),n=p({},n,{feature:!1})),h(n.requires)&&a.selects(n.requires),(i||a.conditional)&&(e.applicationCondition=a),this._childApplicationConditions[o]=a}var u;if(r.prop){var s=p({},n,{name:void 0}),c=this.addChildProxy(o,new t.Delta.Modify);u=c.addOperation(e,s)}else u=this.addChildProxy(o,e);return this._childOptions[o]||(this._childOptions[o]=n),u},writable:!0,configurable:!0},delta:{value:function(){var t=this,e=u(Object.getPrototypeOf(n.prototype),"delta",this).call(this);return e.graph.clear(),this.childKeys().forEach(function(n){var r=t._childOptions[n],i=t.childDelta(n);e.graph.addVertex(n,i),[].concat(o(r.resolves||[]),o(r.after||[]),o(r.requires||[])).forEach(function(t){if(e.graph.createEdge(t,n),e.graph.hasCycle())throw e.graph.removeExistingEdge(t,n),new w(t,n)}),(r.feature||t._childApplicationConditions[n].conditional)&&(i.applicationCondition=t._childApplicationConditions[n])}),e},writable:!0,configurable:!0}}),n}(t.ContainerProxy)),t.newComposition(function(e,n){return e instanceof t.Delta.DeltaModel||n instanceof t.Delta.DeltaModel},!0)})},function(t,e,n){"use strict";var r=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t)){for(var n,r=[],o=t[Symbol.iterator]();!(n=o.next()).done&&(r.push(n.value),!e||r.length!==e););return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(t,e,n){e&&Object.defineProperties(t,e),n&&Object.defineProperties(t.prototype,n)},i=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},a=n(1),u=a.extend,s=a.a,c=a.assert,l=a.isUndefined,f=a.oncePer,p=n(5).ConstraintFailure;t.exports=f("features",function(t){function e(e){return e=Array.isArray(e)?e:[e],e=e.map(function(e){return e instanceof t.Feature?e.name:e})}function n(t){var n=void 0===arguments[1]?[]:arguments[1];w=!0,n===!0?g[t]=!0:n===!1||y[t]!==!0&&s(y,t).push(e(n))}function a(t,r){e(r).forEach(function(e){n(e,t)})}function h(t){var n=void 0===arguments[1]?[]:arguments[1];w=!0,n===!1?m[t]=!1:n===!0||b[t]!==!1&&s(b,t).push(e(n))}function d(t,n){e(n).forEach(function(e){h(e,t)})}function v(){if(w){w=!1;var e;do e=!1,Object.keys(t.features).forEach(function(t){g[t]||(l(g[t])&&(g[t]=!1),(y[t]||[]).some(function(t){return t.every(function(t){return g[t]})})&&(g[t]=!0,e=!0))});while(e);Object.keys(t.features).forEach(function(t){m[t]=(b[t]||[]).every(function(t){return t.some(function(t){return g[t]})})})}}f(t.constructor,"features",function(){u(t.constructor.prototype,{newFeature:function(t){var e=void 0===arguments[1]?{}:arguments[1];return c(l(this.features[t]),"A feature with the name '"+t+"' already exists."),this.features[t]=new this.Feature(t,e)}})});var y={},g={},b={},m={},w=!1;t.Feature=function(){function t(e){var n=this,r=void 0===arguments[1]?{}:arguments[1];i(this,t),this.name=e,this.options=r,Object.keys(r).forEach(function(t){n.addOption(t,r[t])})}return o(t,null,{selected:{get:function(){if(v(),g[this.name]&&!m[this.name])throw new p(this);return g[this.name]},configurable:!0},condition:{get:function(){return y[this.name]},configurable:!0},conditional:{get:function(){return s(y,this.name).length>0},configurable:!0},restricted:{get:function(){return s(b,this.name).length>0},configurable:!0},select:{value:function(){this["if"](!0)},writable:!0,configurable:!0}}),t}();var O=[["if",[n]],["onlyIf",[h]],["selects",[a]],["requiredBy",[d]],["iff",[n,h]]];t.Feature.prototype.addOption=function(t,e){var n=this;O.forEach(function(o){var i=r(o,2),a=i[0],u=i[1];t===a&&u.forEach(function(t){t(n.name,e)})})},O.forEach(function(e){var n=r(e,1),o=n[0];t.Feature.prototype[o]=function(t){this.addOption(o,t)}}),t.features={}})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},o=function(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0})},i=n(1),a=i.extend,u=i.oncePer,s=r(n(13));t.exports=u("variation points",function(t){u(t.constructor,"variation points",function(){s(t),a(t.constructor.prototype,{vp:function(t,e){var n=o({},t,e);return this._deltaModelProxy.delta().applyTo(n,{restrictToProperty:t}),n[t]},"do":function(){for(var t,e=arguments.length,n=Array(e),r=0;e>r;r++)n[r]=arguments[r];return(t=this._deltaModelProxy)["do"].apply(t,[{feature:!0}].concat(n))}})}),t._deltaModelProxy=(new t.Delta.DeltaModel)["do"]()})},function(t,e,n){"use strict";var r=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},o=n(1),i=o.extend,a=o.isUndefined,u=o.oncePer;t.exports=u("application conditions",function(t){u(t.constructor,"application conditions",function(){i(t.constructor.prototype,{select:function(){for(var t=this,e=arguments.length,n=Array(e),o=0;e>o;o++)n[o]=arguments[o];n.forEach(function(e){if(Array.isArray(e)){var n;(n=t).select.apply(n,r(e))}else t.features[e].select()})}})}),i(t.Delta.prototype,Object.defineProperties({},{applicationCondition:{get:function(){return this._applicationCondition},set:function(t){this._applicationCondition=t},enumerable:!0,configurable:!0},selected:{get:function(){return a(this.applicationCondition)||this.applicationCondition.selected},enumerable:!0,configurable:!0}}))})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},o=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},i=function(t,e,n){e&&Object.defineProperties(t,e),n&&Object.defineProperties(t.prototype,n)},a=function g(t,e,n){var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:g(o,e,n)}if("value"in r&&r.writable)return r.value;var i=r.get;return void 0===i?void 0:i.call(n)},u=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},s=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},c=(r(n(6)),n(1)),l=(c.extend,c.a),f=c.isUndefined,p=c.oncePer,h=r(n(4)),d=r(n(8)),v=r(n(19)),y=n(5).MultipleActiveProxiesError;t.exports=p("ContainerProxy",function(t){v(t),t.ContainerProxy=function(e){function n(){var t=void 0===arguments[0]?{}:arguments[0];s(this,n),a(Object.getPrototypeOf(n.prototype),"constructor",this).call(this,t),this._doArgs=[],this._original=this,this._children={},this._childOptions={}}return u(n,e),i(n,{_newDeltaByMethod:{value:function(e,n){var r=t.ContainerProxy._methodHandlers[e].map(function(t){return t.apply(void 0,o(n))});return 1===r.length?r[0]:(d(t),new t.Delta.Overloaded(r))},writable:!0,configurable:!0},newProxyMethod:{value:function(e,n){f(t.ContainerProxy.prototype[e])&&(t.ContainerProxy.prototype[e]=function(){for(var t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];return this._do(e,n)}),l(t.ContainerProxy,"_methodHandlers",e).push(n)},writable:!0,configurable:!0}},{deactivate:{value:function(){var t=this;Object.keys(this._children).forEach(function(e){t.childProxy(e).deactivate()}),a(Object.getPrototypeOf(n.prototype),"deactivate",this).call(this)},writable:!0,configurable:!0},addChildProxy:{value:function(e,n){var r=this.childProxy(e),o=n.constructor.Proxy||t.Proxy,i=new o({delta:n,parent:this});return r instanceof t.Delta.Modify.Proxy&&i instanceof t.Delta.Modify.Proxy?r:(r&&r.deactivate(),this._children[e].push(i),i)},writable:!0,configurable:!0},childKeys:{value:function(){return Object.keys(this._children)},writable:!0,configurable:!0},childProxies:{value:function(t){return l(this._children,t)},writable:!0,configurable:!0},childProxy:{value:function(t){return l(this._children,t)[this._children[t].length-1]},writable:!0,configurable:!0},childDelta:{value:function(e){var n;return(n=t.Delta).composed.apply(n,o(this.childProxies(e).map(function(t){return t.delta()})))},writable:!0,configurable:!0},"do":{value:function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];if(!this.active)throw new y;var r=Object.create(this);return r._doArgs=[].concat(o(this._doArgs),e),r._original=this._original,r},writable:!0,configurable:!0},_do:{value:function(e,n){var r;if(!this.active)throw new y;var i=(r=this).processProxyArguments.apply(r,o(this._doArgs).concat(o(n))),a=i.options,u=i.args;"string"==typeof a.path&&(a.path=new h(a.path));var s=t.ContainerProxy._newDeltaByMethod(e,u),c=this.addOperation(s,a);return c instanceof t.ContainerProxy?c:this},writable:!0,configurable:!0},processProxyArguments:{value:function(){throw new Error("A 'ContainerProxy' subclass needs to implement the 'processProxyArguments' method.")},writable:!0,configurable:!0},addOperation:{value:function(){throw new Error("A 'ContainerProxy' subclass needs to implement the 'addOperation' method.")},writable:!0,configurable:!0}}),n}(t.Proxy)})},function(t,e,n){"use strict";var r=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},o=function(t,e,n){e&&Object.defineProperties(t,e),n&&Object.defineProperties(t.prototype,n)},i=function p(t,e,n){var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:p(o,e,n)}if("value"in r&&r.writable)return r.value;var i=r.get;return void 0===i?void 0:i.call(n)},a=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},u=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},s=n(1),c=s.indent,l=s.oncePer,f=s.arraysEqual;t.exports=l("Composed",function(t){t.newOperationType("Composed",function(e){function n(){for(var t=arguments.length,e=Array(t),r=0;t>r;r++)e[r]=arguments[r];u(this,n),i(Object.getPrototypeOf(n.prototype),"constructor",this).apply(this,e),this._components=this.arg||[]}return a(n,e),o(n,null,{clone:{value:function(){var t=i(Object.getPrototypeOf(n.prototype),"clone",this).call(this);return t._components=this._components.map(function(t){return t.clone()}),t},writable:!0,configurable:!0},equals:{value:function(t){return f(this._components,t._components,function(t,e){return t.equals(e)})},writable:!0,configurable:!0},applyTo:{value:function(t){var e=void 0===arguments[1]?{}:arguments[1];this._components.forEach(function(n){n.applyTo(t,e)})},writable:!0,configurable:!0},toString:{value:function(){var t=void 0===arguments[0]?{}:arguments[0],e=i(Object.getPrototypeOf(n.prototype),"toString",this).call(this,t);if(this._components.length>0){var r="";this._components.forEach(function(e){r+="• "+e.toString(t)+"\n"}),e+="\n"+c(r,4)}return e},writable:!0,configurable:!0},precondition:{value:function(t){return 0===this._components.length?!0:this._components[0].precondition(t)},writable:!0,configurable:!0},_collapse:{value:function(){var e=this;this._components=function(){var n=[];return e._components.forEach(function(e){e instanceof t.Delta.Composed?(e._collapse(),n.push.apply(n,r(e._components))):n.push(e)}),n}();var n=void 0;do n=!1,this._components=function(){for(var r=[],o=0;o<e._components.length-1;o+=1){var i=e._components[o].composedWith(e._components[o+1]);i instanceof t.Delta.Composed?r.push(e._components[o]):(r.push(i),n=!0,o+=1)}return o===e._components.length-1&&r.push(e._components[o]),r}();while(n)},writable:!0,configurable:!0},methods:{get:function(){return[]},configurable:!0}}),n}(t.Delta)),t.newComposition(function(e,n){return e instanceof t.Delta.Composed||n instanceof t.Delta.Composed},function(e,n){var o=e instanceof t.Delta.Composed?e._components:[e],i=n instanceof t.Delta.Composed?n._components:[n],a=new t.Delta.Composed([].concat(r(o),r(i)));return a._collapse(),a})})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},o=function(t,e,n){e&&Object.defineProperties(t,e),n&&Object.defineProperties(t.prototype,n)},i=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},a=(r(n(6)),n(1)),u=a.extend,s=a.oncePer,c=r(n(7));t.exports=s("Proxy",function(t){c(t),t.Proxy=function(){function t(){var e=void 0===arguments[0]?{}:arguments[0],n=e.parent,r=e.delta;i(this,t),this._parent=n,this._active=!0,this._delta=r}return o(t,null,{delta:{value:function(){return this._delta},writable:!0,configurable:!0},active:{get:function(){return this._active},configurable:!0},deactivate:{value:function(){this._active=!1},writable:!0,configurable:!0}}),t}(),u(t.Delta.prototype,{"do":function(){for(var t,e=arguments.length,n=Array(e),r=0;e>r;r++)n[r]=arguments[r];var o=this.constructor.Proxy;if(!o)throw new Error("Calling 'do' on delta type '"+this.type+"', which has no Proxy interface.");return(t=new o({delta:this}))["do"].apply(t,n)}})})}])});